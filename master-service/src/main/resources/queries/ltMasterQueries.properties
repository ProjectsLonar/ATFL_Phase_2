limit_value = 15

#getCategory =  SELECT a.* FROM ( \
#    select * from lt_mast_prod_categories lmpc \
#	where lmpc.org_id = ? \
#	AND COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx') like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
#	and upper(lmpc.status) = 'ACTIVE' \
#	) a limit ? OFFSET ? 
	
getCategory = SELECT A.* FROM ( \
    SELECT LMPC.*, ROWNUM RNUM FROM LT_MAST_PROD_CATEGORIES LMPC \
	where lmpc.org_id = ? \
	AND COALESCE(UPPER(CONCAT(LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME)),'xx') \
    like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
	AND UPPER(LMPC.STATUS) = 'ACTIVE' \
	) a WHERE RNUM BETWEEN ? AND ?   
	
#getProdCatCount = select count(*) from lt_mast_prod_categories lmpc \
#	where lmpc.org_id = ? \
#	AND COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx') like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
#	and upper(lmpc.status) = 'ACTIVE' 
	
getProdCatCount = select count(*) from lt_mast_prod_categories lmpc \
	where lmpc.org_id = ? \
	AND COALESCE(UPPER(CONCAT(LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME)),'xx') \
    like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
	AND UPPER(LMPC.STATUS) = 'ACTIVE' 
	
#getProduct = select a.* from( \
#	select lmp.product_id, lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, lmpl.list_price, lmpl.currency , lmpl.ptr_price  from \
#	lt_mast_products lmp, lt_mast_prod_categories lmpc,  \
#	lt_mast_price_lists lmpl, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lmp.category_id = lmpc.category_id \
#	and lmo.price_list = lmpl.price_list \
#	and lmp.product_code = lmpl.product_code \
#	and upper(lmp.status) = 'ACTIVE' \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
#	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like  \
#	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
#	order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
#	) a limit ? offset ?


getProduct = SELECT B.* FROM (select a.*,ROWNUM RNUM from(   \
SELECT LMP.PRODUCT_ID, LMO.OUTLET_ID   \
,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,   \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS   \
, lmpl.price_list, lmpl.list_price, lmpl.currency , lmpl.ptr_price from   \
lt_mast_products_v lmp, lt_mast_prod_categories lmpc,   \
lt_mast_price_lists_v lmpl,   \
lt_mast_outlets_v lmo   \
where 1=1   \
and lmp.category_id = lmpc.category_id   \
and lmo.price_list = lmpl.price_list   \
and lmp.product_code = lmpl.product_code   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.ORG_ID,'xx'))   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID , 'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID, 'xx'))   \
AND COALESCE(LMO.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.OUTLET_ID,'xx'))   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE   \
COALESCE( ? ,COALESCE(upper(lmp.product_name || lmp.product_code || lmpl.list_price),'xx'))   \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC   \
) a)B WHERE RNUM BETWEEN ? AND ? 



cmntFORPRODUCT = order by lmo.outlet_id  DESC, distinct(lmp.product_id), \

#getProductCount = select count(*) from \
#	lt_mast_products_v lmp, lt_mast_prod_categories lmpc, \
#	lt_mast_price_lists lmpl,  \
#	lt_mast_outlets lmo  \
#	where 1=1  \
#	and lmp.category_id = lmpc.category_id \
#	and lmo.price_list = lmpl.price_list  \
#	and lmp.product_code = lmpl.product_code \
#	and upper(lmp.status) = 'ACTIVE'  \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)

getProductCount = SELECT COUNT(*)   \
FROM   \
lt_mast_products_v lmp   \
JOIN LT_MAST_PROD_CATEGORIES LMPC ON LMP.CATEGORY_ID = LMPC.CATEGORY_ID   \
JOIN lt_mast_price_lists_v lmpl ON lmp.product_code = lmpl.product_code   \
JOIN lt_mast_outlets_v lmo ON lmo.price_list = lmpl.price_list   \
WHERE   \
1 = 1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID, '-99') = COALESCE( ?, COALESCE(LMP.ORG_ID, '-99'))   \
AND COALESCE(LMP.PRODUCT_ID, '-99') = COALESCE(?, COALESCE(LMP.PRODUCT_ID, '-99'))   \
AND COALESCE(LMP.CATEGORY_ID, '-99') = COALESCE(?, COALESCE(LMP.CATEGORY_ID, '-99'))   \
AND COALESCE(LMO.OUTLET_ID, '-99') = COALESCE(?, COALESCE(LMO.OUTLET_ID, '-99'))  

#getProductCountForAdmin = select count(*) from \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lmp.category_id = lmpc.category_id \
#	and upper(lmp.status) = 'ACTIVE' \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) 
	
getProductCountForAdmin = SELECT COUNT(*)   \
FROM   \
lt_mast_products_v lmp   \
JOIN lt_mast_prod_categories lmpc ON lmp.category_id = lmpc.category_id   \
WHERE   \
1 = 1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID, '-99') = COALESCE(?, COALESCE(LMP.ORG_ID, '-99'))   \
AND COALESCE(lmp.product_id, '-99') = COALESCE(?, COALESCE(lmp.product_id, '-99'))   \
AND COALESCE(LMP.CATEGORY_ID, '-99') = COALESCE(?, COALESCE(LMP.CATEGORY_ID, '-99')) 
	
getProductCountForAdminCOPY = select count(*) from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc , \
	(select distinct lmpl1.product_code,lmpl1.list_price from lt_mast_price_lists_v lmpl1) lmpl \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmp.product_code = lmpl.product_code \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99)
	
#getProductForAdmin = select a.* from( \
#select distinct lmp.product_id, lmp.*, lmpc.*  from \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc \
#where \
#1=1 \
#and lmp.category_id = lmpc.category_id \
#and upper(lmp.status) = 'ACTIVE' \
#AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx') like \
#COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx')) \
#AND lmp.org_id  =  COALESCE( ? ,lmp.org_id) \
#) a limit ? offset ?
	
getProductForAdmin = SELECT B.* FROM (   \
SELECT ROWNUM RNUM,A.*   \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,  \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS   \
from   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc   \
where   \
1=1   \
and lmp.category_id = lmpc.category_id   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx'))   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE   \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx'))   \
AND LMP.ORG_ID = COALESCE( ? ,LMP.ORG_ID) ) A )B WHERE RNUM BETWEEN ? AND ? 

	
getProductForAdminCOPY = select a.* from( \
	select lmp.product_id, lmp.*, lmpc.*, lmpl.list_price  from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc , \
	(select distinct lmpl1.product_code,lmpl1.list_price from lt_mast_price_lists_v lmpl1) lmpl \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmp.product_code = lmpl.product_code \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99)  \
	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx') like  \
	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx')) \
	) a limit ? offset ?

getUserTypeByUserId = select lmu.user_type from lt_mast_users lmu where lmu.user_id = ?

getProductCountWithInventory9FEB_OLD = select count(*) from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_price_lists_v lmpl,  \
	lt_mast_outlets_v lmo  , \
	lt_mast_inventory_v inv, \
	lt_mast_distributors_v lmd \
	where 1=1  \
	and lmp.category_id = lmpc.category_id \
	and lmo.price_list = lmpl.price_list  \
	and lmp.product_code = lmpl.product_code \
	and lmd.distributor_code = inv.dist_code \
	and lmp.product_code = inv.product_code \
	and lmo.distributor_id = lmd.distributor_id \
	and upper(lmp.status) = 'ACTIVE'  \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)
	
getProductWithInventory9FEB_OLD = select a.* from( \
	select inv.quantity as inventory_quantity, inv.inventory_code, lmp.product_id, lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, \
	lmpl.list_price, lmpl.currency , lmpl.ptr_price  from  \
	lt_mast_products_v lmp, lt_mast_prod_categories lmpc,  \
	lt_mast_price_lists_v lmpl,  \
	lt_mast_outlets_v lmo ,\
	lt_mast_inventory_v inv, \
	lt_mast_distributors_v lmd \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmo.price_list = lmpl.price_list \
	and lmp.product_code = lmpl.product_code \
	and lmd.distributor_code = inv.dist_code \
	and lmp.product_code = inv.product_code \
	and lmo.distributor_id = lmd.distributor_id \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
	order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
	) a limit ? offset ?

getProductCountWithInventoryCOPY = select count(*) \
	from \
		lt_mast_products_v lmp \
		left join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
	where 1=1  \
		and upper(lmp.status) = 'ACTIVE' \
		AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
		AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
		AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
		AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)

#getProductCountWithInventory = select count(*) \
#	from \
#		lt_mast_products lmp \
#		Inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND lmp.org_id = COALESCE(?,lmp.org_id) \
#		AND COALESCE(lmp.product_id ,-99) = COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#		AND COALESCE(lmp.category_id ,-99) = COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#		AND lmo.outlet_id =  ?

getProductCountWithInventory = select count(*)   \
from   \
lt_mast_products_v lmp   \
Inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id   \
left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code   \
left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list   \
left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id  \
left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code   \
where 1=1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND LMP.ORG_ID = COALESCE(?,LMP.ORG_ID)   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx'))   \
AND lmo.outlet_id =  ?
		
getProductWithInventoryCOPY = select a.* from( \
		 select lmp.product_id, inv.quantity as inventory_quantity, inv.inventory_code,  lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price  \
	from  \
		lt_mast_products_v lmp \
		left join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
	where 1=1  \
		and upper(lmp.status) = 'ACTIVE' \
		AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
		AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
		AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
		AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
		AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
		COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
		order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
	) a limit ? offset ?
	
#getProductWithInventory = select a.* from( \
#		 select lmp.product_id, inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 lmp.*, lmpc.*, lmpl.price_list, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from  \
#		lt_mast_products lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND lmp.org_id = COALESCE(?,lmp.org_id) \
#		AND lmp.product_id =  COALESCE(?,lmp.product_id) \
#		and lmp.category_id = COALESCE(?,lmp.category_id) \
#		AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
#	 	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
#		and lmo.outlet_id = ? \
#		order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
#	) a limit ? offset ?


#getProductWithInventory = SELECT B.* FROM \
#(select a.*,ROWNUM RNUM from( \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		     LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP.BRAND,LMP.SUBBRAND,LMP."style",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, \
#    LMP.PTR_FLAG, \
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#         lmpl.price_list, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from  \
#		lt_mast_products lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND LMP.ORG_ID = COALESCE(1,LMP.ORG_ID) \
#		AND lmp.product_id =  COALESCE(2132,lmp.product_id) \
#		AND LMP.CATEGORY_ID = COALESCE(3,LMP.CATEGORY_ID) \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
#		COALESCE( null ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
#		and lmo.outlet_id = 405406 \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, '0') AS NUMERIC) ASC \
#	) A )B WHERE RNUM BETWEEN 1 AND 2

getProductWithInventory = SELECT B.* FROM   \
(select a.*,ROWNUM RNUM from(   \
select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id,   \
LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,  \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS,   \
lmpl.price_list,   \
lmpl.list_price, lmpl.currency , lmpl.ptr_price  from   \
lt_mast_products_v lmp   \
inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id   \
left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code   \
left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list   \
left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id   \
left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code   \
where 1=1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND LMP.ORG_ID = COALESCE( ? ,LMP.ORG_ID)   \
AND LMP.PRODUCT_ID = COALESCE( ? ,LMP.PRODUCT_ID)  \
AND LMP.CATEGORY_ID = COALESCE( ? ,LMP.CATEGORY_ID)   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE   \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx'))   \
AND LMO.OUTLET_ID = ?    \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC   \
) A )B WHERE RNUM BETWEEN ? AND ? 


#findSearchProduct = select a.* from ( \
#	select pm.* from lt_mast_products pm \
#	where upper (pm.product_desc || pm.product_name) like upper('%' || ? || '%') \
#	and upper(pm.status) = 'ACTIVE' \
#	and org_id= ? ORDER by pm.product_id  desc \
#	) a limit ? offset ?

findSearchProduct = SELECT A.* FROM ( \
	SELECT PM.*,ROWNUM RNUM FROM LT_MAST_PRODUCTS_v PM \
	where upper (pm.product_desc || pm.product_name) like upper('%' || ? || '%') \
	AND UPPER(PM.STATUS) = 'ACTIVE' \
	AND ORG_ID= ? ORDER BY PM.PRODUCT_ID  DESC \
	) A WHERE RNUM BETWEEN ? AND ?

#findFAQbyOrgId= SELECT * FROM lt_mast_faq WHERE org_id = ?

findFAQbyOrgId= select * from lt_mast_faq lmf  \
WHERE 1 = 1  \
and org_id = ? \
AND COALESCE(UPPER(LMF.USER_TYPE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMF.USER_TYPE),'xx')) ORDER BY LMF.FAQ_ID ASC 


### Dashboard

#dateConditionChng = and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \

dateConditionChng = and lsh.last_update_date >  SYSDATE - ADD_MONTHS(SYSDATE,'-1') \

#statusWiseOrdersCountForAdmin = select count(lsh.status) as recordCount, lsh.status \
#	from \
#	lt_so_headers lsh,\
#	lt_mast_outlets lmo, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and upper(lsh.status) <> 'DELIVERED' \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.last_update_date at time zone 'IST'>= date_trunc('month', CURRENT_DATE) \
#	and lmo.org_id = ? \
#	group by lsh.status

statusWiseOrdersCountForAdmin = select count(lsh.status) as recordCount, lsh.status   \
from   \
lt_so_headers lsh,   \
lt_mast_outlets_v lmo,   \
lt_mast_users lmu   \
where 1=1   \
and upper(lsh.status) <> 'DELIVERED'   \
and lsh.outlet_id = lmo.outlet_id   \
and lmu.user_id = lsh.last_updated_by   \
AND LMU.STATUS = 'ACTIVE'   \
AND LSH.LAST_UPDATE_DATE >= TRUNC(?, 'MONTH')   \
AND LMO.ORG_ID = ?   \
GROUP BY LSH.STATUS
	
#statusWiseOrdersCountForDistributor = select count(lsh.status ) as recordCount, lsh.status \
#	from \
#	lt_so_headers lsh,\
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and upper(lsh.status) <> 'DELIVERED' \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmo.org_id = ?
	
statusWiseOrdersCountForDistributor = select count(lsh.status ) as recordCount, lsh.status  \
from  \
lt_so_headers lsh, \
lt_mast_outlets lmo  \
where 1=1  \
and upper(lsh.status) <> 'DELIVERED'  \
and lsh.outlet_id = lmo.outlet_id  \
AND LSH.LAST_UPDATE_DATE >= TRUNC(?, 'MONTH')  \
AND LMO.ORG_ID = ? \
group by lsh.status 
	
#categoryRevenueDistributionForDistributor =  select \
#	lmpc.category_name,lmpc.category_id \
#	,sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue ,count(distinct lsl.header_id)as dbc \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE)
	
categoryRevenueDistributionForDistributor =	select   \
lmpc.category_name,lmpc.category_id   \
,sum(lsl.ptr_price * lsl.quantity)as revenue ,count(distinct lsl.header_id)as dbc   \
from   \
lt_so_headers lsh ,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsh.header_id = lsl.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lmu.user_id = lsh.last_updated_by   \
and lmu.status = 'ACTIVE'   \
AND (LSH.STATUS = 'PROCESSED' OR LSH.STATUS = 'APPROVED')   \
AND LSH.LAST_UPDATE_DATE >= TRUNC(?, 'MONTH') 
	
categoryRevenueDistributionForDistributorCOPY = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date, \
	lmp.product_id, lmp.product_name, lmpc.category_id , lmpc.category_name , lmpc.category_desc , \
	lmo.price_list , lsl.list_price, lsl.quantity, lsl.ptr_price \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date  >=  date_trunc('month', CURRENT_DATE)

#categoryRevenueDistributionForAdmin = select \
#	lmpc.category_name,lmpc.category_id \
#	,sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue, count(distinct lsl.header_id)as dbc \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	group by lmpc.category_name,lmpc.category_id 
	
categoryRevenueDistributionForAdmin = select \
	lmpc.category_name,lmpc.category_id \
	,sum(lsl.ptr_price * lsl.quantity)as revenue, count(distinct lsl.header_id)as dbc \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.status = 'ACTIVE' \
	AND (LSH.STATUS = 'PROCESSED' OR LSH.STATUS = 'APPROVED') \
    AND LSH.LAST_UPDATE_DATE >= TRUNC(?, 'MONTH')	\
    GROUP BY LMPC.CATEGORY_NAME,LMPC.CATEGORY_ID	
	
categoryRevenueDistributionForAdminCOPY = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date, \
	lmp.product_id, lmp.product_name, lmpc.category_id , lmpc.category_name , lmpc.category_desc , \
	lmo.price_list , lsl.list_price, lsl.quantity, lsl.ptr_price \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lmu.user_id = lsh.last_updated_by \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date >=  date_trunc('month', CURRENT_DATE) \
	order by lsh.header_id , lsh.last_update_date

#dailySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	order by lsh.header_id , lsh.last_update_date 

dailySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	AND LMO.ORG_ID = ? \
	AND LSH.LAST_UPDATE_DATE > ADD_MONTHS(? ,'-1') \
	ORDER BY LSH.HEADER_ID , LSH.LAST_UPDATE_DATE
	
#dailySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months'

dailySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	AND LMO.ORG_ID = ? \
	AND LSH.LAST_UPDATE_DATE >  ADD_MONTHS(? ,'-1')

#monthlySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#	order by lsh.header_id , lsh.last_update_date

monthlySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date >  ADD_MONTHS(?,'-12') \
	ORDER BY LSH.HEADER_ID , LSH.LAST_UPDATE_DATE
	
#monthlySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months'

monthlySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	AND LSH.LAST_UPDATE_DATE >  ADD_MONTHS(?,'-12')
	
#addedForDistributorDashboard = and lsh.created_by in ()) order by lsh.header_id , lsh.last_update_date \
#		get userid form getUsersByDistributorId query 

addedForDistributorDashboard = and lsh.created_by in ()) order by lsh.header_id , lsh.last_update_date \
		get userid form getUsersByDistributorId query
		
#getUserTypeAndDisId = select lmu.user_type, lmu.distributor_id ,lmu.position_id from lt_mast_users lmu where lmu.user_id = ?

getUserTypeAndDisId = select lmu.user_type, lmu.distributor_id ,lmu.position_id from lt_mast_users lmu where lmu.user_id = ?

#getUsersByDistributorIdCOPY = select lmu.user_id from lt_mast_users lmu where lmu.distributor_id  = ?

getUsersByDistributorIdCOPY = select lmu.user_id from lt_mast_users lmu where lmu.distributor_id  = ?

#getUsersByDistributorId = select lmu.user_id from \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lmu.status = 'ACTIVE' \
#and lmu.distributor_id  = ?

getUsersByDistributorId = select lmu.user_id from \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lmu.status = 'ACTIVE' \
and lmu.distributor_id  = ?


#getUsersBySalesOfficer = select lmu2.user_id from \
#(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  									select lme.distributor_id from lt_mast_emp_position lmep ,lt_mast_employees lme \
#   									where 1=1 \
#   									and lme.employee_id = lmep.employee_id \
#   									and lmep.position_id in ( \
#   									select lmp.position_id from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp ."position" from lt_mast_positions lmp where lmp.position_id = ?)) \
#   							) \
#  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
#  and lmu.status = 'ACTIVE') lmu2,lt_mast_employees lme ,lt_mast_emp_position lmep \
#  where 1=1 \
#  and lmu2.employee_code = lme.employee_code \
#  and lme.employee_id = lmep.employee_id \
#  and lmu2.position_id = lmep.position_id


getUsersBySalesOfficer = select lmu2.user_id from  \
(SELECT LMU.USER_ID, LMU.USER_TYPE,LMU.EMPLOYEE_CODE,LMU.POSITION_ID  \
from lt_mast_users lmu  \
where 1=1  \
AND LMU.DISTRIBUTOR_ID IN (  \
  									select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme  \
   									where 1=1  \
   									and lme.employee_id = lmep.employee_id  \
   									AND LMEP.POSITION_ID IN (  \
   									SELECT LMP.POSITION_ID FROM LT_MAST_POSITIONS_V LMP WHERE LMP.PARENT_POSITION IN (  \
   									select lmp ."position" from lt_mast_positions_v lmp where lmp.position_id = ?))  \
   							)  \
  AND (LMU.USER_TYPE = 'DISTRIBUTOR' OR LMU.USER_TYPE = 'SALES')  \
  and lmu.status = 'ACTIVE') lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep  \
  where 1=1  \
  and lmu2.employee_code = lme.employee_code  \
  AND LME.EMPLOYEE_ID = LMEP.EMPLOYEE_ID  \
  AND LMU2.POSITION_ID = LMEP.POSITION_ID

  	   
getUsersBySalesOfficerCOPY1 =  select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where distributor_id in ( \
  select distinct lme.distributor_id \
  from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
  lt_mast_users lmu, lt_mast_positions_v lmp2 \
  	   where lme.employee_id = lmp.employee_id \
       and lmu.position_id = lmp2.position_id \
   	   and lmp.parent_position = lmp2.position \
   	   and lmu.user_id = ? ) \
   	   and lmu.user_type != 'AREAHEAD' \
  	   and lmu.user_type != 'SALESOFFICER') lmu2 \
  	   ,lt_mast_employees_v lme \
  	   ,lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and lmu2.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and lmu2.position_id = lmep.position_id 
   	   
getUsersBySalesOfficerCOPY =  select lmu.user_id  \
  from lt_mast_users lmu where distributor_id in ( \
  		select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			lt_mast_users lmu, lt_mast_positions_v lmp2 \
  	   where lme.employee_id = lmp.employee_id \
       and lmu.position_id = lmp2.position_id \
   	   and lmp.parent_position = lmp2.position \
   	   and lmu.user_id = ? )


#getReportUsersByAreaHead = select lmu2.user_id from \
#(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  									 select lme.distributor_id from lt_mast_emp_position lmep ,lt_mast_employees lme \
#   									where 1=1 \
#   									and lme.employee_id = lmep.employee_id \
#   									and lmep.position_id in ( \
#   									select lmp.position_id from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions lmp where lmp.position_id = ? ))) \
#   							) \
#  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
#  and lmu.status = 'ACTIVE' ) lmu2,lt_mast_employees lme ,lt_mast_emp_position lmep \
#  where 1=1 \
#  and lmu2.employee_code = lme.employee_code \
#  and lme.employee_id = lmep.employee_id \
#  and lmu2.position_id = lmep.position_id 
  		
 
getReportUsersByAreaHead = select lmu2.user_id from \
(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  									 select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme \
   									where 1=1 \
   									and lme.employee_id = lmep.employee_id \
   									and lmep.position_id in ( \
   									select lmp.position_id from lt_mast_positions_v lmp where lmp.parent_position in ( \
   									select lmp."position" from lt_mast_positions_v lmp where lmp.parent_position in ( \
   									select lmp."position" from lt_mast_positions_v lmp where lmp.position_id = ? ))) \
   							) \
  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
  and lmu.status = 'ACTIVE' ) lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep \
  where 1=1 \
  and lmu2.employee_code = lme.employee_code \
  and lme.employee_id = lmep.employee_id \
  AND LMU2.POSITION_ID = LMEP.POSITION_ID  		
  		
getReportUsersByAreaHeadCOPY1 =  select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select distinct  lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( select distinct lmu.user_id from  \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? \
  	) lmep2 \
  	,lt_mast_users lmu \
  	,lt_mast_employees_v lme \
  	where 1=1 \
  	and lmep2.position_id  = lmu.position_id \
  	and lme.employee_code = lmu.employee_code \
  	and lmep2.employee_id  = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' ))) abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id \
  		and abc.user_type != 'AREAHEAD' \
  		and abc.user_type != 'SALESOFFICER' 
  
# getUsersByAreaHead =  select distinct lmu2.user_id  \
# from lt_mast_positions lmp, lt_mast_users lmu \
#    , lt_mast_emp_position mep, lt_mast_positions lmp2 \
#    , lt_mast_emp_position mep2 ,  lt_mast_employees lme \
#    , lt_mast_users lmu2  \
# where lmp.position_id = lmu.position_id  \
#  and mep.parent_position = lmp.position \
#  and mep.position_id = lmp2.position_id \
#  and lmp2.position = mep2.parent_position  \
#  and lme.employee_id = mep2.employee_id  \
#  and lmu2.employee_code =  lme.employee_code \
#  and lmu.user_id = ?

getUsersByAreaHead =  select distinct lmu2.user_id \
 from lt_mast_positions_v lmp, lt_mast_users lmu \
    , lt_mast_emp_position_v mep, lt_mast_positions_v lmp2 \
    , lt_mast_emp_position_v mep2 ,  lt_mast_employees_v lme \
    , lt_mast_users lmu2 \
 WHERE LMP.POSITION_ID = LMU.POSITION_ID \
  and mep.parent_position = lmp."position" \
  AND MEP.POSITION_ID = LMP2.POSITION_ID \
  and lmp2."position" = mep2.parent_position \
  and lme.employee_id = mep2.employee_id \
  AND LMU2.EMPLOYEE_CODE =  LME.EMPLOYEE_CODE \
  AND LMU.USER_ID =?

getReportUsersByAreaHeadCOPY = select lmu.user_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   		 lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( \
   	   	select lmu2.user_id \
   	   	from lt_mast_users lmu2 \
   	   	where lmu2.position_id in ( \
			  select lmep.position_id \
			  from lt_mast_emp_position_v lmep \
			  where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ?)) \
  and lmu2.user_type='SALESOFFICER'))
  
#  getUsersByMonthlySalesAH = select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu.user_id in( \
#   	   				select lmu.user_id from lt_mast_users lmu where lmu.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu.user_type='SALESOFFICER')) 

getUsersByMonthlySalesAH = select lmu.user_id \
  			from lt_mast_users lmu \
  			where distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu, lt_mast_positions_v lmp2 \
   				where lme.employee_id = lmp.employee_id \
       			AND LMU.POSITION_ID = LMP2.POSITION_ID \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu.user_id in( \
   	   				select lmu.user_id from lt_mast_users lmu where lmu.position_id in ( \
							select lmep.position_id \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position" \
  								FROM LT_MAST_POSITIONS_v LMP \
  								where lmp.position_id = ? \
  )) \
  AND LMU.USER_TYPE='SALESOFFICER'))

#Reports
#getReportDataBySalesPersonAdmin = select \
#	lsh.order_number,lsh.status, lsh.order_date as orderDate \
#	,lmo.outlet_name ,lmo.outlet_code ,lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress \
#	,lsl.list_price ,lsl.ptr_price,lsl.quantity \
#	,lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code \
#	,lmp.product_code,lmp.product_name ,lmp.product_desc \
#	,concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,lme.employee_code,lme.employee_id \
#	from \
#	lt_so_headers lsh inner join lt_so_lines lsl on lsh.header_id = lsl.header_id \
#	inner join lt_mast_products lmp on lsl.product_id = lmp.product_id \
#	inner join lt_mast_outlets lmo on lsh.outlet_id = lmo.outlet_id \
#	inner join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#	inner join lt_mast_users lmu on lsh.last_updated_by = lmu.user_id \
#	inner join lt_mast_employees lme on lmu.employee_code = lme.employee_code \
#	where 1=1 \
#	and lmu.status = 'ACTIVE' \
#	AND COALESCE(lsh.status ,'xx') = COALESCE(? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) = COALESCE(? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) = COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) = COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	order by lsh.order_number desc

getReportDataBySalesPersonAdmin = select   \
LSH.ORDER_NUMBER,LSH.STATUS, LSH.ORDER_DATE AS ORDERDATE   \
,lmo.outlet_name ,lmo.outlet_code ,lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress   \
,lsl.list_price ,lsl.ptr_price,lsl.quantity   \
,lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code   \
,LMP.PRODUCT_CODE,LMP.PRODUCT_NAME ,LMP.PRODUCT_DESC   \
,(lme.first_name ||' '|| lme.last_name) as SalesPersonName,lme.employee_code,lme.employee_id   \
from   \
lt_so_headers lsh inner join lt_so_lines lsl on lsh.header_id = lsl.header_id   \
inner join lt_mast_products_v lmp on lsl.product_id = lmp.product_id   \
inner join lt_mast_outlets_v lmo on lsh.outlet_id = lmo.outlet_id   \
inner join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id   \
inner join lt_mast_users lmu on lsh.last_updated_by = lmu.user_id   \
inner join lt_mast_employees_v lme on lmu.employee_code = lme.employee_code   \
where 1=1   \
AND LMU.STATUS = 'ACTIVE'   \
AND COALESCE(LSH.STATUS ,'xx') = COALESCE(? ,COALESCE(LSH.STATUS,'xx'))   \
AND COALESCE(LME.ORG_ID ,'xx') = COALESCE(? ,COALESCE(LME.ORG_ID,'xx'))   \
AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))   \
AND COALESCE(LME.EMPLOYEE_ID ,'xx') = COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))   \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
or to_char(lsh.last_update_date , 'DD-MON-YY') = ?   \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )   \
ORDER BY LSH.ORDER_NUMBER DESC  

#getReportDataBySalesPersonAdminOLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
#	lmo.outlet_name ,lmo.outlet_code , \
#	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
#	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
#	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#	lsh.status, lsh.order_date as orderDate \
#	from  \
#	lt_mast_employees lme, \
#	lt_mast_distributors lmd , \
#	lt_mast_outlets lmo ,  \
#	lt_so_headers lsh ,  \
#	lt_so_lines lsl, \
#	lt_mast_products lmpd, \
#	lt_mast_price_lists lmpl, \
#	lt_mast_users lmu \
#	where 1=1  \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmpd.product_id \
#	and lmpl.price_list  = lmo.price_list \
#	and lmpd.product_code = lmpl.product_code \
#	AND lme.distributor_id =lmd.distributor_id \
#	AND lmo.distributor_id= lme.distributor_id \
#	AND lmu.user_id = lsh.last_updated_by \
#	and lmu.employee_code = lme.employee_code \
#	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
#	order by lsh.order_number desc
	
getReportDataBySalesPersonAdminOLD = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName,  lme.employee_code, \
	LMO.OUTLET_NAME ,LMO.OUTLET_CODE , \
	lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd , \
	lt_mast_outlets_v lmo , \
	lt_so_headers lsh ,\
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND LMU.EMPLOYEE_CODE = LME.EMPLOYEE_CODE \
	AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx')) \
	AND COALESCE(LME.ORG_ID ,-99) =  COALESCE( ? ,COALESCE(LME.ORG_ID,-99)) \
	AND COALESCE(LME.DISTRIBUTOR_ID ,-99) =  COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,-99)) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id,-99)) \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
    or to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? ) \
	ORDER BY LSH.ORDER_NUMBER DESC
	
getReportDataBySalesPersonAdminCOPY = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd , \
	lt_mast_outlets_v lmo ,  \
	lt_so_headers lsh ,  \
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu, \
	lt_mast_emp_position_v lmep \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	and lme.distributor_id =lmd.distributor_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE(? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.order_number desc
	
#getReportDataBySalesPersonDistributor = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
#	lmo.outlet_name ,lmo.outlet_code , \
#	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
#	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
#	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#	lsh.status, lsh.order_date as orderDate \
#	from \
#	lt_mast_employees lme, \
#	lt_mast_distributors lmd, \
#	lt_mast_outlets lmo ,  \
#	lt_so_headers lsh ,  \
#	lt_so_lines lsl, \
#	lt_mast_products lmpd, \
#	lt_mast_price_lists lmpl, \
#	lt_mast_users lmu \
#	where 1=1  \
#	and lmu.status = 'ACTIVE' \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmpd.product_id \
#	and lmpl.price_list  = lmo.price_list \
#	and lmpd.product_code = lmpl.product_code \
#	AND lme.distributor_id =lmd.distributor_id  \
#	AND lmo.distributor_id= lme.distributor_id \
#	AND lmu.user_id = lsh.last_updated_by \
#	and lmu.employee_code = lme.employee_code \
#	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	AND ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )
	
getReportDataBySalesPersonDistributor = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName,  lme.employee_code,  \
LMO.OUTLET_NAME ,LMO.OUTLET_CODE ,  \
lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress,  \
lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id ,  \
lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  ,  \
lsh.status, lsh.order_date as orderDate  \
FROM  \
LT_MAST_EMPLOYEES_V LME,  \
LT_MAST_DISTRIBUTORS_V LMD,  \
lt_mast_outlets_v lmo ,   \
lt_so_headers lsh ,   \
LT_SO_LINES LSL,  \
LT_MAST_PRODUCTS_V LMPD,  \
lt_mast_price_lists_v lmpl,  \
lt_mast_users lmu  \
where 1=1   \
and lmu.status = 'ACTIVE'  \
and lsh.header_id = lsl.header_id  \
and lsh.outlet_id = lmo.outlet_id  \
and lsl.product_id = lmpd.product_id  \
and lmpl.price_list  = lmo.price_list  \
and lmpd.product_code = lmpl.product_code  \
AND lme.distributor_id =lmd.distributor_id   \
AND lmo.distributor_id= lme.distributor_id  \
AND lmu.user_id = lsh.last_updated_by  \
AND LMU.EMPLOYEE_CODE = LME.EMPLOYEE_CODE  \
AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx'))  \
AND COALESCE(LME.ORG_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.ORG_ID,'xx'))  \
AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))  \
AND COALESCE(LME.EMPLOYEE_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))  \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) 	
	
getReportDataBySalesPersonDistributorCOPY = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_so_headers lsh ,  \
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu, \
	lt_mast_emp_position_v lmep \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id  \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	and upper(lmep.status) = 'ACTIVE' \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
	
getReportDataBySalesPersonAdmin_OLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmp.position, lmp.position_code ,lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  ,\
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_mast_positions_v lmp ,\
	lt_so_headers lsh ,  \
	lt_so_lines lsl,\
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id \
	AND lme.position_id =lmp.position_id    \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND lmu.position_id  = lme.position_id \
	and lmu.employee_code = lme.employee_code \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.order_number desc
	
getReportDataBySalesPersonDistributor_OLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmp.position, lmp.position_code ,lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name, lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  ,\
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_mast_positions_v lmp ,\
	lt_so_headers lsh ,  \
	lt_so_lines lsl,\
	lt_mast_products_v lmpd, \
	lt_mast_users lmu \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	AND lme.distributor_id =lmd.distributor_id \
	AND lme.position_id =lmp.position_id    \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND lmu.position_id  = lme.position_id \
	and lmu.employee_code = lme.employee_code \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
		
	
#sample = and lsh.last_update_date between ? and  ?   \
#	  and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
#      or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )

sample = and lsh.last_update_date BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY') \
	  AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
      OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? \
      OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? )
      
#getReportDataByRegionwiseSalesAdmin = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
#	sum(lsl.list_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc \
#	from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_distributors lmd, \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1= 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
#	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code

getReportDataByRegionwiseSalesAdmin = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
sum(lsl.list_price * lsl.quantity)as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc     \
from     \
lt_so_headers lsh,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_distributors_v lmd,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1= 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lmo.distributor_id = lmd.distributor_id     \
and lsl.product_id = lmp.product_id     \
and lmu.user_id = lsh.last_updated_by     \
and lmu.status = 'ACTIVE'     \
AND LSH.STATUS = 'PROCESSED'   \
AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
or to_char(lsh.last_update_date , 'DD-MON-YY') = ?    \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )     \
group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code

#getReportDataByRegionwiseSales = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
#	sum(lsl.list_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc \
#	from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_distributors lmd, \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1= 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
#	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) 
  
 getReportDataByRegionwiseSales = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
sum(lsl.list_price * lsl.quantity)as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc     \
from     \
lt_so_headers lsh,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_distributors_v lmd,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1= 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lmo.distributor_id = lmd.distributor_id     \
and lsl.product_id = lmp.product_id     \
and lmu.user_id = lsh.last_updated_by     \
and lmu.status = 'ACTIVE'     \
AND LSH.STATUS = 'PROCESSED'     \
AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?    \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \
group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code

      
getReportDataByRegionwiseSalesCOPY = select lsh.header_id,lsl.line_id, lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
	lsl.list_price , lsl.ptr_price, lsl.quantity,lsl.header_id, lsl.line_id  \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl,\
	lt_mast_outlets_v lmo , \
	lt_mast_distributors_v lmd, \
	lt_mast_products_v lmp, \
	lt_mast_users lmu \
	where 1= 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lmo.distributor_id = lmd.distributor_id \
	and lsl.product_id = lmp.product_id \
	and lmu.user_id = lsh.last_updated_by \
	and lsh.status = 'PROCESSED' \
	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )
	

      
getReportDataByProductAdminCOPY = select distinct(lmp.product_id), lmp.product_name, lmp.product_code, lsl.ptr_price, \
	lsl.list_price , lsl.quantity ,lsl.header_id, lsl.line_id \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp , \
	lt_mast_users lmu , \
	lt_mast_emp_position_v lmep2 , \
	lt_mast_employees_v lme2 \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme2.employee_code \
	and lme2.employee_id = lmep2.employee_id \
	and lmu.position_id = lmep2.position_id \
	AND UPPER(lsh.status) = 'PROCESSED' \
	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	and COALESCE(lmp.product_id  ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
	and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
	
#getReportDataByProductAdmin =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity, \
#	sum(lsl.ptr_price ::NUMERIC(25,2) * lsl.quantity::NUMERIC(25,2))as amount \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl , \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmp.product_id  ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
#	AND ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price 

getReportDataByProductAdmin =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity,  \
sum(lsl.ptr_price  * lsl.quantity)as amount  \
from  \
lt_so_headers lsh ,  \
LT_SO_LINES LSL ,  \
lt_mast_products_V lmp,  \
lt_mast_users lmu  \
where 1 = 1  \
and lsh.header_id = lsl.header_id  \
and lsl.product_id = lmp.product_id  \
and lmu.user_id = lsh.last_updated_by  \
and lmu.status = 'ACTIVE'  \
AND LSH.STATUS = 'PROCESSED'  \
AND COALESCE(LMP.PRODUCT_ID  ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID ,'xx'))  \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
or to_char(lsh.last_update_date ,'DD-MON-YY') = ?  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \
GROUP BY LMP.PRODUCT_ID,LMP.PRODUCT_NAME, LMP.PRODUCT_CODE, LSL.PTR_PRICE


#getReportDataByProductDistributor =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity, \
#	sum(lsl.ptr_price ::NUMERIC(25,2) * lsl.quantity::NUMERIC(25,2))as amount \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.org_id ,-99) = COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	and COALESCE(lmp.product_id ,-99) = COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )

getReportDataByProductDistributor =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity,     \
sum(lsl.ptr_price * lsl.quantity)as amount       \
from \
lt_so_headers lsh ,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1 = 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lsl.product_id = lmp.product_id    \
and lmu.user_id = lsh.last_updated_by   \
and lmu.status = 'ACTIVE'     \
AND LSH.STATUS = 'PROCESSED'     \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ?,COALESCE(LMO.ORG_ID,'xx'))     \
and COALESCE(lmp.product_id ,'xx') = COALESCE( ? ,COALESCE(lmp.product_id ,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \
group by lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price

	
#getReportDataByOutletAdmin = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
#	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,  lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc  from  \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_products lmp, \
#	lt_mast_distributors lmd , \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmd.distributor_id = lmo.distributor_id \
#	and lmp.category_id = lmpc.category_id  \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	and COALESCE(lsh.outlet_id  ,-99) =  COALESCE( ? ,COALESCE(lsh.outlet_id ),-99) \
#	and COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	order by lsh.last_update_date at time zone 'IST' desc

getReportDataByOutletAdmin = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status,     \
lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,   \
LSL.QUANTITY,LSL.HEADER_ID, LSL.LINE_ID , LMD.DISTRIBUTOR_NAME, LMD.DISTRIBUTOR_CRM_CODE, LMPC.CATEGORY_CODE , LMPC.CATEGORY_DESC   \
from   \
lt_so_headers lsh ,   \
lt_so_lines lsl,   \
lt_mast_outlets_v lmo ,   \
lt_mast_products_v lmp,   \
lt_mast_distributors_v lmd ,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1 = 1   \
and lsh.header_id = lsl.header_id   \
and lsh.outlet_id = lmo.outlet_id   \
and lsl.product_id = lmp.product_id   \
and lmd.distributor_id = lmo.distributor_id   \
and lmp.category_id = lmpc.category_id   \
and lmu.user_id = lsh.last_updated_by   \
AND LMU.STATUS = 'ACTIVE'   \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.ORG_ID,'xx'))   \
AND COALESCE(LSH.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,'xx'))   \
AND COALESCE(LMO.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,'xx'))   \
and COALESCE(lsh.status ,'xx') = COALESCE( ? ,COALESCE(lsh.status,'xx'))   \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))   \
or to_char(lsh.last_update_date ,'DD-MON-YY') = ?   \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) \
ORDER BY LSH.LAST_UPDATE_DATE DESC 
	
getReportDataByOutletAdminCOPY = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,  lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp, \
	lt_mast_distributors_v lmd , \
	lt_mast_prod_categories lmpc, \
	lt_mast_users lmu, \
	lt_mast_employees_v lme, \
	lt_mast_emp_position_v lmep \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id \
	and lmd.distributor_id = lmo.distributor_id \
	and lmp.category_id = lmpc.category_id  \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	and COALESCE(lsh.outlet_id  ,-99) =  COALESCE( ? ,COALESCE(lsh.outlet_id ),-99) \
	and COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	and ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.last_update_date desc
 
	
getReportDataByOutletDistributor = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status,     \
lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price , lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc from     \
lt_so_headers lsh ,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_products_v lmp,     \
lt_mast_distributors_v lmd,     \
lt_mast_prod_categories lmpc,     \
lt_mast_users lmu     \
where 1 = 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lsl.product_id = lmp.product_id     \
and lmd.distributor_id = lmo.distributor_id     \
and lmp.category_id = lmpc.category_id     \
and lmu.user_id = lsh.last_updated_by     \
AND LMU.STATUS = 'ACTIVE'     \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE(? ,COALESCE(LMO.ORG_ID,'xx'))     \
AND COALESCE(LSH.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,'xx'))     \
AND COALESCE(LMO.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,'xx'))     \
and COALESCE(lsh.status ,'xx') = COALESCE( ? ,COALESCE(lsh.status,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ?     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? ) 

	
#getReportDataByOutletDistributor = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
#	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price , lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc  from  \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets_v lmo , \
#	lt_mast_products_v lmp, \
#	lt_mast_distributors_v lmd, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmd.distributor_id = lmo.distributor_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	AND LMU.STATUS = 'ACTIVE' \
#	AND COALESCE(LMO.ORG_ID ,-99) =  COALESCE( ? ,COALESCE(LMO.ORG_ID,-99)) \
#	AND COALESCE(LSH.OUTLET_ID  ,-99) =  COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,-99)) \
#	AND COALESCE(LMO.DISTRIBUTOR_ID  ,-99) =  COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,-99)) \
#	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status,'xx')) \
#	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
#    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
#	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )

getDistributorIdByUserId = select lmu.distributor_id from lt_mast_users lmu where lmu.user_id = ?

#Filter

#getSearchDistributorForRegion = select a.* from ( select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code \
#	from lt_mast_distributors lmd, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lmd.distributor_id = lmo.distributor_id \
#	and upper(lmd.status) = 'ACTIVE' \
#	and lmd.org_id = ? \
#	AND COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region), 'xx') \
#	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) \
#	order by distributor_id asc ) a limit ? offset ?

getSearchDistributorForRegion = SELECT A.* FROM ( SELECT DISTINCT(LMD.DISTRIBUTOR_ID), LMD.DISTRIBUTOR_ID AD, LMD.DISTRIBUTOR_CODE \
  , lmd.distributor_name, lmd.distributor_crm_code ,ROWNUM RNUM \
	from lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lmd.distributor_id = lmo.distributor_id \
	and upper(lmd.status) = 'ACTIVE' \
	AND LMD.ORG_ID = ? \
	AND COALESCE(LMO.REGION ,'xx') =  COALESCE( ? ,COALESCE(LMO.REGION, 'xx')) \
	AND COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CRM_CODE),'xx') LIKE COALESCE( ? ,COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CRM_CODE),'xx')) \
	ORDER BY DISTRIBUTOR_ID ASC ) A WHERE RNUM BETWEEN ? AND ?
	
#getSearchDistributor= 	select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name , lmd.region \
#	from lt_mast_distributors lmd \
#	where 1=1  \
#	and lmd.org_id = ? \
#	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx') \
#	like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx'))

getSearchDistributor= 	select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name , lmd.region \
	from lt_mast_distributors_v lmd \
	where 1=1  \
	and lmd.org_id = ? \
	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx') \
	LIKE COALESCE( ? ,COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CODE),'xx'))

#getSearchSalesPerson= select a.* from ( select lme.employee_id, lme.first_name, lme.last_name, lme.employee_code \
#	from lt_mast_employees lme where 1 =1 \
#	and UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN' \
#	and UPPER(lme.status) = 'ACTIVE' \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id ),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id ),-99) \
#	AND COALESCE(upper(CONCAT(lme.first_name, lme.last_name, lme.employee_code)),'xx') \
#	like COALESCE( ? ,COALESCE(upper(CONCAT(lme.first_name, lme.last_name, lme.employee_code)),'xx')) ) a limit ? offset ?

getSearchSalesPerson= SELECT A.* FROM ( SELECT LME.EMPLOYEE_ID, LME.FIRST_NAME, LME.LAST_NAME, LME.EMPLOYEE_CODE       \
,ROWNUM RNUM       \
from lt_mast_employees_v lme where 1 =1       \
and UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN'       \
AND UPPER(LME.STATUS) = 'ACTIVE'       \
AND COALESCE(LME.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LME.ORG_ID ,'xx'))       \
AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID ,'xx'))       \
AND COALESCE(UPPER(LME.FIRST_NAME || LME.LAST_NAME || LME.EMPLOYEE_CODE),'xx')       \
LIKE COALESCE( ? ,COALESCE(UPPER(LME.FIRST_NAME || LME.LAST_NAME || LME.EMPLOYEE_CODE),'xx')) )       \
A WHERE RNUM BETWEEN ? AND ?


#getRegion=select distinct (region )from lt_mast_outlets lmo \
#	where 1=1 \
#	and lmo.region <> '' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id ),-99)

getRegion=sselect distinct (region )from lt_mast_outlets_v lmo      \
where 1=1      \
AND LMO.REGION <> ?      \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.ORG_ID ,'xx'))

#getSearchProduct= select a.* from ( select product_id, product_code, product_name from lt_mast_products lmp \
#	where 1 = 1 \
#	AND COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) \
#	AND COALESCE(upper(CONCAT(lmp.product_code, lmp.product_name)),'xx') \
#	like COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_code, lmp.product_name)),'xx')) ) a limit ? offset ?

getSearchProduct= SELECT A.* FROM ( SELECT PRODUCT_ID, PRODUCT_CODE, PRODUCT_NAME ,ROWNUM RNUM       \
from lt_mast_products_v lmp       \
WHERE 1 = 1       \
AND COALESCE(ORG_ID ,'xx') = COALESCE( ? ,COALESCE(ORG_ID ,'xx'))       \
AND COALESCE(UPPER(LMP.PRODUCT_CODE || LMP.PRODUCT_NAME),'xx')       \
LIKE COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_CODE || LMP.PRODUCT_NAME),'xx')) ) A       \
WHERE RNUM BETWEEN ? AND ?
		 
#getSearchOutlets = select outlet_id, outlet_code, outlet_name from lt_mast_outlets lmo \
#	where 1=1 \
#	AND UPPER(lmo.status) = 'ACTIVE' \
#	AND COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) \
#	AND COALESCE(distributor_id ,-99) =  COALESCE( ? ,COALESCE(distributor_id ),-99) \
#	AND COALESCE(upper(CONCAT(outlet_code , outlet_name )),'xx') like  \
#	COALESCE( ? ,COALESCE(upper(CONCAT(outlet_code , outlet_name )),'xx'))

getSearchOutlets = select outlet_id, outlet_code, outlet_name from lt_mast_outlets_v lmo       \
where 1=1       \
AND UPPER(lmo.status) = 'ACTIVE'       \
AND COALESCE(org_id ,'xx') = COALESCE( ? ,COALESCE(org_id ,'xx'))       \
AND COALESCE(distributor_id ,'xx') = COALESCE( ? ,COALESCE(distributor_id ,'xx'))       \
AND COALESCE(UPPER(OUTLET_CODE || OUTLET_NAME ),'xx') LIKE       \
COALESCE( ? ,COALESCE(UPPER(OUTLET_CODE || OUTLET_NAME ),'xx'))  
	
#getOutletStatusOLD=select distinct(status) from lt_mast_outlets lmo \
#	where  COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99)

getOutletStatusOLD= SELECT DISTINCT(STATUS) FROM LT_MAST_OUTLETS_v LMO \
	WHERE  COALESCE(ORG_ID ,-99) =  COALESCE( ? ,COALESCE(ORG_ID ,-99))
	
#getOutletStatus = select distinct(status) from lt_so_headers lmo where 1=1 and upper(lmo.status) <> 'DELIVERED'

getOutletStatus = select distinct(status) from lt_so_headers lmo where 1=1 and upper(lmo.status) <> 'DELIVERED'


#getCategoryDetails= select category_id,category_code,category_name ,category_desc \
#	from lt_mast_prod_categories lmpc \
#	where COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) 

getCategoryDetails= select category_id,category_code,category_name ,category_desc \
	FROM LT_MAST_PROD_CATEGORIES LMPC \
	where COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ,-99))
	
#getAllTestProduct =  SELECT a.* FROM ( \
#	select * from lt_mast_test_product lmtp \
#	) a limit ? OFFSET ?

getAllTestProduct = SELECT a.* FROM ( \
	SELECT * FROM LT_MAST_TEST_PRODUCT LMTP \
	) A WHERE ROWNUM BETWEEN ? AND ?

#checkOrderedIsProcessed = select count(*) from lt_so_headers lsh \
#	where 1=1 \
#	and UPPER(lsh.status) = 'PROCESSED' \ 

checkOrderedIsProcessed = select count(*) from lt_so_headers lsh \
	where 1=1 \
	AND UPPER(LSH.STATUS) = 'PROCESSED'
	
###get sales person count by distributor id

#getSalesPersonCountOLDD_25_Nov = select count(*) from lt_mast_users lmu \
#	where 1=1 \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ?

getSalesPersonCountOLDD_25_Nov = select count(*) from lt_mast_users lmu \
	where 1=1 \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ?
	
#getSalesPersonCountCOPY = select count(*) from lt_mast_users lmu \
#	where 1=1 \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? \
#	group by lmu.user_id

getSalesPersonCountCOPY = select count(*) from lt_mast_users lmu \
	where 1=1 \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? \
	GROUP BY LMU.USER_ID
	
#getSalesPersonCount = select count(distinct lmu.*) \
#	from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and lmu.user_type = 'SALES' \
#	and lmu.status = 'ACTIVE' \
#	and lmu.distributor_id = ? \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )

getSalesPersonCount = select count(distinct lmu.USER_ID) \
	from \
	lt_mast_users lmu, \
	lt_so_headers lsh \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and lmu.user_type = 'SALES' \
	and lmu.status = 'ACTIVE' \
	and lmu.distributor_id = ? \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )

###get total number of order count by distributor id
#getOrderCountOld = select count(*) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountOld = select count(*) \
 from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? )

getOrderCountCOPY = select count(*) from lt_so_headers lsh \
where lsh.status = 'PROCESSED' \
and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? ) 

#getOrderCount = select count(*) \
#from lt_so_headers lsh, \
#lt_mast_distributors lmd,\
#lt_mast_outlets lmo, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lmo.distributor_id = lmd.distributor_id \
#and lsh.outlet_id = lmo.outlet_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lmd.distributor_id = ? 

getOrderCount = select count(*) \
from lt_so_headers lsh, \
lt_mast_distributors_v lmd, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lmo.distributor_id = lmd.distributor_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'DD-MON-YY') <= ? \
and to_char(lsh.last_update_date, 'DD-MON-YY') >= ? \
and lmd.distributor_id = ?

###get total number of order line count by distributor id

#getOrderLineCountOld =	select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountOld = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))
		
getOrderLineCountCOPY = select count(*) from lt_so_lines lsl \
where 1=1 and lsl.header_id in ( select lsh.header_id from lt_so_headers lsh \
where lsh.status = 'PROCESSED' \
and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? )) 

#getOrderLineCount = select count(*) \
#from \
#lt_so_lines lsl, \
#lt_so_headers lsh, \
#lt_mast_distributors lmd, \
#lt_mast_outlets lmo, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lmo.distributor_id = lmd.distributor_id \
#and lsh.outlet_id = lmo.outlet_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lmd.distributor_id = ?
	
getOrderLineCount = select count(*) \
from \
lt_so_lines lsl, \
lt_so_headers lsh, \
lt_mast_distributors_v lmd, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmo.distributor_id = lmd.distributor_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'dd-mon-yy') <= ? \
and to_char(lsh.last_update_date, 'dd-mon-yy') >= ? \
and lmd.distributor_id = ?	
	
### DASHBOARD get total number of order count by distributor id
#getOrderCountDashboard = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountDashboard = select count(*) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
	and lsh.last_updated_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? )
	
#getOrderCountSales =  select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by = ?

getOrderCountSales = select count(*) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'dd-mon-yy') = ?       \
and lsh.last_updated_by = ? 

#getOrderCountDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' )

getOrderCountDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1       \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')       \
and to_char(lsh.last_update_date, 'dd-mon-yy') = ?       \
and lsh.last_updated_by in       \
(select lmu.user_id from lt_mast_users lmu       \
where 1=1       \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )       \
and upper(lmu.status) = 'ACTIVE' )  
	
#getOrderCountDashboardSO = select count(*) \
#	from lt_so_headers lsh \
#	where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in \
#    			(select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme \
# 					,lt_mast_users lmu, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu.user_id = ?) \
#   	    and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))
 
getOrderCountDashboardSO = select count(*) \
	from lt_so_headers lsh \
	where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu where distributor_id in \
    			(select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
 					,lt_mast_users lmu, lt_mast_positions_v lmp2 \
   				where lme.employee_id = lmp.employee_id \
       			and lmu.position_id = lmp2.position_id \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu.user_id = ?) \
   	    and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) 
   	    
#getOrderCountDashboardAH = select count(*) from lt_so_headers lsh \
#where 1=1 and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#and lsh.last_updated_by in ( \
#	select lmu.user_id \
#  	from lt_mast_users lmu \
#  	where 1=1 \
#  	and lmu.distributor_id in ( \
#  		select lme.distributor_id \
#   		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			lt_mast_users lmu1, lt_mast_positions lmp2 \
#   		where lme.employee_id = lmp.employee_id \
#       	and lmu1.position_id = lmp2.position_id \
#   	   	and lmp.parent_position = lmp2.position \
#   	   	and lmu1.user_id in( \
#   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')) \
#  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))

getOrderCountDashboardAH = select count(*) from lt_so_headers lsh \
where 1=1 and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
and lsh.last_updated_by in ( \
	select lmu.user_id \
  	from lt_mast_users lmu \
  	where 1=1 \
  	and lmu.distributor_id in ( \
  		select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2."position" \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER')) \
  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))
	
### DASHBOARD get total number of order line count by distributor id

#getOrderLineCountDashboard = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountDashboard = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))
		
#getOrderLineCountDashboardSales = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by = ? )

getOrderLineCountDashboardSales = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'DD-MON-YY') = ?      \
and lsh.last_updated_by = ? ) 
		
#getOrderLineCountDashboardAdmin = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' ))

getOrderLineCountDashboardAdmin = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'DD-MON-YY') = ?     \
and lsh.last_updated_by in      \
(select lmu.user_id from lt_mast_users lmu      \
where 1=1      \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )      \
and upper(lmu.status) = 'ACTIVE' ))

		
#getOrderLineCountDashboardSO = select count(*) from lt_so_lines lsl \
#where 1=1 \
#and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in(	\
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   				 lt_mast_users lmu, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu.user_id = ? ) \
#   	   	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )))

getOrderLineCountDashboardSO = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'DD-MON-YY') = ?     \
and lsh.last_updated_by in (      \
select lmu.user_id      \
from lt_mast_users lmu where distributor_id in(	     \
select lme.distributor_id      \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,      \
lt_mast_users lmu, lt_mast_positions_v lmp2      \
where lme.employee_id = lmp.employee_id      \
and lmu.position_id = lmp2.position_id      \
and lmp.parent_position = lmp2."position"    \
and lmu.user_id = ?) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))) 

#getOrderLineCountDashboardAH = select count(*) from lt_so_lines lsl \
#where 1=1 \
#and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu \
#  		where 1=1 \
#  		and lmu.distributor_id in ( \
#  			select lme.distributor_id \
#   		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			 lt_mast_users lmu1, lt_mast_positions lmp2 \
#   		where lme.employee_id = lmp.employee_id \
#       	and lmu1.position_id = lmp2.position_id \
#   	   	and lmp.parent_position = lmp2.position \
#   	   	and lmu1.user_id in( \
#   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')) \
#  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#))
		
getOrderLineCountDashboardAH = select count(*) from lt_so_lines lsl \
where 1=1 \
and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu \
  		where 1=1 \
  		and lmu.distributor_id in ( \
  			select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			 lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2."position" \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER')) \
  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
))		
		
#getOrderCountDashboardCategory = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from \
#	(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsl.header_id = lsh.header_id  \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.last_updated_by = lmu.user_id \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmu.status = 'ACTIVE'

getOrderCountDashboardCategory = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from   \
(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsl.header_id = lsh.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lsh.last_updated_by = lmu.user_id   \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')   \
and lsh.last_update_date >= trunc(?,'month')   \
AND LMU.STATUS = 'ACTIVE' 
			
getOrderCountDashboardCategoryCOPY = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in (select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ) group by lsh.header_id
		
#getOrderCountDashboardCategoryAdmin = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from \
#	(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsl.header_id = lsh.header_id  \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.last_updated_by = lmu.user_id \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmu.status = 'ACTIVE' \
#	group by lmpc.category_id,lsh.header_id) abc \
#	group by abc.category_name,abc.category_id 
	
getOrderCountDashboardCategoryAdmin = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from   \
(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsl.header_id = lsh.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lsh.last_updated_by = lmu.user_id   \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')   \
and lsh.last_update_date >= trunc(?,'month')   \
AND LMU.STATUS = 'ACTIVE'   \
group by lmpc.category_id,lsh.header_id,lmpc.category_name) abc   \
group by abc.category_name,abc.category_id 
		
getOrderCountDashboardCategoryAdminCOPY = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in (select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		) group by lsh.header_id
		
		
#getOrderCountDashboardCategorySO = select lsh.header_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	and lmpc.category_id = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in( \
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu.user_id = ? ) \
#   	 and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR')) \
#   	 group by lsh.header_id

getOrderCountDashboardCategorySO = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  add_months(?,-1) \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu where distributor_id in( \
  			select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu, lt_mast_positions_v lmp2 \
   			where lme.employee_id = lmp.employee_id \
       		and lmu.position_id = lmp2.position_id \
   	   		and lmp.parent_position = lmp2."position" \
   	   		and lmu.user_id = ? ) \
   	 and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR')) \
   	 group by lsh.header_id
		
#getOrderCountDashboardCategoryAH = select lsh.header_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	and lmpc.category_id = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu \
#  		where 1=1 \
#  		and lmu.distributor_id in ( \
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			 	 lt_mast_users lmu1, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu1.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu1.user_id in( \
#   	   			select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? )) \
#  		and lmu2.user_type='SALESOFFICER')) \
#  		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) \
# group by lsh.header_id

getOrderCountDashboardCategoryAH = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl,\
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  add_months(?,-1) \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu \
  		where 1=1 \
  		and lmu.distributor_id in ( \
  			select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			 	 lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   			where lme.employee_id = lmp.employee_id  \
       		and lmu1.position_id = lmp2.position_id  \
   	   		and lmp.parent_position = lmp2."position" \
   	   		and lmu1.user_id in(  \
   	   			select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position"  \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? )) \
  		and lmu2.user_type='SALESOFFICER')) \
  		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) \
 group by lsh.header_id
	
#getSalesPersonsMonthlyCountDash = select count(lmu.*) from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh  \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lmu.distributor_id = ? \
#	group by lsh.last_updated_by 

getSalesPersonsMonthlyCountDash = select (select count(*)from lt_mast_users) all_count from   \
lt_mast_users lmu,   \
lt_so_headers lsh    \
where 1=1   \
and lsh.last_updated_by = lmu.user_id   \
and upper(lmu.user_type) = 'SALES'   \
AND UPPER(LMU.STATUS) = 'ACTIVE'   \
and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
AND TO_CHAR(LSH.LAST_UPDATE_DATE,'DD-MON-YY')  >= ? \
AND LMU.DISTRIBUTOR_ID = ?  \
group by lsh.last_updated_by  

#getOrderCountMonthlyDashboard = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountMonthlyDashboard = select count(*) from lt_so_headers lsh where 1=1         \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')         \
and to_char(lsh.last_update_date,'DD-MON-YY') <= ?         \
AND to_char(lsh.last_update_date,'DD-MON-YY') >= ?         \
and lsh.last_updated_by in         \
(select lmu.user_id from lt_mast_users lmu         \
where 1=1         \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'         \
and lmu.distributor_id = ? )

#getOrderLineCountMonthlyDashboard = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountMonthlyDashboard = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
		and to_char(lsh.last_update_date,'DD-MON-YY')  >= ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))

#getSalesPersonsMonthlyCountDashAdmin = select count(lmu.*) from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh  \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	group by lsh.last_updated_by 
	
getSalesPersonsMonthlyCountDashAdmin = select (select count(*) from lt_mast_users)as all_count from \
	lt_mast_users lmu, \
	lt_so_headers lsh \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and to_char(lsh.last_update_date,'dd-mon-yy') <= ? \
	AND to_char(lsh.last_update_date,'dd-mon-yy')   >= ? \
	group by lsh.last_updated_by
	
#getSalesPersonsMonthlyCountDashSO =  select count(lmu.*) \
#from lt_mast_users lmu, lt_so_headers lsh \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and upper(lmu.user_type) = 'SALES' \
#and upper(lmu.status) = 'ACTIVE' \
#and lsh.last_update_date <= ?::date \
#AND lsh.last_update_date >= ?::date \
#and lmu.distributor_id in ( \
#select lme.distributor_id \
#from lt_mast_emp_position lmp, lt_mast_employees lme \
#,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? \
#) \
#group by lsh.last_updated_by 


getSalesPersonsMonthlyCountDashSO = select (select count(*)from lt_mast_users)all_count \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
AND to_char(lsh.last_update_date,'DD-MON-YY') >= ? \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2."position" \
and lmu.user_id = ? \
) \
group by lsh.last_updated_by 

#getOrderCountMonthlyDashboardSO = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id in (select lme.distributor_id \
#   	from lt_mast_emp_position lmp, lt_mast_employees lme, \
# 	lt_mast_users lmu3, lt_mast_positions lmp2 \
#   	where lme.employee_id = lmp.employee_id \
#   	and lmu3.position_id = lmp2.position_id \
#   	and lmp.parent_position = lmp2.position \
#   	and lmu3.user_id = ?))
  
getOrderCountMonthlyDashboardSO = select count(*) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and  to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
	AND  to_char(lsh.last_update_date,'DD-MON-YY')  >= ? \
	and lsh.last_updated_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id in (select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
 	lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
   	and lmu3.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2."position" \
   	and lmu3.user_id = ?))  
   	
#getOrderLineCountMonthlyDashboardSO = select count(lsl.*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id in ( \
#			select lme.distributor_id \
#   	  		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   	  		lt_mast_users lmu3, lt_mast_positions lmp2 \
#   	  		where lme.employee_id = lmp.employee_id \
#      		and lmu3.position_id = lmp2.position_id \
#   	  		and lmp.parent_position = lmp2.position \
#   	  		and lmu3.user_id = ?)))
 
getOrderLineCountMonthlyDashboardSO = select (select count(*)  from lt_so_lines lsl)all_count from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
		and to_char(lsh.last_update_date,'DD-MON-YY') >= ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id in ( \
			select lme.distributor_id \
   	  		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   	  		lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	  		where lme.employee_id = lmp.employee_id \
      		and lmu3.position_id = lmp2.position_id \
   	  		and lmp.parent_position = lmp2."position" \
   	  		and lmu3.user_id = ?))) 
   	  		
#getSalesPersonsMonthlyCountDashAH = select count(distinct lmu.user_id) \
#  			from lt_mast_users lmu,lt_so_headers lsh \
#  			where 1=1 \
#  			and lsh.last_updated_by = lmu.user_id \
#  			and (upper(lmu.user_type) = 'SALES') \
#  			and upper(lmu.status) = 'ACTIVE' \
#  			and lsh.last_update_date <= ?::date \
#			and lsh.last_update_date  >= ?::date \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER'))
  
getSalesPersonsMonthlyCountDashAH = select count(distinct lmu.user_id) \
  			from lt_mast_users lmu,lt_so_headers lsh \
  			where 1=1 \
  			and lsh.last_updated_by = lmu.user_id \
  			and (upper(lmu.user_type) = 'SALES') \
  			and upper(lmu.status) = 'ACTIVE' \
  			and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
			and to_char(lsh.last_update_date,'DD-MON-YY') >=? \
  			and lmu.distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp \
  								where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER'))  
  
#  getOrderCountMonthlyDashboardAH =  select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where 1=1 \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')))
  
getOrderCountMonthlyDashboardAH = select count(*) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
	AND to_char(lsh.last_update_date,'DD-MON-YY')  >=  ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id  \
  			from lt_mast_users lmu  \
  			where 1=1  \
  			and lmu.distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp  \
  								where lmp.position_id = ?  \
  ))  \
  and lmu2.user_type='SALESOFFICER')))
  
  
#  getOrderLineCountMonthlyDashboardAH = select count(lsl.*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select lsh.header_id from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where 1=1 \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER'))))

getOrderLineCountMonthlyDashboardAH = select (select count(*)from lt_so_lines) all_count  from lt_so_lines lsl \
	where 1=1  \
	and lsl.header_id in (  \
	select lsh.header_id from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
	AND  to_char(lsh.last_update_date,'DD-MON-YY') >= ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id  \
  			from lt_mast_users lmu  \
  			where 1=1  \
  			and lmu.distributor_id in (  \
  				select lme.distributor_id  \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,  \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position"  \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in (  \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp  \
  								where lmp.position_id = ?  \
  ))  \
  and lmu2.user_type='SALESOFFICER'))))


#getOrderCountMonthlyDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' )

getOrderCountMonthlyDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
	AND to_char(lsh.last_update_date,'DD-MON-YY') >= ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id from lt_mast_users lmu  \
	where 1=1  \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
	and upper(lmu.status) = 'ACTIVE' )

#getOrderLineCountMonthlyDashboardAdmin = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE'  ))
		
getOrderLineCountMonthlyDashboardAdmin = select count(*) from lt_so_lines lsl  \
	where 1=1  \
	and lsl.header_id in (  \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
		and to_char(lsh.last_update_date,'DD-MON-YY') <= ? \
		and to_char(lsh.last_update_date,'DD-MON-YY')  >= ? \
		and lsh.last_updated_by in  \
		(select lmu.user_id from lt_mast_users lmu  \
		where 1=1  \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
		and upper(lmu.status) = 'ACTIVE'  ))	
	
#getRegionV2 = select distinct (ot.region) from lt_mast_outlets ot where ot.distributor_id = ( \
#		select distributor_id from lt_mast_users lmu where lmu.user_id = ? and org_id = ? )

getRegionV2 = select distinct (ot.region) from lt_mast_outlets_v ot where ot.distributor_id = (  \
		select distributor_id from lt_mast_users lmu where lmu.user_id = ? and org_id = ? )
		
#getDistributorIdByAH = select lme.distributor_id from lt_mast_emp_position lmep,lt_mast_employees lme \
#where 1=1 \
#and lme.employee_id = lmep.employee_id \
#and lmep.position_id = lme.position_id \
#and lmep.parent_position in (select lmp1."position" from lt_mast_positions lmp1 \
#				where lmp1.parent_position in (select lmp."position" from lt_mast_positions lmp \
#  				where lmp.position_id = ? )) 

getDistributorIdByAH = select lme.distributor_id from lt_mast_emp_position_v lmep,lt_mast_employees_v lme  \
where 1=1  \
and lme.employee_id = lmep.employee_id  \
and lmep.position_id = lme.position_id  \
and lmep.parent_position in (select lmp1."position" from lt_mast_positions_v lmp1  \
				where lmp1.parent_position in (select lmp."position" from lt_mast_positions_v lmp  \
  				where lmp.position_id = ? ))
  					
#getDistributorIdBySO = select lme.distributor_id from lt_mast_emp_position lmep,lt_mast_employees lme \
#where 1=1 \
#and lme.employee_id = lmep.employee_id \
#and lmep.position_id = lme.position_id \
#and lmep.parent_position in (select lmp."position" from lt_mast_positions lmp where lmp.position_id = ? )
  					
getDistributorIdBySO = select lme.distributor_id from lt_mast_emp_position_v lmep,lt_mast_employees_v lme  \
where 1=1  \
and lme.employee_id = lmep.employee_id  \
and lmep.position_id = lme.position_id  \
and lmep.parent_position in (select lmp."position" from lt_mast_positions_v lmp where lmp.position_id = ? )
  					
#getSearchDistributorForRegionOther = select a.* from ( select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code from lt_mast_distributors lmd,lt_mast_outlets lmo \
#where 1=1 \
#and lmd.distributor_id = lmo.distributor_id \
#and upper(lmd.status) = 'ACTIVE' \
#and lmd.org_id = ? \
#and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region), 'xx') \
#and COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) 

getSearchDistributorForRegionOther = select a.* \
from ( select distinct(lmd.distributor_id), lmd.distributor_id dist_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code from lt_mast_distributors_v lmd,lt_mast_outlets_v lmo  \
where 1=1  \
and lmd.distributor_id = lmo.distributor_id  \
and upper(lmd.status) = 'ACTIVE'  \
and lmd.org_id = ?  \
and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region, 'xx'))  \
and COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')))a 

monthlySalesForAdminV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh, \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#monthlySalesForAdminV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
#to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month, \
#count(lsl.*)as tls ,count(distinct lsl.header_id)as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

monthlySalesForAdminV2 = select sum(lsl.ptr_price * lsl.quantity)as sale,  \
to_char(lsh.last_update_date, 'Mon YYYY')as month,  \
(select count(*)from lt_so_lines) as tls ,count(distinct lsl.header_id)as dbc  \
from  \
lt_so_headers lsh,  \
lt_so_lines lsl,  \
lt_mast_products_v lmp,  \
lt_mast_users lmu  \
where 1=1  \
and lsh.header_id = lsl.header_id  \
and lsl.product_id = lmp.product_id  \
and lmu.user_id = lsh.last_updated_by  \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')  \
and lmu.status = 'ACTIVE'  \
and lsh.last_update_date >= add_months(?,-12) \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#monthlySalesForDistributorV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
#to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month, \
#count(lsl.*)as tls ,count(distinct lsl.header_id)as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months'

monthlySalesForDistributorV2 = select sum(lsl.ptr_price* lsl.quantity)as sale,         \
to_char(lsh.last_update_date,'Mon YYYY')as month,         \
(select count(*)from lt_so_lines) as tls ,count(distinct lsl.header_id)as dbc         \
from         \
lt_so_headers lsh,         \
lt_so_lines lsl,         \
lt_mast_products_v lmp,         \
lt_mast_users lmu         \
where 1=1         \
and lsh.header_id = lsl.header_id         \
and lsl.product_id = lmp.product_id         \
and lmu.user_id = lsh.last_updated_by         \
and lmu.status = 'ACTIVE'         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(? ,-12)  \


monthlySalesForDistributorV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
to_char(lsh.last_update_date, 'Mon YYYY')as month \
from \
lt_so_headers lsh , \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_outlets_v lmo \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lsh.outlet_id = lmo.outlet_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' 

#getOrderCountMonthlyDashboardAdminV2 = select count(*)as dbc, to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

getOrderCountMonthlyDashboardAdminV2 = select count(*)as dbc, to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lmu.user_id = lsh.last_updated_by         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'         \
group by to_char(lsh.last_update_date, 'Mon YYYY')  

getOrderCountMonthlyDashboardAdminV2COPY = select count(*)as dbc, to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2 \
where 1=1 \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardAdminV2 = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAdminV2 = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lsl.header_id = lsh.header_id         \
and lmu.user_id = lsh.last_updated_by         \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')         \
and lsh.last_update_date > add_months(?,-12)         \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'     \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAdminV2COPY = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_lines lsl,lt_so_headers lsh, lt_mast_users lmu, lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2 \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardSOV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
   	lt_so_headers lsh,lt_mast_users lmu \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id in ( select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
 	lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
   	and lmu3.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu3.user_id = ? ) \
   	group by to_char(lsh.last_update_date, 'Mon YYYY') 
   	
   	
#getOrderCountMonthlyDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from \
#lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' 

getOrderCountMonthlyDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from         \
lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lsh.last_updated_by = lmu.user_id         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardSOV2COPY1 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY')
   	
getOrderLineCountMonthlyDashboardSOV2COPY = select count(lsl.*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
lt_mast_users lmu3, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu3.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu3.user_id = ? ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardSOV2 = select count(lsl.*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id=lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.user_id in ( \
#select lmu2.user_id from \
#(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
#  from lt_mast_users lmu where lmu.distributor_id in( \
#select lme.distributor_id from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? )) lmu2 \
#,lt_mast_employees lme \
#,lt_mast_emp_position lmep \
#where 1=1 \
#and lmu2.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu2.position_id = lmep.position_id ) \
#group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardSOV2 = select to_char(lsh.last_update_date, 'Mon YYYY')as month,(select count(*) from lt_so_lines) as tls \
from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu  \
where 1=1  \
and lsl.header_id=lsh.header_id  \
and lmu.user_id=lsh.last_updated_by  \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
and lsh.last_update_date >  add_months(?,-12)  \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.user_id in (  \
select lmu2.user_id from  \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id  \
  from lt_mast_users lmu where lmu.distributor_id in(  \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2  \
where lme.employee_id = lmp.employee_id  \
and lmu.position_id = lmp2.position_id  \
and lmp.parent_position = lmp2."position"  \
and lmu.user_id = ? )) lmu2  \
,lt_mast_employees_v lme  \
,lt_mast_emp_position_v lmep  \
where 1=1  \
and lmu2.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu2.position_id = lmep.position_id )  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardAHV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_headers lsh \
where 1=1 \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lsh.last_updated_by in ( \
select lmu.user_id from lt_mast_users lmu \
where 1=1 and lmu.distributor_id in ( select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER'))) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 


#getOrderCountMonthlyDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_so_headers lsh \
#where 1=1 \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' 

getOrderCountMonthlyDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_headers lsh         \
where 1=1         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardAHV2COPY1 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_headers lsh \
where 1=1 \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lsh.last_updated_by in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in(  select distinct lmu.user_id from  \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAHV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id =lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER')) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
#lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id =lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and lsh.last_updated_by in ( \
#select abc.user_id from \
#(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  	select lme.distributor_id \
#   	from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu1, lt_mast_positions lmp2 \
#   	where lme.employee_id = lmp.employee_id \
#    and lmu1.position_id = lmp2.position_id \
#   	and lmp.parent_position = lmp2.position \
#   	and lmu1.user_id in(  select distinct lmu.user_id from \
#   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position lmep,lt_mast_positions lmp \
#   where 1=1 and lmep.parent_position=lmp."position" \
#   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees lme \
#  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
#  	and lmu.user_type='SALESOFFICER' )))abc \
#  	, lt_mast_employees lme \
#  	   , lt_mast_emp_position lmep \
#  	   where 1=1 \
#  	   and abc.employee_code = lme.employee_code \
#  	   and lme.employee_id = lmep.employee_id \
#  	   and abc.position_id = lmep.position_id ) \
#group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from   \
lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu   \
where 1=1   \
and lsl.header_id =lsh.header_id   \
and lmu.user_id = lsh.last_updated_by   \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')   \
and lsh.last_update_date >  add_months(?,-12)   \
and lsh.last_updated_by in (   \
select abc.user_id from   \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id   \
from lt_mast_users lmu   \
where 1=1   \
and lmu.distributor_id in (   \
SELECT LME.DISTRIBUTOR_ID   \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2   \
where lme.employee_id = lmp.employee_id   \
and lmu1.position_id = lmp2.position_id   \
and lmp.parent_position = lmp2."position"   \
AND LMU1.USER_ID IN( SELECT DISTINCT LMU.USER_ID FROM   \
( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp   \
WHERE 1=1 AND LMEP.PARENT_POSITION=LMP."position"   \
and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme   \
where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id   \
AND LMU.USER_TYPE='SALESOFFICER' )))ABC   \
, LT_MAST_EMPLOYEES_V LME   \
, lt_mast_emp_position_v lmep   \
where 1=1   \
and abc.employee_code = lme.employee_code   \
and lme.employee_id = lmep.employee_id   \
AND ABC.POSITION_ID = LMEP.POSITION_ID )   \
GROUP BY TO_CHAR(LSH.LAST_UPDATE_DATE, 'Mon YYYY') 

getOrderCountMonthlyDashboardV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_headers lsh, lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#getOrderCountMonthlyDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_so_headers lsh, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')

getOrderCountMonthlyDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
from lt_so_headers lsh,  \
lt_mast_users lmu,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')  \
and lsh.last_update_date >= add_months(?,-12)  \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

getOrderLineCountMonthlyDashboardV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_lines lsl ,lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lsl.header_id = lsh.header_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#getOrderLineCountMonthlyDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month \
#from lt_so_lines lsl, \
#lt_mast_users lmu, \
#lt_so_headers lsh, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsl.header_id = lsh.header_id \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
from lt_so_lines lsl,  \
lt_mast_users lmu,  \
lt_so_headers lsh,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and lsl.header_id = lsh.header_id  \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
and lsh.last_update_date >  add_months(?,-12) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

dailySalesForAdminV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from \
lt_so_headers lsh, \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_prod_categories lmpc, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lmp.category_id = lmpc.category_id \
and lsh.outlet_id = lmo.outlet_id \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date > date_trunc('month', current_date) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 


#dailySalesForAdminV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#,count(lsl.*)as tls,count(distinct lsl.header_id) as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmp.category_id = lmpc.category_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' > date_trunc('month', current_date) \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

dailySalesForAdminV2 = select sum(lsl.ptr_price* lsl.quantity)as sale, to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date   \
,(select count(*) from lt_so_lines)as tls,count(distinct lsl.header_id) as dbc   \
from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsh.header_id = lsl.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lsh.last_updated_by = lmu.user_id   \
and lmu.status = 'ACTIVE'   \
and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED')

dailySalesForDistributorV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from \
lt_so_headers lsh , \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_prod_categories lmpc, \
lt_mast_outlets_v lmo \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lmp.category_id = lmpc.category_id \
and lsh.outlet_id = lmo.outlet_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'INPROCESS' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date > date_trunc('month', current_date) 

#dailySalesForDistributorV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#,count(lsl.*)as tls,count(distinct lsl.header_id) as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmp.category_id = lmpc.category_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date)  

dailySalesForDistributorV2 = select sum(lsl.ptr_price * lsl.quantity)as sale, to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date          \
,(select count (*) from lt_So_lines )as tls,count(distinct lsl.header_id) as dbc          \
from          \
lt_so_headers lsh,          \
lt_so_lines lsl,          \
lt_mast_products_v lmp,          \
lt_mast_prod_categories lmpc,          \
lt_mast_users lmu          \
where 1=1          \
and lsh.header_id = lsl.header_id          \
and lsl.product_id = lmp.product_id          \
and lmp.category_id = lmpc.category_id          \
and lsh.last_updated_by = lmu.user_id          \
and lmu.status = 'ACTIVE'          \
and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') 

getOrderCountDashboardV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and(UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees lme2,lt_mast_emp_position lmep2 \
#where 1=1 \
#and lmu.employee_code = lme2.employee_code \
#and lme2.employee_id = lmep2.employee_id \
#and lmu.position_id = lmep2.position_id \
#and lsh.last_updated_by=lmu.user_id \
#and(lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

getOrderCountDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date , 'DD-MM-YYYY')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2     \
where 1=1     \
and lmu.employee_code = lme2.employee_code     \
and lme2.employee_id = lmep2.employee_id     \
and lmu.position_id = lmep2.position_id     \
and lsh.last_updated_by=lmu.user_id     \
and(lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date  >= trunc(?,'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR')     \
and upper(lmu.status) = 'ACTIVE'     \
and lmu.distributor_id = ?     \
group by  to_char(lsh.last_update_date,'DD-MM-YYYY')

getOrderLineCountDashboardV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position lmep2,lt_mast_employees lme2 \
#where 1=1 \
#and lmu.employee_code = lme2.employee_code \
#and lme2.employee_id = lmep2.employee_id \
#and lmu.position_id = lmep2.position_id \
#and lsl.header_id = lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY')

getOrderLineCountDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2     \
where 1=1     \
and lmu.employee_code = lme2.employee_code     \
and lme2.employee_id = lmep2.employee_id     \
and lmu.position_id = lmep2.position_id     \
and lsl.header_id = lsh.header_id     \
and lmu.user_id = lsh.last_updated_by     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month')     \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
and upper(lmu.status) = 'ACTIVE'     \
and lmu.distributor_id = ?    \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

getOrderCountDashboardSOV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh ,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in \
( select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme ,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? ) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh ,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by=lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 

getOrderCountDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date         \
from lt_so_headers lsh ,lt_mast_users lmu         \
where 1=1         \
and lsh.last_updated_by=lmu.user_id         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= trunc(?,'month')         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR')  \


getOrderCountDashboardSOV2COPY2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh ,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id \
) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') \

getOrderLineCountDashboardSOV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu.user_id = ? ) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardSOV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id=lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and lmu.user_id in ( \
#select lmu2.user_id from \
#(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
#  from lt_mast_users lmu where lmu.distributor_id in( \
#select lme.distributor_id from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? )) lmu2 \
#,lt_mast_employees lme \
#,lt_mast_emp_position lmep \
#where 1=1 \
#and lmu2.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu2.position_id = lmep.position_id ) \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardSOV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lsl.header_id=lsh.header_id     \
and lmu.user_id=lsh.last_updated_by     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month')     \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
and lmu.user_id in (     \
select lmu2.user_id from  \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id     \
  from lt_mast_users lmu where lmu.distributor_id in(     \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2     \
where lme.employee_id = lmp.employee_id     \
and lmu.position_id = lmp2.position_id     \
and lmp.parent_position = lmp2."position"     \
and lmu.user_id = ? )) lmu2     \
,lt_mast_employees_v lme     \
,lt_mast_emp_position_v lmep     \
where 1=1     \
and lmu2.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu2.position_id = lmep.position_id )     \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

getOrderCountDashboardAHV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( \
   	   	select lmu2.user_id from lt_mast_users lmu2,lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   	   		where 1=1 \
   	   		and lmu2.position_id=lmep.position_id \
   	   		and lmep.parent_position=lmp."position" \
   	   		and lmu2.user_type='SALESOFFICER' \
   	   		and lmp.position_id = ? \
  )) \
  group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 
  
  
#getOrderCountDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) 

getOrderCountDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lsh.last_updated_by = lmu.user_id     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >= trunc(?,'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )

getOrderCountDashboardAHV2COPY2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and lmu.user_id in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in(select distinct lmu.user_id from  \
   (select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id) \
  group by to_char(lsh.last_update_date, 'DD-MM-YYYY')
  
getOrderLineCountDashboardAHV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2.position \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2,lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   	   		where 1=1 \
   	   		and lmu2.position_id=lmep.position_id \
   	   		and lmep.parent_position=lmp."position" \
   	   		and lmu2.user_type='SALESOFFICER' \
   	   		and lmp.position_id = ?)) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date      \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu      \
where 1=1      \
and lsl.header_id=lsh.header_id      \
and lmu.user_id=lsh.last_updated_by      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and lsh.last_update_date > trunc(?,'month')      \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )      \
and lmu.user_id in (      \
select abc.user_id from      \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id      \
from lt_mast_users lmu      \
where 1=1      \
and lmu.distributor_id in (      \
select lme.distributor_id      \
from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu1, lt_mast_positions lmp2      \
where lme.employee_id = lmp.employee_id      \
and lmu1.position_id = lmp2.position_id      \
and lmp.parent_position = lmp2."position"      \
and lmu1.user_id in(  select distinct lmu.user_id from      \
(select lmep.position_id ,lmep.employee_id from lt_mast_emp_position lmep,lt_mast_positions lmp      \
where 1=1 and lmep.parent_position=lmp."position"      \
and lmp.position_id = ?  )lmep2, lt_mast_users lmu ,lt_mast_employees lme      \
where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id      \
and lmu.user_type='SALESOFFICER' )))abc      \
, lt_mast_employees lme      \
, lt_mast_emp_position lmep      \
where 1=1      \
and abc.employee_code = lme.employee_code      \
and lme.employee_id = lmep.employee_id      \
and abc.position_id = lmep.position_id )      \
group by to_char(lsh.last_update_date, 'DD-Mon-YY')  

#getOrderLineCountDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu     \
#where 1=1     \
#and lsl.header_id=lsh.header_id     \
#and lmu.user_id=lsh.last_updated_by  \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
#and lsh.last_update_date > trunc(?,'month')     \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
#and lmu.user_id in (     \
#select abc.user_id from     \
#(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id     \
#from lt_mast_users lmu     \
#where 1=1     \
#and lmu.distributor_id in (     \
#  	select lme.distributor_id     \
#   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2     \
#   	where lme.employee_id = lmp.employee_id     \
#    and lmu1.position_id = lmp2.position_id     \
#   	and lmp.parent_position = lmp2."position"     \
#   	and lmu1.user_id in(  select distinct lmu.user_id from     \
#   (select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp     \
#   where 1=1 and lmep.parent_position=lmp."position"     \
#   and lmp.position_id = ?  )lmep2, lt_mast_users lmu ,lt_mast_employees_v lme     \
#  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id     \
#  	and lmu.user_type='SALESOFFICER' )))abc     \
#  	, lt_mast_employees_v lme     \
#  	   , lt_mast_emp_position_v lmep     \
#  	   where 1=1     \
#  	   and abc.employee_code = lme.employee_code     \
#  	   and lme.employee_id = lmep.employee_id     \
#  	   and abc.position_id = lmep.position_id )    \
#  group by to_char(lsh.last_update_date, 'DD-Mon-YY') 

#getOrderCountDashboardAdminV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')

getOrderCountDashboardAdminV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lmu.user_id = lsh.last_updated_by     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >=trunc(?,'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )     \
and upper(lmu.status) = 'ACTIVE'     \
group by to_char(lsh.last_update_date, 'DD-Mon-YY')  

getOrderCountDashboardAdminV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2 \
where 1=1 \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY')

#getOrderLineCountDashboardAdminV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu  \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardAdminV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date   \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu    \
where 1=1    \
and lsl.header_id=lsh.header_id    \
and lmu.user_id = lsh.last_updated_by    \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')    \
and lsh.last_update_date > trunc(?,'month')    \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )    \
and upper(lmu.status) = 'ACTIVE'    \
group by to_char(lsh.last_update_date, 'DD-Mon-YY') 

getOrderLineCountDashboardAdminV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2 \
where 1=1 \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and lsl.header_id=lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderCountSalesV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh \
where 1=1 \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and lsh.last_updated_by = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountSalesV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_emp_position lmep,lt_mast_users lmu,lt_mast_employees lme \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and lsh.last_updated_by = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

getOrderCountSalesV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_headers lsh,lt_mast_emp_position_v lmep,lt_mast_users lmu,lt_mast_employees_v lme     \
where 1=1     \
and lsh.last_updated_by = lmu.user_id     \
and lmu.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu.position_id = lmep.position_id     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >= trunc(?,'month')     \
and lsh.last_updated_by =?    \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

getOrderLineCountDashboardSalesV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh \
where 1=1 \
and lsl.header_id = lsh.header_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and lsh.last_updated_by = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardSalesV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh, lt_mast_emp_position lmep, lt_mast_users lmu, lt_mast_employees lme \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and lsh.last_updated_by = ? \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') \

getOrderLineCountDashboardSalesV2 = select count(*)as tls,to_char(lsh.last_update_date,'DD-Mon-YY')as last_date     \
from  lt_so_lines lsl,lt_so_headers lsh, lt_mast_emp_position_v lmep, lt_mast_users lmu, lt_mast_employees_v lme     \
where 1=1     \
and lsl.header_id = lsh.header_id     \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu.position_id = lmep.position_id     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month') \
and lsh.last_updated_by = ?     \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

#getSalesPersonsMonthlyCountDashAdminV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and lmu.user_type = 'SALES' \
#	and lmu.status = 'ACTIVE' \
#	and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months' \
#	group by to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')

getSalesPersonsMonthlyCountDashAdminV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month    \
from    \
lt_mast_users lmu,    \
lt_so_headers lsh    \
where 1=1    \
and lsh.last_updated_by = lmu.user_id    \
and lmu.user_type = 'SALES'    \
and lmu.status = 'ACTIVE'    \
and lsh.last_update_date >= add_months(?,-12)    \
group by to_char(lsh.last_update_date, 'Mon YYYY')
	
getSalesPersonsMonthlyCountDashAdminV2COPY = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
	lt_mast_users lmu, \
	lt_so_headers lsh, \
	lt_mast_emp_position_v lmep2, \
	lt_mast_employees_v lme2 \
	where 1=1 \
	and lmu.employee_code = lme2.employee_code \
  	and lme2.employee_id = lmep2.employee_id \
  	and lmu.position_id = lmep2.position_id \
	and lsh.last_updated_by = lmu.user_id \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
	group by  to_char(lsh.last_update_date, 'Mon YYYY')
	
getSalesPersonsMonthlyCountDashSOV2COPY = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? \
) \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getSalesPersonsMonthlyCountDashSOV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_mast_users lmu, lt_so_headers lsh \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.user_type = 'SALES' \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months'  

getSalesPersonsMonthlyCountDashSOV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month    \
from lt_mast_users lmu, lt_so_headers lsh    \
where 1=1    \
and lsh.last_updated_by = lmu.user_id    \
and lmu.user_type = 'SALES'    \
and lmu.status = 'ACTIVE'    \
and lsh.last_update_date >= add_months(?,-12)  

getSalesPersonsMonthlyCountDashSOV2COPY1 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lmu.user_type = 'SALES' \
and lmu.status = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getSalesPersonsMonthlyCountDashAHV2COPY = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (upper(lmu.user_type) = 'SALES') \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in (select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER')) \
group by  to_char(lsh.last_update_date, 'Mon YYYY')


getSalesPersonsMonthlyCountDashAHV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month   \
from lt_mast_users lmu,lt_so_headers lsh   \
where 1=1   \
and lsh.last_updated_by = lmu.user_id   \
and lmu.user_type = 'SALES'   \
and lmu.status = 'ACTIVE'   \
and lsh.last_update_date >= add_months(?,-12)  \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 
 
#getSalesPersonsMonthlyCountDashAHV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
#from lt_mast_users lmu,lt_so_headers lsh  \
#where 1=1  \
#and lsh.last_updated_by = lmu.user_id  \
#and lmu.user_type = 'SALES'  \
#and lmu.status = 'ACTIVE'  \
#and lsh.last_update_date >= add_months(?,-12) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 

getSalesPersonsMonthlyCountDashAHV2COPY1 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lmu.user_type = 'SALES' \
and lmu.status = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') \
and lmu.user_id in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
 select lme.distributor_id \
 from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( select distinct lmu.user_id from \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getSalesPersonsMonthlyCountDashV2COPY = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, \
lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getSalesPersonsMonthlyCountDashV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_mast_users lmu, \
#lt_so_headers lsh, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lmu.user_type = 'SALES' \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

getSalesPersonsMonthlyCountDashV2 = select count(distinct lmu.user_id) as totalEff,to_char('lsh.last_update_date ', 'Mon YYYY')as month  \
from lt_mast_users lmu,  \
lt_so_headers lsh,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and lmu.user_type = 'SALES'  \
and lmu.status = 'ACTIVE'  \
and lsh.last_update_date >=add_months(?,-12) \
and lmu.distributor_id =? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#getReportDataByDistributorAdmin = select sum(lsl.quantity::NUMERIC(25,0)* lsl.list_price::NUMERIC(25,0))as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code, \
#	lmpc.category_name, lmpc.category_code \
#	from lt_so_headers lsh \
#	,lt_so_lines lsl \
#	,lt_mast_outlets lmo \
#	,lt_mast_products lmp \
#	,lt_mast_distributors lmd \
#	,lt_mast_prod_categories lmpc \
#	,lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND UPPER(lsh.status) = 'PROCESSED' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
#	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmd.distributor_crm_code,lmpc.category_code,lmd.distributor_name,lmpc.category_name \
#	order by lmd.distributor_crm_code asc

getReportDataByDistributorAdmin = select sum(lsl.quantity * lsl.list_price)as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code,    \
lmpc.category_name, lmpc.category_code    \
from lt_so_headers lsh    \
,lt_so_lines lsl    \
,lt_mast_outlets_v lmo    \
,lt_mast_products_v lmp    \
,lt_mast_distributors_v lmd    \
,lt_mast_prod_categories lmpc    \
,lt_mast_users lmu    \
where 1 = 1    \
and lsh.header_id = lsl.header_id    \
and lsl.product_id = lmp.product_id    \
and lmp.category_id = lmpc.category_id    \
and lsh.outlet_id = lmo.outlet_id    \
and lmo.distributor_id = lmd.distributor_id    \
and lmu.user_id = lsh.last_updated_by    \
and lmu.status = 'ACTIVE'    \
AND UPPER(lsh.status) = 'PROCESSED'    \
AND COALESCE(lmo.org_id ,'xx') = COALESCE( ? ,COALESCE(lmo.org_id,'xx'))    \
AND COALESCE(lmpc.category_id ,'xx') = COALESCE( ? ,COALESCE(lmpc.category_id,'xx'))    \
AND COALESCE(lmo.distributor_id ,'xx') = COALESCE(? ,COALESCE(lmo.distributor_id,'xx'))    \
and( lsh.last_update_date between to_date( ?, 'DD-Mon-YY')and to_date(?, 'DD-Mon-YY')    \
or to_char(lsh.last_update_date, 'DD-Mon-YY') = ?   \
or to_char(lsh.last_update_date, 'DD-Mon-YY') = ?)  \
group by lmd.distributor_crm_code,lmpc.category_code,lmd.distributor_name,lmpc.category_name    \
order by lmd.distributor_crm_code asc 


#getReportDataByDistributor = select sum(lsl.quantity::NUMERIC(25,0)* lsl.list_price::NUMERIC(25,0))as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code, \
#	lmpc.category_name, lmpc.category_code \
#	from lt_so_headers lsh \
#	,lt_so_lines lsl \
#	,lt_mast_outlets lmo \
#	,lt_mast_products lmp \
#	,lt_mast_distributors lmd \
#	,lt_mast_prod_categories lmpc \
#	,lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND lsh.status = 'PROCESSED' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
#	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) 

getReportDataByDistributor = select sum(lsl.quantity * lsl.list_price)as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code,    \
lmpc.category_name, lmpc.category_code    \
from lt_so_headers lsh    \
,lt_so_lines lsl    \
,lt_mast_outlets_v lmo    \
,lt_mast_products_v lmp    \
,lt_mast_distributors_v lmd    \
,lt_mast_prod_categories lmpc    \
,lt_mast_users lmu    \
where 1 = 1    \
and lsh.header_id = lsl.header_id    \
and lsl.product_id = lmp.product_id    \
and lmp.category_id = lmpc.category_id    \
and lsh.outlet_id = lmo.outlet_id    \
and lmo.distributor_id = lmd.distributor_id    \
and lmu.user_id = lsh.last_updated_by    \
and lmu.status = 'ACTIVE'    \
AND lsh.status = 'PROCESSED'    \
AND COALESCE(lmo.org_id ,'-99') = COALESCE(?,COALESCE(lmo.org_id,'-99'))    \
AND COALESCE(lmpc.category_id ,'-99') = COALESCE(?,COALESCE(lmpc.category_id,'-99'))    \
AND COALESCE(lmo.distributor_id ,'-99') = COALESCE(?,COALESCE(lmo.distributor_id,'-99'))    \
and ((lsh.last_update_date between to_date(?,'DD-Mon-YY') and to_date(?,'DD-Mon-YY')    \
or to_char(lsh.last_update_date,'DD-Mon-YY') =  ? \
or to_char(lsh.last_update_date,'DD-Mon-YY') = ?)) \
group by lmd.distributor_name,lmd.distributor_crm_code,lmpc.category_name,lmpc.category_code    

	
getReportDataByDistributorCOPY = select lmd.distributor_id, lmd.distributor_name, lmd.distributor_code, lmd.distributor_crm_code,\
	lmpc.category_name, lmpc.category_code, \
	lsl.ptr_price, lsl.list_price , lsl.quantity, lsl.header_id, lsl.line_id from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp, \
	lt_mast_distributors_v lmd, \
	lt_mast_prod_categories lmpc \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id  \
	and lmo.distributor_id = lmd.distributor_id \
	and lmp.category_id = lmpc.category_id \
	AND UPPER(lsh.status) = 'PROCESSED' \
	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
	and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
	
getInStockProductAdmin = SELECT B.* FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
,LMI.QUANTITY \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC, \
LT_MAST_INVENTORY LMI \
where  \
1=1  \
AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
AND UPPER(LMP.STATUS) = 'ACTIVE' \
AND LMI.QUANTITY <> 0 \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY 
#RNUM BETWEEN ?  AND ?


getOutOfStockProductForAdmin = SELECT B.* FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
,LMI.QUANTITY \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC, \
LT_MAST_INVENTORY LMI \
where  \
1=1  \
AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
AND UPPER(LMP.STATUS) = 'ACTIVE' \
AND LMI.QUANTITY = 0 \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY 
#WHERE RNUM BETWEEN ?  AND ?

getOutOfStockProductCountForAdmin=  SELECT count(*) FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
,LMI.QUANTITY \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC, \
LT_MAST_INVENTORY LMI \
where  \
1=1  \
AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
AND UPPER(LMP.STATUS) = 'ACTIVE' \
AND LMI.QUANTITY = 0 \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
AND COALESCE (LMP.ORG_ID,'xx') =COALESCE ( ?, COALESCE(LMP.ORG_ID,'xx')) ) A )B 

getInStockProductCountForAdmin = SELECT count(*) FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
,LMI.QUANTITY \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC, \
LT_MAST_INVENTORY LMI \
where  \
1=1  \
AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
AND UPPER(LMP.STATUS) = 'ACTIVE' \
AND LMI.QUANTITY <> 0 \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B


getInStockProductWithInventory = SELECT B.* FROM \
(select a.*,ROWNUM RNUM from(  \
		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
    LMPL.PRICE_LIST, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
	from \
		lt_mast_products_v lmp \
		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
		where 1=1 \
		AND UPPER(LMP.STATUS) = 'ACTIVE' \
        AND INV.QUANTITY <> 0 \
		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
		and lmo.outlet_id = ?  \
		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
	) A )B \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY 
#WHERE RNUM BETWEEN ? AND ?
	
getInStockProductCountWithInventory =SELECT count(*) FROM \
(select a.*,ROWNUM RNUM from(  \
		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
    LMPL.PRICE_LIST, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
	from \
		lt_mast_products_v lmp \
		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
		where 1=1 \
		AND UPPER(LMP.STATUS) = 'ACTIVE' \
        AND INV.QUANTITY <> 0 \
		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
		and lmo.outlet_id = ?  \
		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
	) A )B
	
getOutOfStockProductWithInventory =  SELECT B.* FROM \
(select a.*,ROWNUM RNUM from(  \
		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
    LMPL.PRICE_LIST, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
	from \
		lt_mast_products_v lmp \
		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
		where 1=1 \
		AND UPPER(LMP.STATUS) = 'ACTIVE' \
        AND INV.QUANTITY = 0 \
		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
		and lmo.outlet_id = ?  \
		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
	) A )B \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY 
#WHERE RNUM BETWEEN ? AND ?
	
getOutOfStockProductCountWithInventory = SELECT count(*) FROM \
(select a.*,ROWNUM RNUM from(  \
		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
    LMPL.PRICE_LIST, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
	from \
		lt_mast_products_v lmp \
		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
		where 1=1 \
		AND UPPER(LMP.STATUS) = 'ACTIVE' \
        AND INV.QUANTITY = 0 \
		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
		and lmo.outlet_id = ?  \
		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
	) A )B