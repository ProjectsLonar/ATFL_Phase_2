limit_value = -1

#getCategory =  SELECT a.* FROM ( \
#    select * from lt_mast_prod_categories lmpc \
#	where lmpc.org_id = ? \
#	AND COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx') like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
#	and upper(lmpc.status) = 'ACTIVE' \
#	) a limit ? OFFSET ? 
	
getCategory = SELECT A.* FROM ( \
    SELECT LMPC.*, ROWNUM RNUM FROM LT_MAST_PROD_CATEGORIES LMPC \
	where lmpc.org_id = ? \
	AND COALESCE(UPPER(CONCAT(LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME)),'xx') \
    like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
	AND UPPER(LMPC.STATUS) = 'ACTIVE' \
	) a OFFSET ? ROWS FETCH NEXT ? ROWS ONLY 
#WHERE RNUM BETWEEN ? AND ?   
	
#getProdCatCount = select count(*) from lt_mast_prod_categories lmpc \
#	where lmpc.org_id = ? \
#	AND COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx') like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
#	and upper(lmpc.status) = 'ACTIVE' 
	
getProdCatCount = select count(*) from lt_mast_prod_categories lmpc \
	where lmpc.org_id = ? \
	AND COALESCE(UPPER(CONCAT(LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME)),'xx') \
    like  COALESCE( ? ,COALESCE(upper(CONCAT(lmpc.category_code,lmpc.category_name)),'xx')) \
	AND UPPER(LMPC.STATUS) = 'ACTIVE' 
	
#getProduct = select a.* from( \
#	select lmp.product_id, lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, lmpl.list_price, lmpl.currency , lmpl.ptr_price  from \
#	lt_mast_products lmp, lt_mast_prod_categories lmpc,  \
#	lt_mast_price_lists lmpl, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lmp.category_id = lmpc.category_id \
#	and lmo.price_list = lmpl.price_list \
#	and lmp.product_code = lmpl.product_code \
#	and upper(lmp.status) = 'ACTIVE' \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
#	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like  \
#	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
#	order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
#	) a limit ? offset ?


getProduct = SELECT B.* FROM (select a.*,ROWNUM RNUM from(   \
SELECT LMP.PRODUCT_ID, LMO.OUTLET_ID   \
,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,   \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS   \
, lmpl.price_list, lmpl.list_price, lmpl.currency , lmpl.ptr_price from   \
lt_mast_products_v lmp, lt_mast_prod_categories lmpc,   \
lt_mast_price_lists_v lmpl,   \
lt_mast_outlets_v lmo   \
where 1=1   \
and lmp.category_id = lmpc.category_id   \
and lmo.price_list = lmpl.price_list   \
and lmp.product_code = lmpl.product_code   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.ORG_ID,'xx'))   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID , 'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID, 'xx'))   \
AND COALESCE(LMO.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.OUTLET_ID,'xx'))   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE   \
COALESCE( ? ,COALESCE(upper(lmp.product_name || lmp.product_code || lmpl.list_price),'xx'))   \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC   \
) a)B OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE RNUM BETWEEN ? AND ? 



cmntFORPRODUCT = order by lmo.outlet_id  DESC, distinct(lmp.product_id), \

#getProductCount = select count(*) from \
#	lt_mast_products_v lmp, lt_mast_prod_categories lmpc, \
#	lt_mast_price_lists lmpl,  \
#	lt_mast_outlets lmo  \
#	where 1=1  \
#	and lmp.category_id = lmpc.category_id \
#	and lmo.price_list = lmpl.price_list  \
#	and lmp.product_code = lmpl.product_code \
#	and upper(lmp.status) = 'ACTIVE'  \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)

getProductCount = SELECT COUNT(*)   \
FROM   \
lt_mast_products_v lmp   \
JOIN LT_MAST_PROD_CATEGORIES LMPC ON LMP.CATEGORY_ID = LMPC.CATEGORY_ID   \
JOIN lt_mast_price_lists_v lmpl ON lmp.product_code = lmpl.product_code   \
JOIN lt_mast_outlets_v lmo ON lmo.price_list = lmpl.price_list   \
WHERE   \
1 = 1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID, '-99') = COALESCE( ?, COALESCE(LMP.ORG_ID, '-99'))   \
AND COALESCE(LMP.PRODUCT_ID, '-99') = COALESCE(?, COALESCE(LMP.PRODUCT_ID, '-99'))   \
AND COALESCE(LMP.CATEGORY_ID, '-99') = COALESCE(?, COALESCE(LMP.CATEGORY_ID, '-99'))   \
AND COALESCE(LMO.OUTLET_ID, '-99') = COALESCE(?, COALESCE(LMO.OUTLET_ID, '-99'))  

#getProductCountForAdmin = select count(*) from \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lmp.category_id = lmpc.category_id \
#	and upper(lmp.status) = 'ACTIVE' \
#	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
#	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) 
	
getProductCountForAdmin = SELECT COUNT(*)   \
FROM   \
lt_mast_products_v lmp   \
JOIN lt_mast_prod_categories lmpc ON lmp.category_id = lmpc.category_id   \
WHERE   \
1 = 1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.ORG_ID, '-99') = COALESCE(?, COALESCE(LMP.ORG_ID, '-99'))   \
AND COALESCE(lmp.product_id, '-99') = COALESCE(?, COALESCE(lmp.product_id, '-99'))   \
AND COALESCE(LMP.CATEGORY_ID, '-99') = COALESCE(?, COALESCE(LMP.CATEGORY_ID, '-99')) 
	
getProductCountForAdminCOPY = select count(*) from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc , \
	(select distinct lmpl1.product_code,lmpl1.list_price from lt_mast_price_lists_v lmpl1) lmpl \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmp.product_code = lmpl.product_code \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99)
	
#getProductForAdmin = select a.* from( \
#select distinct lmp.product_id, lmp.*, lmpc.*  from \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc \
#where \
#1=1 \
#and lmp.category_id = lmpc.category_id \
#and upper(lmp.status) = 'ACTIVE' \
#AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx') like \
#COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx')) \
#AND lmp.org_id  =  COALESCE( ? ,lmp.org_id) \
#) a limit ? offset ?
	
getProductForAdmin = SELECT B.* FROM (   \
SELECT ROWNUM RNUM,A.*   \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,  \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS   \
from   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc   \
where   \
1=1   \
and lmp.category_id = lmpc.category_id   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx'))   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE   \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx'))   \
AND LMP.ORG_ID = COALESCE( ? ,LMP.ORG_ID) ) A )B OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

#WHERE RNUM BETWEEN ? AND ? 

	
getProductForAdminCOPY = select a.* from( \
	select lmp.product_id, lmp.*, lmpc.*, lmpl.list_price  from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc , \
	(select distinct lmpl1.product_code,lmpl1.list_price from lt_mast_price_lists_v lmpl1) lmpl \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmp.product_code = lmpl.product_code \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99)  \
	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx') like  \
	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code)),'xx')) \
	) a limit ? offset ?

getUserTypeByUserId = select lmu.user_type from lt_mast_users lmu where lmu.user_id = ?

getProductCountWithInventory9FEB_OLD = select count(*) from \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_price_lists_v lmpl,  \
	lt_mast_outlets_v lmo  , \
	lt_mast_inventory_v inv, \
	lt_mast_distributors_v lmd \
	where 1=1  \
	and lmp.category_id = lmpc.category_id \
	and lmo.price_list = lmpl.price_list  \
	and lmp.product_code = lmpl.product_code \
	and lmd.distributor_code = inv.dist_code \
	and lmp.product_code = inv.product_code \
	and lmo.distributor_id = lmd.distributor_id \
	and upper(lmp.status) = 'ACTIVE'  \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)
	
getProductWithInventory9FEB_OLD = select a.* from( \
	select inv.quantity as inventory_quantity, inv.inventory_code, lmp.product_id, lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, \
	lmpl.list_price, lmpl.currency , lmpl.ptr_price  from  \
	lt_mast_products_v lmp, lt_mast_prod_categories lmpc,  \
	lt_mast_price_lists_v lmpl,  \
	lt_mast_outlets_v lmo ,\
	lt_mast_inventory_v inv, \
	lt_mast_distributors_v lmd \
	where 1=1 \
	and lmp.category_id = lmpc.category_id \
	and lmo.price_list = lmpl.price_list \
	and lmp.product_code = lmpl.product_code \
	and lmd.distributor_code = inv.dist_code \
	and lmp.product_code = inv.product_code \
	and lmo.distributor_id = lmd.distributor_id \
	and upper(lmp.status) = 'ACTIVE' \
	AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
	AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
	AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
	AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
	AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
	order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
	) a limit ? offset ?

getProductCountWithInventoryCOPY = select count(*) \
	from \
		lt_mast_products_v lmp \
		left join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
	where 1=1  \
		and upper(lmp.status) = 'ACTIVE' \
		AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
		AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
		AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
		AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99)

#getProductCountWithInventory = select count(*) \
#	from \
#		lt_mast_products lmp \
#		Inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND lmp.org_id = COALESCE(?,lmp.org_id) \
#		AND COALESCE(lmp.product_id ,-99) = COALESCE( ? ,COALESCE(lmp.product_id),-99) \
#		AND COALESCE(lmp.category_id ,-99) = COALESCE( ? ,COALESCE(lmp.category_id),-99) \
#		AND lmo.outlet_id =  ?

getProductCountWithInventory = select count(*)   \
from   \
lt_mast_products_v lmp   \
Inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id   \
left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code   \
left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list   \
left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id  \
left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code   \
where 1=1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND LMP.ORG_ID = COALESCE(?,LMP.ORG_ID)   \
AND COALESCE(LMP.PRODUCT_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx'))   \
AND COALESCE(LMP.CATEGORY_ID ,'xx') = COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx'))   \
AND lmo.outlet_id =  ?
		
getProductWithInventoryCOPY = select a.* from( \
		 select lmp.product_id, inv.quantity as inventory_quantity, inv.inventory_code,  lmo.outlet_id ,lmp.*, lmpc.*, lmpl.price_list, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price  \
	from  \
		lt_mast_products_v lmp \
		left join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
	where 1=1  \
		and upper(lmp.status) = 'ACTIVE' \
		AND COALESCE(lmp.org_id ,-99) =  COALESCE( ? ,COALESCE(lmp.org_id),-99) \
		AND COALESCE(lmp.product_id ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id),-99) \
		AND COALESCE(lmp.category_id ,-99) =  COALESCE( ? ,COALESCE(lmp.category_id),-99) \
		AND COALESCE(lmo.outlet_id ,-99) =  COALESCE( ? ,COALESCE(lmo.outlet_id),-99) \
		AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
		COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
		order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
	) a limit ? offset ?
	
#getProductWithInventory = select a.* from( \
#		 select lmp.product_id, inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 lmp.*, lmpc.*, lmpl.price_list, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from  \
#		lt_mast_products lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND lmp.org_id = COALESCE(?,lmp.org_id) \
#		AND lmp.product_id =  COALESCE(?,lmp.product_id) \
#		and lmp.category_id = COALESCE(?,lmp.category_id) \
#		AND COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx') like \
#	 	COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_name ,lmp.product_code, lmpl.list_price)),'xx')) \
#		and lmo.outlet_id = ? \
#		order by CAST(coalesce(lmpl.list_price, '0') AS numeric) ASC \
#	) a limit ? offset ?


#getProductWithInventory = SELECT B.* FROM \
#(select a.*,ROWNUM RNUM from( \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		     LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP.BRAND,LMP.SUBBRAND,LMP."style",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, \
#    LMP.PTR_FLAG, \
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#         lmpl.price_list, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from  \
#		lt_mast_products lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists lmpl on lmp.product_code = lmpl.product_code \
#		left join lt_mast_outlets lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#	where 1=1 \
#		and upper(lmp.status) = 'ACTIVE' \
#		AND LMP.ORG_ID = COALESCE(1,LMP.ORG_ID) \
#		AND lmp.product_id =  COALESCE(2132,lmp.product_id) \
#		AND LMP.CATEGORY_ID = COALESCE(3,LMP.CATEGORY_ID) \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
#		COALESCE( null ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
#		and lmo.outlet_id = 405406 \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, '0') AS NUMERIC) ASC \
#	) A )B WHERE RNUM BETWEEN 1 AND 2

getProductWithInventory = SELECT B.* FROM   \
(select a.*,ROWNUM RNUM from(   \
select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id,   \
LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY,   \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE,   \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,  \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS,   \
lmpl.price_list,   \
lmpl.list_price, lmpl.currency , lmpl.ptr_price  \
from   \
lt_mast_products_v lmp   \
inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id   \
left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code   \
left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list   \
left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id   \
left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code   \
where 1=1   \
AND UPPER(LMP.STATUS) = 'ACTIVE'   \
AND LMP.ORG_ID = COALESCE( ? ,LMP.ORG_ID)   \
AND LMP.PRODUCT_ID = COALESCE( ? ,LMP.PRODUCT_ID)  \
AND LMP.CATEGORY_ID = COALESCE( ? ,LMP.CATEGORY_ID)   \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE   \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx'))   \
AND LMO.OUTLET_ID = ?    \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC   \
) A )B OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


#WHERE RNUM BETWEEN ? AND ? 


#findSearchProduct = select a.* from ( \
#	select pm.* from lt_mast_products pm \
#	where upper (pm.product_desc || pm.product_name) like upper('%' || ? || '%') \
#	and upper(pm.status) = 'ACTIVE' \
#	and org_id= ? ORDER by pm.product_id  desc \
#	) a limit ? offset ?

findSearchProduct = SELECT A.* FROM ( \
	SELECT PM.*,ROWNUM RNUM FROM LT_MAST_PRODUCTS_v PM \
	where upper (pm.product_desc || pm.product_name) like upper('%' || ? || '%') \
	AND UPPER(PM.STATUS) = 'ACTIVE' \
	AND ORG_ID= ? ORDER BY PM.PRODUCT_ID  DESC \
	) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE RNUM BETWEEN ? AND ?

#findFAQbyOrgId= SELECT * FROM lt_mast_faq WHERE org_id = ?

findFAQbyOrgId= select * from lt_mast_faq lmf  \
WHERE 1 = 1  \
and org_id = ? \
AND COALESCE(UPPER(LMF.USER_TYPE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMF.USER_TYPE),'xx')) ORDER BY LMF.FAQ_ID ASC 


### Dashboard

#dateConditionChng = and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \

dateConditionChng = and lsh.last_update_date >  SYSDATE - ADD_MONTHS(SYSDATE,'-1') \

#statusWiseOrdersCountForAdmin = select count(lsh.status) as recordCount, lsh.status \
#	from \
#	lt_so_headers lsh,\
#	lt_mast_outlets lmo, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and upper(lsh.status) <> 'DELIVERED' \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.last_update_date at time zone 'IST'>= date_trunc('month', CURRENT_DATE) \
#	and lmo.org_id = ? \
#	group by lsh.status

statusWiseOrdersCountForAdmin = select count(lsh.status) as recordCount, lsh.status   \
from   \
lt_so_headers lsh,   \
lt_mast_outlets_v lmo,   \
lt_mast_users lmu   \
where 1=1   \
and upper(lsh.status) <> 'DELIVERED'   \
and lsh.outlet_id = lmo.outlet_id   \
and lmu.user_id = lsh.last_updated_by   \
AND LMU.STATUS = 'ACTIVE'   \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
AND LMO.ORG_ID = ?   \
GROUP BY LSH.STATUS

#AND LSH.LAST_UPDATE_DATE >= TRUNC(TO_DATE(?, 'DD-MON-YY'), 'MONTH') \
	
#statusWiseOrdersCountForDistributor = select count(lsh.status ) as recordCount, lsh.status \
#	from \
#	lt_so_headers lsh,\
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and upper(lsh.status) <> 'DELIVERED' \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmo.org_id = ?
	
statusWiseOrdersCountForDistributor = select count(lsh.status ) as recordCount, lsh.status  \
from  \
lt_so_headers lsh, \
lt_mast_outlets_v lmo  \
where 1=1  \
and upper(lsh.status) <> 'DELIVERED'  \
and lsh.outlet_id = lmo.outlet_id  \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
AND LMO.ORG_ID = ? \

#AND LSH.LAST_UPDATE_DATE >= TRUNC(TO_DATE(?, 'DD-MON-YY'), 'MONTH')  \
#group by lsh.status 
	
#categoryRevenueDistributionForDistributor =  select \
#	lmpc.category_name,lmpc.category_id \
#	,sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue ,count(distinct lsl.header_id)as dbc \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE)
	
#sum(lsl.ptr_price * lsl.quantity)as revenue  temprary comment must be used in below query
categoryRevenueDistributionForDistributor =	select   \
CASE \
        WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE ROUND(NVL(TO_NUMBER(lsl.ptr_price), 0) * NVL(lsl.quantity, 0), 2)  \
    END AS revenue, \
lmpc.category_name,lmpc.category_id   \
,count(distinct lsl.header_id)as dbc   \
from   \
lt_so_headers lsh ,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsh.header_id = lsl.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lmu.user_id = lsh.last_updated_by   \
and lmu.status = 'ACTIVE'   \
AND (LSH.STATUS = 'PROCESSED' OR LSH.STATUS = 'APPROVED')   \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH')

#AND LSH.LAST_UPDATE_DATE >= TRUNC(TO_DATE(? ,'DD-MON-YY') , 'MONTH')

#AND LSH.LAST_UPDATE_DATE >= TRUNC(?, 'MONTH') 
	
categoryRevenueDistributionForDistributorCOPY = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date, \
	lmp.product_id, lmp.product_name, lmpc.category_id , lmpc.category_name , lmpc.category_desc , \
	lmo.price_list , lsl.list_price, lsl.quantity, lsl.ptr_price \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date  >=  date_trunc('month', CURRENT_DATE)

#categoryRevenueDistributionForAdmin = select \
#	lmpc.category_name,lmpc.category_id \
#	,sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue, count(distinct lsl.header_id)as dbc \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	group by lmpc.category_name,lmpc.category_id 

#sum(lsl.ptr_price * lsl.quantity)as revenue, comment temprary must be used in below query	on 18-May-2024 
#categoryRevenueDistributionForAdmin = select \
#	sum(lsl.ptr_price * lsl.quantity)as revenue, lmpc.category_name,lmpc.category_id \
#	, count(distinct lsl.header_id)as dbc \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products_v lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND (LSH.STATUS = 'PROCESSED' OR LSH.STATUS = 'APPROVED') \
#	AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
#    GROUP BY LMPC.CATEGORY_NAME,LMPC.CATEGORY_ID
 
 #   AND LSH.LAST_UPDATE_DATE >= TRUNC(TO_DATE(? ,'DD-MON-YY') , 'MONTH')	\
    
categoryRevenueDistributionForAdmin = select lmpc.category_name,lmpc.category_id, \
        CASE \
        WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE ROUND(NVL(TO_NUMBER(lsl.ptr_price), 0) * NVL(lsl.quantity, 0), 2)  \
    END AS revenue, \
	count(distinct lsl.header_id)as dbc \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.status = 'ACTIVE' \
	AND (LSH.STATUS = 'PROCESSED' OR LSH.STATUS = 'APPROVED') \
	AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
    GROUP BY LMPC.CATEGORY_NAME,LMPC.CATEGORY_ID,lsl.ptr_price,lsl.quantity,lsl.HEADER_ID
    
   
categoryRevenueDistributionForAdminCOPY = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date, \
	lmp.product_id, lmp.product_name, lmpc.category_id , lmpc.category_name , lmpc.category_desc , \
	lmo.price_list , lsl.list_price, lsl.quantity, lsl.ptr_price \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lmu.user_id = lsh.last_updated_by \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date >=  date_trunc('month', CURRENT_DATE) \
	order by lsh.header_id , lsh.last_update_date

#dailySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	order by lsh.header_id , lsh.last_update_date 

dailySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	AND LMO.ORG_ID = ? \
	AND LSH.LAST_UPDATE_DATE > ADD_MONTHS(TO_DATE(SYSDATE ,'YYYY-MM-DD') ,'-1') \
	ORDER BY LSH.HEADER_ID , LSH.LAST_UPDATE_DATE
	
#dailySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months'

dailySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	AND LMO.ORG_ID = ? \
	AND LSH.LAST_UPDATE_DATE >  ADD_MONTHS(TO_DATE(SYSDATE ,'YYYY-MM-DD') ,'-1')

#monthlySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#	order by lsh.header_id , lsh.last_update_date


#this is original query comment on 20-May-2024
monthlySalesForAdmin = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	and lsh.last_update_date >  ADD_MONTHS(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'-12') \
	ORDER BY LSH.HEADER_ID , LSH.LAST_UPDATE_DATE
	
#monthlySalesForAdmin = select \
#	to_char(lsh.last_update_date, 'DD-MON-YY')as month,  \
#to_char((select count(*)from lt_so_lines)) as tls , \
#to_char (count(distinct lsl.header_id))as dbc, \
#        CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0   \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE TO_NUMBER (nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')) \
#    END AS sale \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_products_v lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets_v lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = '1' \
#	and lsh.last_update_date >  ADD_MONTHS(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'-12') \
#	GROUP BY to_char(lsh.last_update_date, 'DD-MON-YY'), lsl.header_id, lsl.ptr_price, lsl.quantity 
	
	
#monthlySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
#	lsl.list_price , lsl.ptr_price, lsl.quantity  \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl,\
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lmo.org_id = ? \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months'

monthlySalesForDistributor = select distinct (lsl.line_id ),lsh.header_id, lsh.last_update_date as creationDate, \
	lsl.list_price , lsl.ptr_price, lsl.quantity \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and lsh.outlet_id = lmo.outlet_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lmo.org_id = ? \
	AND LSH.LAST_UPDATE_DATE >  ADD_MONTHS(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'-12')
	
#addedForDistributorDashboard = and lsh.created_by in ()) order by lsh.header_id , lsh.last_update_date \
#		get userid form getUsersByDistributorId query 

addedForDistributorDashboard = and lsh.created_by in ()) order by lsh.header_id , lsh.last_update_date \
		get userid form getUsersByDistributorId query
		
#getUserTypeAndDisId = select lmu.user_type, lmu.distributor_id ,lmu.position_id from lt_mast_users lmu where lmu.user_id = ?

getUserTypeAndDisId = select lmu.user_type, lmu.distributor_id ,lmu.position_id from lt_mast_users lmu where lmu.user_id = ?

#getUsersByDistributorIdCOPY = select lmu.user_id from lt_mast_users lmu where lmu.distributor_id  = ?

getUsersByDistributorIdCOPY = select lmu.user_id from lt_mast_users lmu where lmu.distributor_id  = ?

#getUsersByDistributorId = select lmu.user_id from \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lmu.status = 'ACTIVE' \
#and lmu.distributor_id  = ?

getUsersByDistributorId = select lmu.user_id from \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lmu.status = 'ACTIVE' \
and lmu.distributor_id  = ?


#getUsersBySalesOfficer = select lmu2.user_id from \
#(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  									select lme.distributor_id from lt_mast_emp_position lmep ,lt_mast_employees lme \
#   									where 1=1 \
#   									and lme.employee_id = lmep.employee_id \
#   									and lmep.position_id in ( \
#   									select lmp.position_id from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp ."position" from lt_mast_positions lmp where lmp.position_id = ?)) \
#   							) \
#  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
#  and lmu.status = 'ACTIVE') lmu2,lt_mast_employees lme ,lt_mast_emp_position lmep \
#  where 1=1 \
#  and lmu2.employee_code = lme.employee_code \
#  and lme.employee_id = lmep.employee_id \
#  and lmu2.position_id = lmep.position_id


#comment on 13-May-2024  to resolve report issue
#getUsersBySalesOfficer = select lmu2.user_id from  \
#(SELECT LMU.USER_ID, LMU.USER_TYPE,LMU.EMPLOYEE_CODE,LMU.POSITION_ID  \
#from lt_mast_users lmu  \
#where 1=1  \
#AND LMU.DISTRIBUTOR_ID IN (  \
#  									select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme  \
#   									where 1=1  \
#   									and lme.employee_id = lmep.employee_id  \
#   									AND LMEP.POSITION_ID IN (  \
#   									SELECT LMP.POSITION_ID FROM LT_MAST_POSITIONS_V LMP WHERE LMP.PARENT_POSITION IN (  \
#   									select lmp ."position" from lt_mast_positions_v lmp where lmp.position_id = ?))  \
#   							)  \
#  AND (LMU.USER_TYPE = 'DISTRIBUTOR' OR LMU.USER_TYPE = 'SALES')  \
#  and lmu.status = 'ACTIVE') lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep  \
#  where 1=1  \
#  and lmu2.employee_code = lme.employee_code  \
#  AND LME.EMPLOYEE_ID = LMEP.EMPLOYEE_ID  \
#  AND LMU2.POSITION_ID = LMEP.POSITION_ID

  
# This is original query comment on 14-May-24 bcz it takes too much time for execute.  	
#getUsersBySalesOfficer = select lmu2.user_id from  \
#(SELECT LMU.USER_ID, LMU.USER_TYPE,LMU.EMPLOYEE_CODE,LMU.POSITION_ID  \
#from lt_mast_users lmu  \
#where 1=1  \
#AND LMU.DISTRIBUTOR_ID IN (  \
#  									select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme \
#   									where 1=1  \
#   									and lme.employee_id = lmep.employee_id  \
#   									AND LMEP.POSITION_ID IN (  \
#   									SELECT LMP.POSITION_ID FROM LT_MAST_POSITIONS_V LMP WHERE LMP."position" IN (  \
#   									select lmp ."position" from lt_mast_positions_v lmp where lmp.position_id = ?)) \
#   							)  \
#  AND (LMU.USER_TYPE = 'DISTRIBUTOR' OR LMU.USER_TYPE = 'SALES')  \
#  and lmu.status = 'ACTIVE') lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep  \
#  where 1=1  \
#  and lmu2.employee_code = lme.employee_code  \
#  AND LME.EMPLOYEE_ID = LMEP.EMPLOYEE_ID  \
#  AND LMU2.POSITION_ID = LMEP.POSITION_ID
  	
  	
getUsersBySalesOfficer = SELECT LMU2.USER_ID FROM \
     (SELECT  LMU.USER_ID, LMU.USER_TYPE,LMU.EMPLOYEE_CODE,LMU.POSITION_ID  \
      FROM LT_MAST_USERS LMU \
      WHERE 1=1 \
      AND LMU.DISTRIBUTOR_ID IN \
                 (SELECT LME.DISTRIBUTOR_ID FROM SIEBEL.S_PARTY_PER LMEP \
                 ,LT_MAST_EMPLOYEES_V LME \
                  WHERE 1=1 \
                  AND LME.EMPLOYEE_ID = LMEP.PERSON_ID \
                  AND LMEP.PARTY_ID IN ( \
                  SELECT POS.ROW_ID FROM SIEBEL.S_POSTN POS WHERE POS.ROW_ID  = ?)) \
  AND (LMU.USER_TYPE = 'DISTRIBUTOR' OR LMU.USER_TYPE = 'SALES') \
  and lmu.status = 'ACTIVE' ) lmu2 ,lt_mast_employees_v lme ,SIEBEL.S_PARTY_PER lmep \
  where 1=1 \
  and lmu2.employee_code = lme.employee_code \
  AND LME.EMPLOYEE_ID = LMEP.PERSON_ID \
  AND LMU2.POSITION_ID = LMEP.PARTY_ID
    	
  	   
getUsersBySalesOfficerCOPY1 =  select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where distributor_id in ( \
  select distinct lme.distributor_id \
  from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
  lt_mast_users lmu, lt_mast_positions_v lmp2 \
  	   where lme.employee_id = lmp.employee_id \
       and lmu.position_id = lmp2.position_id \
   	   and lmp.parent_position = lmp2.position \
   	   and lmu.user_id = ? ) \
   	   and lmu.user_type != 'AREAHEAD' \
  	   and lmu.user_type != 'SALESOFFICER') lmu2 \
  	   ,lt_mast_employees_v lme \
  	   ,lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and lmu2.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and lmu2.position_id = lmep.position_id 
   	   
getUsersBySalesOfficerCOPY =  select lmu.user_id  \
  from lt_mast_users lmu where distributor_id in ( \
  		select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			lt_mast_users lmu, lt_mast_positions_v lmp2 \
  	   where lme.employee_id = lmp.employee_id \
       and lmu.position_id = lmp2.position_id \
   	   and lmp.parent_position = lmp2.position \
   	   and lmu.user_id = ? )


#getReportUsersByAreaHead = select lmu2.user_id from \
#(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  									 select lme.distributor_id from lt_mast_emp_position lmep ,lt_mast_employees lme \
#   									where 1=1 \
#   									and lme.employee_id = lmep.employee_id \
#   									and lmep.position_id in ( \
#   									select lmp.position_id from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions lmp where lmp.position_id = ? ))) \
#   							) \
#  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
#  and lmu.status = 'ACTIVE' ) lmu2,lt_mast_employees lme ,lt_mast_emp_position lmep \
#  where 1=1 \
#  and lmu2.employee_code = lme.employee_code \
#  and lme.employee_id = lmep.employee_id \
#  and lmu2.position_id = lmep.position_id 
  		
 
#comment on 13-May-2024 me & shubham for report issue   
#getReportUsersByAreaHead = select lmu2.user_id from \
#(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  									 select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme \
#   									where 1=1 \
#   									and lme.employee_id = lmep.employee_id \
#   									and lmep.position_id in ( \
#   									select lmp.position_id from lt_mast_positions_v lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions_v lmp where lmp.parent_position in ( \
#   									select lmp."position" from lt_mast_positions_v lmp where lmp.position_id = ? ))) \
#   							) \
#  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
#  and lmu.status = 'ACTIVE' ) lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep \
#  where 1=1 \
#  and lmu2.employee_code = lme.employee_code \
#  and lme.employee_id = lmep.employee_id \
#  AND LMU2.POSITION_ID = LMEP.POSITION_ID  		


getReportUsersByAreaHead =  select lmu2.user_id from \
(select lmu.user_id, lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  								 select lme.distributor_id from lt_mast_emp_position_v lmep ,lt_mast_employees_v lme \
   									where 1=1 \
   									and lme.employee_id = lmep.employee_id \
   									and lmep.position_id in ( \
   									select lmp.position_id from lt_mast_positions_v lmp where lmp."position" in ( \
   									select lmp."position" from lt_mast_positions_v lmp where lmp."position" in ( \
   									select lmp."position" from lt_mast_positions_v lmp where lmp.position_id = ? ))) \
   							) \
  and (lmu.user_type = 'DISTRIBUTOR' OR lmu.user_type = 'SALES') \
  and lmu.status = 'ACTIVE' ) lmu2,lt_mast_employees_v lme ,lt_mast_emp_position_v lmep \
  where 1=1 \
  and lmu2.employee_code = lme.employee_code \
  and lme.employee_id = lmep.employee_id \
  AND LMU2.POSITION_ID = LMEP.POSITION_ID  		


  		
getReportUsersByAreaHeadCOPY1 =  select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select distinct  lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( select distinct lmu.user_id from  \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? \
  	) lmep2 \
  	,lt_mast_users lmu \
  	,lt_mast_employees_v lme \
  	where 1=1 \
  	and lmep2.position_id  = lmu.position_id \
  	and lme.employee_code = lmu.employee_code \
  	and lmep2.employee_id  = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' ))) abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id \
  		and abc.user_type != 'AREAHEAD' \
  		and abc.user_type != 'SALESOFFICER' 
  
# getUsersByAreaHead =  select distinct lmu2.user_id  \
# from lt_mast_positions lmp, lt_mast_users lmu \
#    , lt_mast_emp_position mep, lt_mast_positions lmp2 \
#    , lt_mast_emp_position mep2 ,  lt_mast_employees lme \
#    , lt_mast_users lmu2  \
# where lmp.position_id = lmu.position_id  \
#  and mep.parent_position = lmp.position \
#  and mep.position_id = lmp2.position_id \
#  and lmp2.position = mep2.parent_position  \
#  and lme.employee_id = mep2.employee_id  \
#  and lmu2.employee_code =  lme.employee_code \
#  and lmu.user_id = ?

getUsersByAreaHead =  select distinct lmu2.user_id \
 from lt_mast_positions_v lmp, lt_mast_users lmu \
    , lt_mast_emp_position_v mep, lt_mast_positions_v lmp2 \
    , lt_mast_emp_position_v mep2 ,  lt_mast_employees_v lme \
    , lt_mast_users lmu2 \
 WHERE LMP.POSITION_ID = LMU.POSITION_ID \
  and mep.parent_position = lmp."position" \
  AND MEP.POSITION_ID = LMP2.POSITION_ID \
  and lmp2."position" = mep2.parent_position \
  and lme.employee_id = mep2.employee_id \
  AND LMU2.EMPLOYEE_CODE =  LME.EMPLOYEE_CODE \
  AND LMU.USER_ID =?

getReportUsersByAreaHeadCOPY = select lmu.user_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   		 lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( \
   	   	select lmu2.user_id \
   	   	from lt_mast_users lmu2 \
   	   	where lmu2.position_id in ( \
			  select lmep.position_id \
			  from lt_mast_emp_position_v lmep \
			  where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ?)) \
  and lmu2.user_type='SALESOFFICER'))
  
#  getUsersByMonthlySalesAH = select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu.user_id in( \
#   	   				select lmu.user_id from lt_mast_users lmu where lmu.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu.user_type='SALESOFFICER')) 

getUsersByMonthlySalesAH = select lmu.user_id \
  			from lt_mast_users lmu \
  			where distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu, lt_mast_positions_v lmp2 \
   				where lme.employee_id = lmp.employee_id \
       			AND LMU.POSITION_ID = LMP2.POSITION_ID \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu.user_id in( \
   	   				select lmu.user_id from lt_mast_users lmu where lmu.position_id in ( \
							select lmep.position_id \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position" \
  								FROM LT_MAST_POSITIONS_v LMP \
  								where lmp.position_id = ? \
  )) \
  AND LMU.USER_TYPE='SALESOFFICER'))

#Reports
#getReportDataBySalesPersonAdmin = select \
#	lsh.order_number,lsh.status, lsh.order_date as orderDate \
#	,lmo.outlet_name ,lmo.outlet_code ,lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress \
#	,lsl.list_price ,lsl.ptr_price,lsl.quantity \
#	,lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code \
#	,lmp.product_code,lmp.product_name ,lmp.product_desc \
#	,concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,lme.employee_code,lme.employee_id \
#	from \
#	lt_so_headers lsh inner join lt_so_lines lsl on lsh.header_id = lsl.header_id \
#	inner join lt_mast_products lmp on lsl.product_id = lmp.product_id \
#	inner join lt_mast_outlets lmo on lsh.outlet_id = lmo.outlet_id \
#	inner join lt_mast_distributors lmd on lmo.distributor_id = lmd.distributor_id \
#	inner join lt_mast_users lmu on lsh.last_updated_by = lmu.user_id \
#	inner join lt_mast_employees lme on lmu.employee_code = lme.employee_code \
#	where 1=1 \
#	and lmu.status = 'ACTIVE' \
#	AND COALESCE(lsh.status ,'xx') = COALESCE(? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) = COALESCE(? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) = COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) = COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	order by lsh.order_number desc

#comment on 21-May-2024 by me
#getReportDataBySalesPersonAdmin = select   \
#LSH.ORDER_NUMBER,LSH.STATUS, LSH.ORDER_DATE AS ORDERDATE   \
#,lmo.outlet_name ,lmo.outlet_code ,lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress   \
#,lsl.list_price ,lsl.ptr_price,lsl.quantity   \
#,lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code   \
#,LMP.PRODUCT_CODE,LMP.PRODUCT_NAME ,LMP.PRODUCT_DESC   \
#,(lme.first_name ||' '|| lme.last_name) as SalesPersonName,lme.employee_code,lme.employee_id   \
#from   \
#lt_so_headers lsh inner join lt_so_lines lsl on lsh.header_id = lsl.header_id   \
#inner join lt_mast_products_v lmp on lsl.product_id = lmp.product_id   \
#inner join lt_mast_outlets_v lmo on lsh.outlet_id = lmo.outlet_id   \
#inner join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id   \
#inner join lt_mast_users lmu on lsh.last_updated_by = lmu.user_id   \
#inner join lt_mast_employees_v lme on lmu.employee_code = lme.employee_code   \
#where 1=1   \
#AND LMU.STATUS = 'ACTIVE'   \
#AND COALESCE(LSH.STATUS ,'xx') = COALESCE(? ,COALESCE(LSH.STATUS,'xx'))   \
#AND COALESCE(LME.ORG_ID ,'xx') = COALESCE(? ,COALESCE(LME.ORG_ID,'xx'))   \
#AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))   \
#AND COALESCE(LME.EMPLOYEE_ID ,'xx') = COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))   \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
#or to_char(lsh.last_update_date , 'DD-MON-YY') = ?   \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )   \
#ORDER BY LSH.ORDER_NUMBER DESC  


# this is original quey comment by vaibhav on 31-May-2024 for optimization
#getReportDataBySalesPersonAdmin = select   \
#LSH.ORDER_NUMBER,LSH.STATUS, LSH.ORDER_DATE AS ORDERDATE   \
#,lmo.outlet_name ,lmo.outlet_code ,lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress   \
#,(case \
# WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
# ELSE ROUND(TO_NUMBER(lsl.list_price),2) \
# END )AS list_price1, \
#(case \
# WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
# ELSE ROUND(TO_NUMBER(lsl.ptr_price),2) \
# END )AS ptr_price1, \
#(CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (lsl.quantity),2) \
#END )AS quantity1,   \
#(case \
#WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
#END ) * (CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
#END ) \
#AS total \
#,lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code   \
#,LMP.PRODUCT_CODE,LMP.PRODUCT_NAME ,LMP.PRODUCT_DESC   \
#,(lme.first_name ||' '|| lme.last_name) as SalesPersonName,lme.employee_code,lme.employee_id   \
#from   \
#lt_so_headers lsh inner join lt_so_lines lsl on lsh.header_id = lsl.header_id   \
#inner join lt_mast_products_v lmp on lsl.product_id = lmp.product_id   \
#inner join lt_mast_outlets_v lmo on lsh.outlet_id = lmo.outlet_id   \
#inner join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id   \
#inner join lt_mast_users lmu on lsh.last_updated_by = lmu.user_id   \
#inner join lt_mast_employees_v lme on lmu.employee_code = lme.employee_code   \
#where 1=1   \
#AND LMU.STATUS = 'ACTIVE'   \
#AND COALESCE(LSH.STATUS ,'xx') = COALESCE(? ,COALESCE(LSH.STATUS,'xx'))   \
#AND COALESCE(LME.ORG_ID ,'xx') = COALESCE(? ,COALESCE(LME.ORG_ID,'xx'))   \
#AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))   \
#AND COALESCE(LME.EMPLOYEE_ID ,'xx') = COALESCE( null ,COALESCE(LME.EMPLOYEE_ID,'xx'))   \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
#or to_char(lsh.last_update_date , 'DD-MON-YY') = ?   \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )   \
#ORDER BY LSH.ORDER_NUMBER DESC  


getReportDataBySalesPersonAdmin = select lsv.*, (case \
 WHEN list_price LIKE '%*%' OR list_price LIKE '%''%' OR list_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(list_price),2) \
 END )AS list_price1, \
(case \
 WHEN ptr_price LIKE '%*%' OR ptr_price LIKE '%''%' OR ptr_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(ptr_price),2) \
 END )AS ptr_price1, \
(CASE \
	WHEN quantity LIKE '%*%' OR quantity LIKE '%''%' OR quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (quantity),2) \
END )AS quantity1, \
(case \
WHEN ptr_price LIKE '%*%' OR ptr_price LIKE '%''%' OR ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(PTR_PRICE),2) \
END ) * (CASE \
	WHEN quantity LIKE '%*%' OR quantity LIKE '%''%' OR quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (QUANTITY),2) \
END ) \
AS total \
from Lt_salesReportForAdmin_V lsv \
WHERE \
COALESCE(lsv.STATUS ,'xx') = COALESCE(? ,COALESCE(lsv.STATUS,'xx'))   \
AND COALESCE(lsv.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(lsv.DISTRIBUTOR_ID,'xx'))   \
AND COALESCE(lsv.EMPLOYEE_ID ,'xx') = COALESCE( null ,COALESCE(lsv.EMPLOYEE_ID,'xx'))   \
AND ((lsv.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
or to_char(lsv.last_update_date , 'DD-MON-YY') = ?   \
OR TO_CHAR(LAST_UPDATE_DATE , 'DD-MON-YY') = ? )   



#getReportDataBySalesPersonAdminOLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
#	lmo.outlet_name ,lmo.outlet_code , \
#	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
#	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
#	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#	lsh.status, lsh.order_date as orderDate \
#	from  \
#	lt_mast_employees lme, \
#	lt_mast_distributors lmd , \
#	lt_mast_outlets lmo ,  \
#	lt_so_headers lsh ,  \
#	lt_so_lines lsl, \
#	lt_mast_products lmpd, \
#	lt_mast_price_lists lmpl, \
#	lt_mast_users lmu \
#	where 1=1  \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmpd.product_id \
#	and lmpl.price_list  = lmo.price_list \
#	and lmpd.product_code = lmpl.product_code \
#	AND lme.distributor_id =lmd.distributor_id \
#	AND lmo.distributor_id= lme.distributor_id \
#	AND lmu.user_id = lsh.last_updated_by \
#	and lmu.employee_code = lme.employee_code \
#	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
#	order by lsh.order_number desc
	
getReportDataBySalesPersonAdminOLD = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName,  lme.employee_code, \
	LMO.OUTLET_NAME ,LMO.OUTLET_CODE , \
	lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd , \
	lt_mast_outlets_v lmo , \
	lt_so_headers lsh ,\
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND LMU.EMPLOYEE_CODE = LME.EMPLOYEE_CODE \
	AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx')) \
	AND COALESCE(LME.ORG_ID ,-99) =  COALESCE( ? ,COALESCE(LME.ORG_ID,-99)) \
	AND COALESCE(LME.DISTRIBUTOR_ID ,-99) =  COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,-99)) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id,-99)) \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
    or to_char(lsh.last_update_date, 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? ) \
	ORDER BY LSH.ORDER_NUMBER DESC
	
getReportDataBySalesPersonAdminCOPY = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd , \
	lt_mast_outlets_v lmo ,  \
	lt_so_headers lsh ,  \
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu, \
	lt_mast_emp_position_v lmep \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	and lme.distributor_id =lmd.distributor_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE(? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.order_number desc
	
#getReportDataBySalesPersonDistributor = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
#	lmo.outlet_name ,lmo.outlet_code , \
#	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
#	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
#	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#	lsh.status, lsh.order_date as orderDate \
#	from \
#	lt_mast_employees lme, \
#	lt_mast_distributors lmd, \
#	lt_mast_outlets lmo ,  \
#	lt_so_headers lsh ,  \
#	lt_so_lines lsl, \
#	lt_mast_products lmpd, \
#	lt_mast_price_lists lmpl, \
#	lt_mast_users lmu \
#	where 1=1  \
#	and lmu.status = 'ACTIVE' \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmpd.product_id \
#	and lmpl.price_list  = lmo.price_list \
#	and lmpd.product_code = lmpl.product_code \
#	AND lme.distributor_id =lmd.distributor_id  \
#	AND lmo.distributor_id= lme.distributor_id \
#	AND lmu.user_id = lsh.last_updated_by \
#	and lmu.employee_code = lme.employee_code \
#	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
#	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
#	AND ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )
	
# this is original query comment on 29-MAy-2024 	
#getReportDataBySalesPersonDistributor = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName,  \
#lme.employee_code,  LMO.OUTLET_NAME ,LMO.OUTLET_CODE ,  \
#lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress, \
#(case \
#WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.LIST_PRICE),2) \
#END )AS list_price1, \
#(case \
#WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
#END )AS ptr_price1, \
#(CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
#END )AS QUANTITY1,   \
#(case \
#WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
#END ) * (CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
#END ) \
#AS total, \
#lmd.distributor_id, lme.employee_id ,  \
#lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#lmpd.product_code ,lmpd.product_name ,lmpd.product_desc, \
#lsh.status, lsh.order_date as orderDate  \
#FROM  \
#LT_MAST_EMPLOYEES_V LME,  \
#LT_MAST_DISTRIBUTORS_V LMD,  \
#lt_mast_outlets_v lmo ,   \
#lt_so_headers lsh ,   \
#LT_SO_LINES LSL,  \
#LT_MAST_PRODUCTS_V LMPD,  \
#lt_mast_price_lists_v lmpl,  \
#lt_mast_users lmu  \
#where 1=1   \
#and lmu.status = 'ACTIVE'  \
#and lsh.header_id = lsl.header_id  \
#and lsh.outlet_id = lmo.outlet_id  \
#and lsl.product_id = lmpd.product_id  \
#and lmpl.price_list  = lmo.price_list  \
#and lmpd.product_code = lmpl.product_code  \
#AND lme.distributor_id =lmd.distributor_id   \
#AND lmo.distributor_id= lme.distributor_id  \
#AND lmu.user_id = lsh.last_updated_by  \
#AND LMU.EMPLOYEE_CODE = LME.EMPLOYEE_CODE  \
#AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx'))  \
#AND COALESCE(LME.ORG_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.ORG_ID,'xx'))  \
#AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))  \
#AND COALESCE(LME.EMPLOYEE_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))  \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))  \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?  \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) 	
	

# this is original query comment on 31-May-2024 by vaibhav for optimization 	
#getReportDataBySalesPersonDistributor = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName,  \
#lme.employee_code,  LMO.OUTLET_NAME ,LMO.OUTLET_CODE ,  \
#lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress, \
#(case \
#WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.LIST_PRICE),2) \
#END )AS list_price1, \
#(case \
#WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
#END )AS ptr_price1, \
#(CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
#END )AS QUANTITY1,   \
#(case \
#WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
#END ) * (CASE \
#	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
#	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
#END ) \
#AS total, \
#lmd.distributor_id, lme.employee_id ,  \
#lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
#lmpd.product_code ,lmpd.product_name ,lmpd.product_desc, \
#lsh.status, lsh.order_date as orderDate  \
#FROM  \
#LT_MAST_EMPLOYEES_V LME,  \
#LT_MAST_DISTRIBUTORS_V LMD,  \
#lt_mast_outlets_v lmo ,   \
#lt_so_headers lsh ,   \
#LT_SO_LINES LSL,  \
#LT_MAST_PRODUCTS_V LMPD,  \
#lt_mast_price_lists_v lmpl,  \
#lt_mast_users lmu,  \
#SIEBEL.S_USER su \
#where 1=1   \
#and lmu.status = 'ACTIVE'  \
#and lsh.header_id = lsl.header_id  \
#and lsh.outlet_id = lmo.outlet_id  \
#and lsl.product_id = lmpd.product_id  \
#and lmpl.price_list  = lmo.price_list  \
#and lmpd.product_code = lmpl.product_code  \
#AND lme.distributor_id =lmd.distributor_id   \
#AND lmo.distributor_id= lme.distributor_id  \
#AND lmu.user_id = lsh.last_updated_by  \
#AND su.LOGIN = LME.EMPLOYEE_CODE \
#AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx'))  \
#AND COALESCE(LME.ORG_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.ORG_ID,'xx'))  \
#AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID,'xx'))  \
#AND COALESCE(LME.EMPLOYEE_ID ,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))  \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))  \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?  \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) 	

	
getReportDataBySalesPersonDistributor = select lsv.*, (case \
 WHEN list_price LIKE '%*%' OR list_price LIKE '%''%' OR list_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(list_price),2) \
 END )AS list_price1, \
(case \
 WHEN ptr_price LIKE '%*%' OR ptr_price LIKE '%''%' OR ptr_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(ptr_price),2) \
 END )AS ptr_price1, \
(CASE \
	WHEN quantity LIKE '%*%' OR quantity LIKE '%''%' OR quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (quantity),2) \
END )AS quantity1, \
(case \
WHEN ptr_price LIKE '%*%' OR ptr_price LIKE '%''%' OR ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(PTR_PRICE),2) \
END ) * (CASE \
	WHEN quantity LIKE '%*%' OR quantity LIKE '%''%' OR quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (QUANTITY),2) \
END ) \
AS total \
from Lt_salesReportForAdmin_V lsv \
WHERE \
COALESCE(lsv.STATUS ,'xx') = COALESCE(? ,COALESCE(lsv.STATUS,'xx'))   \
AND COALESCE(lsv.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(lsv.DISTRIBUTOR_ID,'xx'))   \
AND COALESCE(lsv.EMPLOYEE_ID ,'xx') = COALESCE( ? ,COALESCE(lsv.EMPLOYEE_ID,'xx'))   \
AND ((lsv.LAST_UPDATE_DATE BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
or to_char(lsv.last_update_date , 'DD-MON-YY') = ?   \
OR TO_CHAR(LAST_UPDATE_DATE , 'DD-MON-YY') = ? )   
	
	
	
getReportDataBySalesPersonDistributorCOPY = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_so_headers lsh ,  \
	lt_so_lines lsl, \
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu, \
	lt_mast_emp_position_v lmep \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id  \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	and upper(lmep.status) = 'ACTIVE' \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
	
getReportDataBySalesPersonAdmin_OLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmp.position, lmp.position_code ,lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name ,lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  ,\
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_mast_positions_v lmp ,\
	lt_so_headers lsh ,  \
	lt_so_lines lsl,\
	lt_mast_products_v lmpd, \
	lt_mast_price_lists_v lmpl, \
	lt_mast_users lmu \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	and lmpl.price_list  = lmo.price_list \
	and lmpd.product_code = lmpl.product_code \
	AND lme.distributor_id =lmd.distributor_id \
	AND lme.position_id =lmp.position_id    \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND lmu.position_id  = lme.position_id \
	and lmu.employee_code = lme.employee_code \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.order_number desc
	
getReportDataBySalesPersonDistributor_OLD = select lsh.order_number, concat(lme.first_name ,' ', lme.last_name) as SalesPersonName,  lme.employee_code, \
	lmp.position, lmp.position_code ,lmo.outlet_name ,lmo.outlet_code , \
	lmo.outlet_id, concat(lmo.address_1 ,' ', lmo.address_2 ) as outletAddress, \
	lsl.list_price ,lsl.ptr_price,lmpd.product_code ,lmpd.product_name, lmpd.product_desc,lsl.quantity, lmd.distributor_id, lme.employee_id , \
	lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  ,\
	lsh.status, lsh.order_date as orderDate \
	from  \
	lt_mast_employees_v lme, \
	lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo ,  \
	lt_mast_positions_v lmp ,\
	lt_so_headers lsh ,  \
	lt_so_lines lsl,\
	lt_mast_products_v lmpd, \
	lt_mast_users lmu \
	where 1=1  \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmpd.product_id \
	AND lme.distributor_id =lmd.distributor_id \
	AND lme.position_id =lmp.position_id    \
	AND lmo.distributor_id= lme.distributor_id \
	AND lmu.user_id = lsh.last_updated_by \
	AND lmu.position_id  = lme.position_id \
	and lmu.employee_code = lme.employee_code \
	AND COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id),-99) \
	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id),-99) \
	AND COALESCE(lme.employee_id ,-99) =  COALESCE( ? ,COALESCE(lme.employee_id),-99) \
	AND ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
		
	
#sample = and lsh.last_update_date between ? and  ?   \
#	  and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
#      or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )

sample = and lsh.last_update_date BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY') \
	  AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
      OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? \
      OR TO_CHAR(LSH.LAST_UPDATE_DATE, 'DD-MON-YY') = ? )
      
#getReportDataByRegionwiseSalesAdmin = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
#	sum(lsl.list_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc \
#	from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_distributors lmd, \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1= 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
#	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code


#sum(lsl.list_price * lsl.quantity)as revenue, comment on 13-May-2024 but must need in below query
# this query once again comment on 31-May-2024 for combine two query below & count for fast result of totaleef
#getReportDataByRegionwiseSalesAdmin = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
#count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc,     \
#CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE to_number(nvl((lsl.ptr_price),'0') * nvl((lsl.quantity), 0)) \
#    END AS revenue \
#from     \
#lt_so_headers lsh,     \
#lt_so_lines lsl,     \
#lt_mast_outlets_v lmo ,     \
#lt_mast_distributors_v lmd,     \
#lt_mast_products_v lmp,     \
#lt_mast_users lmu     \
#where 1= 1     \
#and lsh.header_id = lsl.header_id     \
#and lsh.outlet_id = lmo.outlet_id     \
#and lmo.distributor_id = lmd.distributor_id     \
#and lsl.product_id = lmp.product_id     \
#and lmu.user_id = lsh.last_updated_by     \
#and lmu.status = 'ACTIVE'     \
#AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
#and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
#or to_char(lsh.last_update_date , 'DD-MON-YY') = ?    \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )     \
#group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, lsl.ptr_price, lsl.quantity


getReportDataByRegionwiseSalesAdmin = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc,     \
CASE \
        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE to_number(nvl((lsl.ptr_price),'0') * nvl((lsl.quantity), 0)) \
    END AS revenue,(select count(distinct lmu.USER_ID) AS count \
	from \
	lt_mast_users lmu  \
	where 1=1 \
	and lmu.user_type = 'SALES' \
	and lmu.status = 'ACTIVE' \
	and lmu.distributor_id = ? \
	AND EXISTS (SELECT 1 FROM lt_so_headers lsh WHERE lsh.LAST_UPDATED_BY = lmu.user_id \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )) \
    )AS total_Eff \
from     \
lt_so_headers lsh,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_distributors_v lmd,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1= 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lmo.distributor_id = lmd.distributor_id     \
and lsl.product_id = lmp.product_id     \
and lmu.user_id = lsh.last_updated_by    \
and lmu.status = 'ACTIVE'    \
AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(? ,'DD-MON-YY'))  \
or to_char(lsh.last_update_date , 'DD-MON-YY') = ?    \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )     \
group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , \
lmd.distributor_crm_code, lsl.ptr_price, lsl.quantity


#AND LSH.STATUS = 'PROCESSED'   \


#getReportDataByRegionwiseSales = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
#	sum(lsl.list_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as revenue,count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc \
#	from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_distributors lmd, \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1= 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
#	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) 
  

#sum(lsl.list_price * lsl.quantity)as revenue   comment temparary on 13-May-2024 but must need in below query
# this query once again cooment on 31-May-24 for combine two query count & below for fast result of totaleef
#getReportDataByRegionwiseSales = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
#count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc,     \
#CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE to_number(nvl((lsl.ptr_price),'0') * nvl((lsl.quantity), 0)) \
#    END AS revenue \
#from     \
#lt_so_headers lsh,     \
#lt_so_lines lsl,     \
#lt_mast_outlets_v lmo ,     \
#lt_mast_distributors_v lmd,     \
#lt_mast_products_v lmp,     \
#lt_mast_users lmu     \
#where 1= 1     \
#and lsh.header_id = lsl.header_id     \
#and lsh.outlet_id = lmo.outlet_id     \
#and lmo.distributor_id = lmd.distributor_id     \
#and lsl.product_id = lmp.product_id     \
#and lmu.user_id = lsh.last_updated_by     \
#and lmu.status = 'ACTIVE'     \
#AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
#and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?    \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \


getReportDataByRegionwiseSales = select lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code,     \
count(lsl.line_id) as tls,count(distinct lsh.header_id) as dbc,     \
CASE \
        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE to_number(nvl((lsl.ptr_price),'0') * nvl((lsl.quantity), 0)) \
    END AS revenue, \
    (select count(distinct lmu.USER_ID) AS count \
	from \
	lt_mast_users lmu  \
	where 1=1  \
	and lmu.user_type = 'SALES' \
	and lmu.status = 'ACTIVE' \
	and lmu.distributor_id = ? \
	AND EXISTS (SELECT 1 FROM lt_so_headers lsh WHERE lsh.LAST_UPDATED_BY = lmu.user_id \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(? ,'DD-MON-YY') AND TO_DATE(? ,'DD-MON-YY')) \
    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )) \
    )AS total_Eff \
from     \
lt_so_headers lsh,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_distributors_v lmd,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1= 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lmo.distributor_id = lmd.distributor_id     \
and lsl.product_id = lmp.product_id     \
and lmu.user_id = lsh.last_updated_by     \
and lmu.status = 'ACTIVE'     \
AND COALESCE(LMO.REGION ,'xx') = COALESCE( ? ,COALESCE(LMO.REGION,'xx'))     \
and COALESCE(lmo.distributor_id ,'xx') = COALESCE( ? ,COALESCE(lmo.distributor_id,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?    \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  


#AND LSH.STATUS = 'PROCESSED'     \
#group by lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code

      
getReportDataByRegionwiseSalesCOPY = select lsh.header_id,lsl.line_id, lmo.region,lmd.distributor_id, lmd.distributor_name, lmd.distributor_code , lmd.distributor_crm_code, \
	lsl.list_price , lsl.ptr_price, lsl.quantity,lsl.header_id, lsl.line_id  \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl,\
	lt_mast_outlets_v lmo , \
	lt_mast_distributors_v lmd, \
	lt_mast_products_v lmp, \
	lt_mast_users lmu \
	where 1= 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lmo.distributor_id = lmd.distributor_id \
	and lsl.product_id = lmp.product_id \
	and lmu.user_id = lsh.last_updated_by \
	and lsh.status = 'PROCESSED' \
	and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region),'xx') \
	and COALESCE(lmo.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id),-99) \
	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )
	

      
getReportDataByProductAdminCOPY = select distinct(lmp.product_id), lmp.product_name, lmp.product_code, lsl.ptr_price, \
	lsl.list_price , lsl.quantity ,lsl.header_id, lsl.line_id \
	from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp , \
	lt_mast_users lmu , \
	lt_mast_emp_position_v lmep2 , \
	lt_mast_employees_v lme2 \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme2.employee_code \
	and lme2.employee_id = lmep2.employee_id \
	and lmu.position_id = lmep2.position_id \
	AND UPPER(lsh.status) = 'PROCESSED' \
	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	and COALESCE(lmp.product_id  ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
	and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )
	
#getReportDataByProductAdmin =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity, \
#	sum(lsl.ptr_price ::NUMERIC(25,2) * lsl.quantity::NUMERIC(25,2))as amount \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl , \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and lsh.status = 'PROCESSED' \
#	and COALESCE(lmp.product_id  ,-99) =  COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
#	AND ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price 


#sum(lsl.ptr_price * lsl.quantity)as amount   this line is temprary comment from below query but must be used in below query   \
getReportDataByProductAdmin =  SELECT lmp.product_id,lmp.product_name, lmp.product_code, sum(nvl(lsl.quantity,0)), \
sum((CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%'  THEN 0 \
	ELSE ROUND(TO_NUMBER (NVL(LSL.QUANTITY,0)),2) \
END  ))AS QUANTITY1 , \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(NVL(LSL.ptr_price,0)),2) \
END )AS ptr_price1, \
sum(CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%'  THEN 0 \
	ELSE ROUND(TO_NUMBER (NVL(LSL.QUANTITY,0)),2) \
END  ) * \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(NVL(LSL.ptr_price,0)),2) \
END )AS amount \
from  \
lt_so_headers lsh ,  \
LT_SO_LINES LSL ,  \
lt_mast_products_V lmp,  \
lt_mast_users lmu  \
where 1 = 1  \
and lsh.header_id = lsl.header_id  \
and lsl.product_id = lmp.product_id  \
and lmu.user_id = lsh.last_updated_by  \
and lmu.status = 'ACTIVE'  \
AND COALESCE(LMP.PRODUCT_ID  ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID ,'xx'))  \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
or to_char(lsh.last_update_date ,'DD-MON-YY') = ?  \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \
GROUP BY LMP.PRODUCT_ID,LMP.PRODUCT_NAME, LMP.PRODUCT_CODE, LSL.PTR_PRICE, LSL.PTR_PRICE, lsl.quantity
#AND LSH.STATUS = 'PROCESSED'  \


#getReportDataByProductDistributor =  select lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price,sum(lsl.quantity) as quantity, \
#	sum(lsl.ptr_price ::NUMERIC(25,2) * lsl.quantity::NUMERIC(25,2))as amount \
#	from \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_products lmp, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND lsh.status = 'PROCESSED' \
#	and COALESCE(lmo.org_id ,-99) = COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	and COALESCE(lmp.product_id ,-99) = COALESCE( ? ,COALESCE(lmp.product_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )

#sum(lsl.ptr_price * lsl.quantity)as amount   this line is temprary comment from below query but must be used in below query   \
getReportDataByProductDistributor =  SELECT lmp.product_id,lmp.product_name, lmp.product_code, sum(nvl(lsl.quantity,0)), \
sum((CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%'  THEN 0 \
	ELSE ROUND(TO_NUMBER (NVL(LSL.QUANTITY,0)),2) \
END  ))AS QUANTITY1 , \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(NVL(LSL.ptr_price,0)),2) \
END )AS ptr_price1, \
sum(CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%'  THEN 0 \
	ELSE ROUND(TO_NUMBER (NVL(LSL.QUANTITY,0)),2) \
END  ) * \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(NVL(LSL.ptr_price,0)),2) \
END )AS amount \
from \
lt_so_headers lsh ,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_products_v lmp,     \
lt_mast_users lmu     \
where 1 = 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lsl.product_id = lmp.product_id    \
and lmu.user_id = lsh.last_updated_by   \
and lmu.status = 'ACTIVE'     \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ?,COALESCE(LMO.ORG_ID,'xx'))     \
and COALESCE(lmp.product_id ,'xx') = COALESCE( ? ,COALESCE(lmp.product_id ,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ?     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? )  \

#AND LSH.STATUS = 'PROCESSED'     \

#group by lmp.product_id,lmp.product_name, lmp.product_code, lsl.ptr_price

	
#getReportDataByOutletAdmin = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
#	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,  lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc  from  \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets lmo , \
#	lt_mast_products lmp, \
#	lt_mast_distributors lmd , \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmd.distributor_id = lmo.distributor_id \
#	and lmp.category_id = lmpc.category_id  \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	and COALESCE(lsh.outlet_id  ,-99) =  COALESCE( ? ,COALESCE(lsh.outlet_id ),-99) \
#	and COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	order by lsh.last_update_date at time zone 'IST' desc

#original query comment on 20-May-24
#getReportDataByOutletAdmin = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status,     \
#lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,   \
#LSL.QUANTITY,LSL.HEADER_ID, LSL.LINE_ID , LMD.DISTRIBUTOR_NAME, LMD.DISTRIBUTOR_CRM_CODE, LMPC.CATEGORY_CODE , LMPC.CATEGORY_DESC   \
#from   \
#lt_so_headers lsh ,   \
#lt_so_lines lsl,   \
#lt_mast_outlets_v lmo ,   \
#lt_mast_products_v lmp,   \
#lt_mast_distributors_v lmd ,   \
#lt_mast_prod_categories lmpc,   \
#lt_mast_users lmu   \
#where 1 = 1   \
#and lsh.header_id = lsl.header_id   \
#and lsh.outlet_id = lmo.outlet_id   \
#and lsl.product_id = lmp.product_id   \
#and lmd.distributor_id = lmo.distributor_id   \
#and lmp.category_id = lmpc.category_id   \
#and lmu.user_id = lsh.last_updated_by   \
#AND LMU.STATUS = 'ACTIVE'   \
#AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.ORG_ID,'xx'))   \
#AND COALESCE(LSH.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,'xx'))   \
#AND COALESCE(LMO.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,'xx'))   \
#and COALESCE(lsh.status ,'xx') = COALESCE( ? ,COALESCE(lsh.status,'xx'))   \
#AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))   \
#or to_char(lsh.last_update_date ,'DD-MON-YY') = ?   \
#OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) \
#ORDER BY LSH.LAST_UPDATE_DATE DESC 
	
	
getReportDataByOutletAdmin = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status,     \
lsh.order_date as creation_date, \
(case \
 WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(lsl.ptr_price),2) \
 END )AS ptr_price, \
( case \
WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER (lsl.list_price),2) \
END )AS list_price, \
(CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (lsl.quantity),2) \
END )AS quantity, \
LSL.HEADER_ID, LSL.LINE_ID , LMD.DISTRIBUTOR_NAME, LMD.DISTRIBUTOR_CRM_CODE, LMPC.CATEGORY_CODE , LMPC.CATEGORY_DESC   \
from   \
lt_so_headers lsh , \
lt_so_lines lsl,   \
lt_mast_outlets_v lmo ,   \
lt_mast_products_v lmp,   \
lt_mast_distributors_v lmd ,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1 = 1   \
and lsh.header_id = lsl.header_id   \
and lsh.outlet_id = lmo.outlet_id   \
and lsl.product_id = lmp.product_id   \
and lmd.distributor_id = lmo.distributor_id   \
and lmp.category_id = lmpc.category_id   \
and lmu.user_id = lsh.last_updated_by   \
AND LMU.STATUS = 'ACTIVE'   \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.ORG_ID,'xx'))   \
AND COALESCE(LSH.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,'xx'))   \
AND COALESCE(LMO.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,'xx'))   \
and COALESCE(lsh.status ,'xx') = COALESCE( ? ,COALESCE(lsh.status,'xx'))   \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))   \
or to_char(lsh.last_update_date ,'DD-MON-YY') = ?   \
OR TO_CHAR(LSH.LAST_UPDATE_DATE ,'DD-MON-YY') = ? ) \
ORDER BY LSH.LAST_UPDATE_DATE DESC 

	
	
getReportDataByOutletAdminCOPY = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price,  lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp, \
	lt_mast_distributors_v lmd , \
	lt_mast_prod_categories lmpc, \
	lt_mast_users lmu, \
	lt_mast_employees_v lme, \
	lt_mast_emp_position_v lmep \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id \
	and lmd.distributor_id = lmo.distributor_id \
	and lmp.category_id = lmpc.category_id  \
	and lmu.user_id = lsh.last_updated_by \
	and lmu.employee_code = lme.employee_code \
	and lme.employee_id = lmep.employee_id \
	and lmu.position_id = lmep.position_id \
	and COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	and COALESCE(lsh.outlet_id  ,-99) =  COALESCE( ? ,COALESCE(lsh.outlet_id ),-99) \
	and COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status),'xx') \
	and ((lsh.last_update_date between ? and  ? ) or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? ) \
	order by lsh.last_update_date desc
 
	
getReportDataByOutletDistributor = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status,     \
lsh.order_date as creation_date, \
(case \
 WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
 ELSE ROUND(TO_NUMBER(lsl.ptr_price),2) \
 END )AS ptr_price, \
( case \
WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER (lsl.list_price),2) \
END )AS list_price, \
(CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (lsl.quantity),2) \
END )AS quantity, \
lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc from     \
lt_so_headers lsh ,     \
lt_so_lines lsl,     \
lt_mast_outlets_v lmo ,     \
lt_mast_products_v lmp,     \
lt_mast_distributors_v lmd,     \
lt_mast_prod_categories lmpc,     \
lt_mast_users lmu     \
where 1 = 1     \
and lsh.header_id = lsl.header_id     \
and lsh.outlet_id = lmo.outlet_id     \
and lsl.product_id = lmp.product_id     \
and lmd.distributor_id = lmo.distributor_id     \
and lmp.category_id = lmpc.category_id     \
and lmu.user_id = lsh.last_updated_by     \
AND LMU.STATUS = 'ACTIVE'     \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE(? ,COALESCE(LMO.ORG_ID,'xx'))     \
AND COALESCE(LSH.OUTLET_ID ,'xx') = COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,'xx'))     \
AND COALESCE(LMO.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,'xx'))     \
and COALESCE(lsh.status ,'xx') = COALESCE( ? ,COALESCE(lsh.status,'xx'))     \
AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY'))     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ?     \
OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? ) 

	
#getReportDataByOutletDistributor = select lmo.outlet_id, lmo.outlet_name , lmo.outlet_code, lsh.order_number, lsh.status, \
#	lsh.order_date as creation_date, lsl.ptr_price, lsl.list_price , lsl.quantity,lsl.header_id, lsl.line_id , lmd.distributor_name, lmd.distributor_crm_code, lmpc.category_code , lmpc.category_desc  from  \
#	lt_so_headers lsh , \
#	lt_so_lines lsl, \
#	lt_mast_outlets_v lmo , \
#	lt_mast_products_v lmp, \
#	lt_mast_distributors_v lmd, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lsl.product_id = lmp.product_id \
#	and lmd.distributor_id = lmo.distributor_id \
#	and lmp.category_id = lmpc.category_id \
#	and lmu.user_id = lsh.last_updated_by \
#	AND LMU.STATUS = 'ACTIVE' \
#	AND COALESCE(LMO.ORG_ID ,-99) =  COALESCE( ? ,COALESCE(LMO.ORG_ID,-99)) \
#	AND COALESCE(LSH.OUTLET_ID  ,-99) =  COALESCE( ? ,COALESCE(LSH.OUTLET_ID ,-99)) \
#	AND COALESCE(LMO.DISTRIBUTOR_ID  ,-99) =  COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID ,-99)) \
#	and COALESCE(lsh.status ,'xx') =  COALESCE( ? ,COALESCE(lsh.status,'xx')) \
#	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
#    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
#	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )

getDistributorIdByUserId = select lmu.distributor_id from lt_mast_users lmu where lmu.user_id = ?

#Filter

#getSearchDistributorForRegion = select a.* from ( select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code \
#	from lt_mast_distributors lmd, \
#	lt_mast_outlets lmo \
#	where 1=1 \
#	and lmd.distributor_id = lmo.distributor_id \
#	and upper(lmd.status) = 'ACTIVE' \
#	and lmd.org_id = ? \
#	AND COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region), 'xx') \
#	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) \
#	order by distributor_id asc ) a limit ? offset ?

getSearchDistributorForRegion = SELECT A.* FROM ( SELECT DISTINCT(LMD.DISTRIBUTOR_ID), LMD.DISTRIBUTOR_ID AD, LMD.DISTRIBUTOR_CODE \
  , lmd.distributor_name, lmd.distributor_crm_code \
	from lt_mast_distributors_v lmd, \
	lt_mast_outlets_v lmo \
	where 1=1 \
	and lmd.distributor_id = lmo.distributor_id \
	and upper(lmd.status) = 'ACTIVE' \
	AND LMD.ORG_ID = ? \
	AND COALESCE(LMO.REGION ,'xx') =  COALESCE( ? ,COALESCE(LMO.REGION, 'xx')) \
	AND COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CRM_CODE),'xx') LIKE COALESCE( ? ,COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CRM_CODE),'xx')) \
	ORDER BY DISTRIBUTOR_ID ASC ) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE RNUM BETWEEN ? AND ?
	
#getSearchDistributor= 	select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name , lmd.region \
#	from lt_mast_distributors lmd \
#	where 1=1  \
#	and lmd.org_id = ? \
#	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx') \
#	like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx'))

getSearchDistributor= 	select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name , lmd.region \
	from lt_mast_distributors_v lmd \
	where 1=1  \
	and lmd.org_id = ? \
	AND COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_code),'xx') \
	LIKE COALESCE( ? ,COALESCE(CONCAT(LMD.DISTRIBUTOR_NAME , LMD.DISTRIBUTOR_CODE),'xx'))

#getSearchSalesPerson= select a.* from ( select lme.employee_id, lme.first_name, lme.last_name, lme.employee_code \
#	from lt_mast_employees lme where 1 =1 \
#	and UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN' \
#	and UPPER(lme.status) = 'ACTIVE' \
#	AND COALESCE(lme.org_id ,-99) =  COALESCE( ? ,COALESCE(lme.org_id ),-99) \
#	AND COALESCE(lme.distributor_id ,-99) =  COALESCE( ? ,COALESCE(lme.distributor_id ),-99) \
#	AND COALESCE(upper(CONCAT(lme.first_name, lme.last_name, lme.employee_code)),'xx') \
#	like COALESCE( ? ,COALESCE(upper(CONCAT(lme.first_name, lme.last_name, lme.employee_code)),'xx')) ) a limit ? offset ?

getSearchSalesPerson= SELECT A.* FROM ( SELECT LME.EMPLOYEE_ID, LME.FIRST_NAME, LME.LAST_NAME, LME.EMPLOYEE_CODE       \
,ROWNUM RNUM       \
from lt_mast_employees_v lme where 1 =1       \
and UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN'       \
AND UPPER(LME.STATUS) = 'ACTIVE'       \
AND COALESCE(LME.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LME.ORG_ID ,'xx'))       \
AND COALESCE(LME.DISTRIBUTOR_ID ,'xx') = COALESCE( ? ,COALESCE(LME.DISTRIBUTOR_ID ,'xx'))       \
AND COALESCE(UPPER(LME.FIRST_NAME || LME.LAST_NAME || LME.EMPLOYEE_CODE),'xx')       \
LIKE COALESCE( ? ,COALESCE(UPPER(LME.FIRST_NAME || LME.LAST_NAME || LME.EMPLOYEE_CODE),'xx')) )       \
A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE RNUM BETWEEN ? AND ?


#getRegion=select distinct (region )from lt_mast_outlets lmo \
#	where 1=1 \
#	and lmo.region <> '' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id ),-99)

getRegion=sselect distinct (region )from lt_mast_outlets_v lmo      \
where 1=1      \
AND LMO.REGION <> ?      \
AND COALESCE(LMO.ORG_ID ,'xx') = COALESCE( ? ,COALESCE(LMO.ORG_ID ,'xx'))

#getSearchProduct= select a.* from ( select product_id, product_code, product_name from lt_mast_products lmp \
#	where 1 = 1 \
#	AND COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) \
#	AND COALESCE(upper(CONCAT(lmp.product_code, lmp.product_name)),'xx') \
#	like COALESCE( ? ,COALESCE(upper(CONCAT(lmp.product_code, lmp.product_name)),'xx')) ) a limit ? offset ?

getSearchProduct= SELECT A.* FROM ( SELECT PRODUCT_ID, PRODUCT_CODE, PRODUCT_NAME ,ROWNUM RNUM       \
from lt_mast_products_v lmp       \
WHERE 1 = 1       \
AND COALESCE(ORG_ID ,'xx') = COALESCE( ? ,COALESCE(ORG_ID ,'xx'))       \
AND COALESCE(UPPER(LMP.PRODUCT_CODE || LMP.PRODUCT_NAME),'xx')       \
LIKE COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_CODE || LMP.PRODUCT_NAME),'xx')) ) A       \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE RNUM BETWEEN ? AND ?
		 
#getSearchOutlets = select outlet_id, outlet_code, outlet_name from lt_mast_outlets lmo \
#	where 1=1 \
#	AND UPPER(lmo.status) = 'ACTIVE' \
#	AND COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) \
#	AND COALESCE(distributor_id ,-99) =  COALESCE( ? ,COALESCE(distributor_id ),-99) \
#	AND COALESCE(upper(CONCAT(outlet_code , outlet_name )),'xx') like  \
#	COALESCE( ? ,COALESCE(upper(CONCAT(outlet_code , outlet_name )),'xx'))

getSearchOutlets = select outlet_id, outlet_code, outlet_name from lt_mast_outlets_v lmo       \
where 1=1       \
AND UPPER(lmo.status) = 'ACTIVE'       \
AND COALESCE(org_id ,'xx') = COALESCE( ? ,COALESCE(org_id ,'xx'))       \
AND COALESCE(distributor_id ,'xx') = COALESCE( ? ,COALESCE(distributor_id ,'xx'))       \
AND COALESCE(UPPER(OUTLET_CODE || OUTLET_NAME ),'xx') LIKE       \
COALESCE( ? ,COALESCE(UPPER(OUTLET_CODE || OUTLET_NAME ),'xx'))  
	
#getOutletStatusOLD=select distinct(status) from lt_mast_outlets lmo \
#	where  COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99)

getOutletStatusOLD= SELECT DISTINCT(STATUS) FROM LT_MAST_OUTLETS_v LMO \
	WHERE  COALESCE(ORG_ID ,-99) =  COALESCE( ? ,COALESCE(ORG_ID ,-99))
	
#getOutletStatus = select distinct(status) from lt_so_headers lmo where 1=1 and upper(lmo.status) <> 'DELIVERED'

getOutletStatus = select distinct(status) from lt_so_headers lmo where 1=1 and upper(lmo.status) <> 'DELIVERED'


#getCategoryDetails= select category_id,category_code,category_name ,category_desc \
#	from lt_mast_prod_categories lmpc \
#	where COALESCE(org_id ,-99) =  COALESCE( ? ,COALESCE(org_id ),-99) 

getCategoryDetails= select category_id,category_code,category_name ,category_desc \
	FROM LT_MAST_PROD_CATEGORIES LMPC \
	where COALESCE(org_id ,'-99') =  COALESCE( ? ,COALESCE(org_id ,'-99'))
	
#getAllTestProduct =  SELECT a.* FROM ( \
#	select * from lt_mast_test_product lmtp \
#	) a limit ? OFFSET ?

getAllTestProduct = SELECT a.* FROM ( \
	SELECT * FROM LT_MAST_TEST_PRODUCT LMTP \
	) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE ROWNUM BETWEEN ? AND ?

#checkOrderedIsProcessed = select count(*) from lt_so_headers lsh \
#	where 1=1 \
#	and UPPER(lsh.status) = 'PROCESSED' \ 

checkOrderedIsProcessed = select count(*) from lt_so_headers lsh \
	where 1=1 \
	AND UPPER(LSH.STATUS) = 'PROCESSED'
	
###get sales person count by distributor id

#getSalesPersonCountOLDD_25_Nov = select count(*) from lt_mast_users lmu \
#	where 1=1 \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ?

getSalesPersonCountOLDD_25_Nov = select count(*) from lt_mast_users lmu \
	where 1=1 \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ?
	
#getSalesPersonCountCOPY = select count(*) from lt_mast_users lmu \
#	where 1=1 \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? \
#	group by lmu.user_id

getSalesPersonCountCOPY = select count(*) from lt_mast_users lmu \
	where 1=1 \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? \
	GROUP BY LMU.USER_ID
	
#getSalesPersonCount = select count(distinct lmu.*) \
#	from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and lmu.user_type = 'SALES' \
#	and lmu.status = 'ACTIVE' \
#	and lmu.distributor_id = ? \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? )

getSalesPersonCount = select count(distinct lmu.USER_ID) AS count \
	from \
	lt_mast_users lmu, \
	lt_so_headers lsh \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and lmu.user_type = 'SALES' \
	and lmu.status = 'ACTIVE' \
	and lmu.distributor_id = ? \
	AND ((LSH.LAST_UPDATE_DATE BETWEEN TO_DATE(?,'DD-MON-YY') AND TO_DATE(?,'DD-MON-YY')) \
    OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? \
	OR TO_CHAR(LSH.LAST_UPDATE_DATE , 'DD-MON-YY') = ? )

###get total number of order count by distributor id
#getOrderCountOld = select count(*) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountOld = select count(*) \
 from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? )

#getOrderCountCOPY = select count(*) from lt_so_headers lsh \
#where lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
#where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? ) 

getOrderCountCOPY = select count(*) from lt_so_headers lsh \
where lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') <= ? \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') >= ?  \
and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? ) 


#getOrderCount = select count(*) \
#from lt_so_headers lsh, \
#lt_mast_distributors lmd,\
#lt_mast_outlets lmo, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lmo.distributor_id = lmd.distributor_id \
#and lsh.outlet_id = lmo.outlet_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lmd.distributor_id = ? 

getOrderCount = select count(*) \
from lt_so_headers lsh, \
lt_mast_distributors_v lmd, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lmo.distributor_id = lmd.distributor_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') <= ? \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') >= ? \
and lmd.distributor_id = ?

###get total number of order line count by distributor id

#getOrderLineCountOld =	select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountOld = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where lsh.status = 'PROCESSED' and lsh.created_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))
		
#getOrderLineCountCOPY = select count(*) from lt_so_lines lsl \
#where 1=1 and lsl.header_id in ( select lsh.header_id from lt_so_headers lsh \
#where lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
#where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? )) 

getOrderLineCountCOPY = select count(*) from lt_so_lines lsl \
where 1=1 and lsl.header_id in ( select lsh.header_id from lt_so_headers lsh \
where lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') <= ? \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') >= ? \
and lsh.outlet_id in ( select lmo.outlet_id from lt_mast_outlets_v lmo ,lt_mast_distributors_v lmd \
where 1=1 and lmo.distributor_id = lmd.distributor_id and lmd.distributor_id = ? )) 


#getOrderLineCount = select count(*) \
#from \
#lt_so_lines lsl, \
#lt_so_headers lsh, \
#lt_mast_distributors lmd, \
#lt_mast_outlets lmo, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lmo.distributor_id = lmd.distributor_id \
#and lsh.outlet_id = lmo.outlet_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsh.status = 'PROCESSED' \
#and lsh.last_update_date at time zone 'IST' <= ?::date and lsh.last_update_date at time zone 'IST' >= ?::date \
#and lmd.distributor_id = ?
	
getOrderLineCount = select count(*) \
from \
lt_so_lines lsl, \
lt_so_headers lsh, \
lt_mast_distributors_v lmd, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu, \
lt_mast_employees_v lme, \
lt_mast_emp_position_v lmep \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmo.distributor_id = lmd.distributor_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu.position_id = lmep.position_id \
and lsh.status = 'PROCESSED' \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') <= ? \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') >= ? \
and lmd.distributor_id = ?	
	
### DASHBOARD get total number of order count by distributor id
#getOrderCountDashboard = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountDashboard = select count(*) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ? \
	and lsh.last_updated_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id = ? )
	
#getOrderCountSales =  select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by = ?

getOrderCountSales = select count(*) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ?       \
and lsh.last_updated_by = ? 

#getOrderCountDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' )

getOrderCountDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1       \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')       \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ?       \
and lsh.last_updated_by in       \
(select lmu.user_id from lt_mast_users lmu       \
where 1=1       \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )       \
and upper(lmu.status) = 'ACTIVE' )  
	
#getOrderCountDashboardSO = select count(*) \
#	from lt_so_headers lsh \
#	where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in \
#    			(select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme \
# 					,lt_mast_users lmu, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu.user_id = ?) \
#   	    and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))
 
getOrderCountDashboardSO = select count(*) \
	from lt_so_headers lsh \
	where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu where distributor_id in \
    			(select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
 					,lt_mast_users lmu, lt_mast_positions_v lmp2 \
   				where lme.employee_id = lmp.employee_id \
       			and lmu.position_id = lmp2.position_id \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu.user_id = ?) \
   	    and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) 
   	    
#getOrderCountDashboardAH = select count(*) from lt_so_headers lsh \
#where 1=1 and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#and lsh.last_updated_by in ( \
#	select lmu.user_id \
#  	from lt_mast_users lmu \
#  	where 1=1 \
#  	and lmu.distributor_id in ( \
#  		select lme.distributor_id \
#   		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			lt_mast_users lmu1, lt_mast_positions lmp2 \
#   		where lme.employee_id = lmp.employee_id \
#       	and lmu1.position_id = lmp2.position_id \
#   	   	and lmp.parent_position = lmp2.position \
#   	   	and lmu1.user_id in( \
#   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')) \
#  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))

getOrderCountDashboardAH = select count(*) from lt_so_headers lsh \
where 1=1 and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ? \
and lsh.last_updated_by in ( \
	select lmu.user_id \
  	from lt_mast_users lmu \
  	where 1=1 \
  	and lmu.distributor_id in ( \
  		select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2."position" \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER')) \
  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))
	
### DASHBOARD get total number of order line count by distributor id

#getOrderLineCountDashboard = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountDashboard = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))
		
#getOrderLineCountDashboardSales = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by = ? )

getOrderLineCountDashboardSales = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ?      \
and lsh.last_updated_by = ? ) 
		
#getOrderLineCountDashboardAdmin = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' ))

getOrderLineCountDashboardAdmin = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ?     \
and lsh.last_updated_by in      \
(select lmu.user_id from lt_mast_users lmu      \
where 1=1      \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )      \
and upper(lmu.status) = 'ACTIVE' ))

		
#getOrderLineCountDashboardSO = select count(*) from lt_so_lines lsl \
#where 1=1 \
#and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in(	\
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   				 lt_mast_users lmu, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu.user_id = ? ) \
#   	   	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )))

getOrderLineCountDashboardSO = select count(*) from lt_so_lines lsl      \
where 1=1      \
and lsl.header_id in (      \
select distinct(lsh.header_id) from lt_so_headers lsh where 1=1      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ?     \
and lsh.last_updated_by in (      \
select lmu.user_id      \
from lt_mast_users lmu where distributor_id in(	     \
select lme.distributor_id      \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,      \
lt_mast_users lmu, lt_mast_positions_v lmp2      \
where lme.employee_id = lmp.employee_id      \
and lmu.position_id = lmp2.position_id      \
and lmp.parent_position = lmp2."position"    \
and lmu.user_id = ?) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ))) 

#getOrderLineCountDashboardAH = select count(*) from lt_so_lines lsl \
#where 1=1 \
#and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and to_char(lsh.last_update_date, 'yyyy-MM-dd') = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu \
#  		where 1=1 \
#  		and lmu.distributor_id in ( \
#  			select lme.distributor_id \
#   		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			 lt_mast_users lmu1, lt_mast_positions lmp2 \
#   		where lme.employee_id = lmp.employee_id \
#       	and lmu1.position_id = lmp2.position_id \
#   	   	and lmp.parent_position = lmp2.position \
#   	   	and lmu1.user_id in( \
#   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')) \
#  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#))
		
getOrderLineCountDashboardAH = select count(*) from lt_so_lines lsl \
where 1=1 \
and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and to_char(lsh.last_update_date, 'YYYY-MM-DD') = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu \
  		where 1=1 \
  		and lmu.distributor_id in ( \
  			select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			 lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2."position" \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position" \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER')) \
  and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
))		
		
#getOrderCountDashboardCategory = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from \
#	(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsl.header_id = lsh.header_id  \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.last_updated_by = lmu.user_id \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmu.status = 'ACTIVE'

getOrderCountDashboardCategory = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from   \
(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsl.header_id = lsh.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lsh.last_updated_by = lmu.user_id   \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')   \
and lsh.last_update_date >= trunc(SYSDATE ,'month')   \
AND LMU.STATUS = 'ACTIVE' 
			
getOrderCountDashboardCategoryCOPY = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in (select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ) group by lsh.header_id
		
#getOrderCountDashboardCategoryAdmin = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from \
#	(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc, \
#	lt_mast_users lmu \
#	where 1=1 \
#	and lsl.header_id = lsh.header_id  \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.last_updated_by = lmu.user_id \
#	and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#	and lsh.last_update_date at time zone 'IST' >=  date_trunc('month', CURRENT_DATE) \
#	and lmu.status = 'ACTIVE' \
#	group by lmpc.category_id,lsh.header_id) abc \
#	group by abc.category_name,abc.category_id 
	
getOrderCountDashboardCategoryAdmin = select count(abc.ci) as dbc ,abc.category_name,abc.category_id from   \
(select lsh.header_id,lmpc.category_id as ci,lmpc.category_name,lmpc.category_id from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsl.header_id = lsh.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id   \
and lsh.last_updated_by = lmu.user_id   \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')   \
and lsh.last_update_date >= trunc(SYSDATE, 'month')   \
AND LMU.STATUS = 'ACTIVE'   \
group by lmpc.category_id,lsh.header_id,lmpc.category_name) abc   \
group by abc.category_name,abc.category_id 
		
getOrderCountDashboardCategoryAdminCOPY = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in (select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		) group by lsh.header_id
		
		
#getOrderCountDashboardCategorySO = select lsh.header_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	and lmpc.category_id = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu where distributor_id in( \
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu.user_id = ? ) \
#   	 and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR')) \
#   	 group by lsh.header_id

getOrderCountDashboardCategorySO = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl, \
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  add_months(SYSDATE, -1) \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu where distributor_id in( \
  			select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu, lt_mast_positions_v lmp2 \
   			where lme.employee_id = lmp.employee_id \
       		and lmu.position_id = lmp2.position_id \
   	   		and lmp.parent_position = lmp2."position" \
   	   		and lmu.user_id = ? ) \
   	 and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR')) \
   	 group by lsh.header_id
		
#getOrderCountDashboardCategoryAH = select lsh.header_id from \
#	lt_so_headers lsh, \
#	lt_so_lines lsl, \
#	lt_mast_products lmp, \
#	lt_mast_prod_categories lmpc \
#	where 1=1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '1 months' \
#	and lmpc.category_id = ? \
#	and lsh.last_updated_by in ( \
#		select lmu.user_id \
#  		from lt_mast_users lmu \
#  		where 1=1 \
#  		and lmu.distributor_id in ( \
#  			select lme.distributor_id \
#   			from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   			 	 lt_mast_users lmu1, lt_mast_positions lmp2 \
#   			where lme.employee_id = lmp.employee_id \
#       		and lmu1.position_id = lmp2.position_id \
#   	   		and lmp.parent_position = lmp2.position \
#   	   		and lmu1.user_id in( \
#   	   			select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#				select lmep.position_id \
#				from lt_mast_emp_position lmep \
#				where lmep.parent_position in ( \
#  					select lmp."position" \
#  					from lt_mast_positions lmp \
#  					where lmp.position_id = ? )) \
#  		and lmu2.user_type='SALESOFFICER')) \
#  		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) \
# group by lsh.header_id

getOrderCountDashboardCategoryAH = select lsh.header_id from \
	lt_so_headers lsh, \
	lt_so_lines lsl,\
	lt_mast_products_v lmp, \
	lt_mast_prod_categories lmpc \
	where 1=1 \
	and lsh.header_id = lsl.header_id \
	and lsl.product_id = lmp.product_id \
	and lmp.category_id = lmpc.category_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  add_months(SYSDATE, -1) \
	and lmpc.category_id = ? \
	and lsh.last_updated_by in ( \
		select lmu.user_id \
  		from lt_mast_users lmu \
  		where 1=1 \
  		and lmu.distributor_id in ( \
  			select lme.distributor_id \
   			from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   			 	 lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   			where lme.employee_id = lmp.employee_id  \
       		and lmu1.position_id = lmp2.position_id  \
   	   		and lmp.parent_position = lmp2."position" \
   	   		and lmu1.user_id in(  \
   	   			select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
				select lmep.position_id \
				from lt_mast_emp_position_v lmep \
				where lmep.parent_position in ( \
  					select lmp."position"  \
  					from lt_mast_positions_v lmp \
  					where lmp.position_id = ? )) \
  		and lmu2.user_type='SALESOFFICER')) \
  		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )) \
 group by lsh.header_id
	
#getSalesPersonsMonthlyCountDash = select count(lmu.*) from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh  \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lmu.distributor_id = ? \
#	group by lsh.last_updated_by 

getSalesPersonsMonthlyCountDash = select (select count(*)from lt_mast_users) all_count from   \
lt_mast_users lmu,   \
lt_so_headers lsh    \
where 1=1   \
and lsh.last_updated_by = lmu.user_id   \
and upper(lmu.user_type) = 'SALES'   \
AND UPPER(LMU.STATUS) = 'ACTIVE'   \
and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
AND TO_CHAR(LSH.LAST_UPDATE_DATE,'YYYY-MM-DD')  >= ? \
AND LMU.DISTRIBUTOR_ID = ?  \
group by lsh.last_updated_by  

#getOrderCountMonthlyDashboard = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id = ? )

getOrderCountMonthlyDashboard = select count(*) from lt_so_headers lsh where 1=1         \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')         \
and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ?         \
AND to_char(lsh.last_update_date,'YYYY-MM-DD') >= ?         \
and lsh.last_updated_by in         \
(select lmu.user_id from lt_mast_users lmu         \
where 1=1         \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'         \
and lmu.distributor_id = ? )

#getOrderLineCountMonthlyDashboard = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id = ? ))

getOrderLineCountMonthlyDashboard = select count(*) from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
		and to_char(lsh.last_update_date,'YYYY-MM-DD')  >= ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id = ? ))

#getSalesPersonsMonthlyCountDashAdmin = select count(lmu.*) from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh  \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and upper(lmu.user_type) = 'SALES' \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	group by lsh.last_updated_by 
	
getSalesPersonsMonthlyCountDashAdmin = select (select count(*) from lt_mast_users)as all_count from \
	lt_mast_users lmu, \
	lt_so_headers lsh \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
	AND to_char(lsh.last_update_date,'YYYY-MM-DD')   >= ? \
	group by lsh.last_updated_by
	
#getSalesPersonsMonthlyCountDashSO =  select count(lmu.*) \
#from lt_mast_users lmu, lt_so_headers lsh \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and upper(lmu.user_type) = 'SALES' \
#and upper(lmu.status) = 'ACTIVE' \
#and lsh.last_update_date <= ?::date \
#AND lsh.last_update_date >= ?::date \
#and lmu.distributor_id in ( \
#select lme.distributor_id \
#from lt_mast_emp_position lmp, lt_mast_employees lme \
#,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? \
#) \
#group by lsh.last_updated_by 


getSalesPersonsMonthlyCountDashSO = select (select count(*)from lt_mast_users)all_count \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
AND to_char(lsh.last_update_date,'YYYY-MM-DD') >= ? \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2."position" \
and lmu.user_id = ? \
) \
group by lsh.last_updated_by 

#getOrderCountMonthlyDashboardSO = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' \
#	and lmu.distributor_id in (select lme.distributor_id \
#   	from lt_mast_emp_position lmp, lt_mast_employees lme, \
# 	lt_mast_users lmu3, lt_mast_positions lmp2 \
#   	where lme.employee_id = lmp.employee_id \
#   	and lmu3.position_id = lmp2.position_id \
#   	and lmp.parent_position = lmp2.position \
#   	and lmu3.user_id = ?))
  
getOrderCountMonthlyDashboardSO = select count(*) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and  to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
	AND  to_char(lsh.last_update_date,'YYYY-MM-DD')  >= ? \
	and lsh.last_updated_by in \
	(select lmu.user_id from lt_mast_users lmu \
	where 1=1 \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id in (select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
 	lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
   	and lmu3.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2."position" \
   	and lmu3.user_id = ?))  
   	
#getOrderLineCountMonthlyDashboardSO = select count(lsl.*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE' \
#		and lmu.distributor_id in ( \
#			select lme.distributor_id \
#   	  		from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   	  		lt_mast_users lmu3, lt_mast_positions lmp2 \
#   	  		where lme.employee_id = lmp.employee_id \
#      		and lmu3.position_id = lmp2.position_id \
#   	  		and lmp.parent_position = lmp2.position \
#   	  		and lmu3.user_id = ?)))
 
getOrderLineCountMonthlyDashboardSO = select (select count(*)  from lt_so_lines lsl)all_count from lt_so_lines lsl \
	where 1=1 \
	and lsl.header_id in ( \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
		and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
		and to_char(lsh.last_update_date,'YYYY-MM-DD') >= ? \
		and lsh.last_updated_by in \
		(select lmu.user_id from lt_mast_users lmu \
		where 1=1 \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
		and upper(lmu.status) = 'ACTIVE' \
		and lmu.distributor_id in ( \
			select lme.distributor_id \
   	  		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   	  		lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	  		where lme.employee_id = lmp.employee_id \
      		and lmu3.position_id = lmp2.position_id \
   	  		and lmp.parent_position = lmp2."position" \
   	  		and lmu3.user_id = ?))) 
   	  		
#getSalesPersonsMonthlyCountDashAH = select count(distinct lmu.user_id) \
#  			from lt_mast_users lmu,lt_so_headers lsh \
#  			where 1=1 \
#  			and lsh.last_updated_by = lmu.user_id \
#  			and (upper(lmu.user_type) = 'SALES') \
#  			and upper(lmu.status) = 'ACTIVE' \
#  			and lsh.last_update_date <= ?::date \
#			and lsh.last_update_date  >= ?::date \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER'))
  
getSalesPersonsMonthlyCountDashAH = select count(distinct lmu.user_id) \
  			from lt_mast_users lmu,lt_so_headers lsh \
  			where 1=1 \
  			and lsh.last_updated_by = lmu.user_id \
  			and (upper(lmu.user_type) = 'SALES') \
  			and upper(lmu.status) = 'ACTIVE' \
  			and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
			and to_char(lsh.last_update_date,'YYYY-MM-DD') >=? \
  			and lmu.distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp \
  								where lmp.position_id = ? \
  )) \
  and lmu2.user_type='SALESOFFICER'))  
  
#  getOrderCountMonthlyDashboardAH =  select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where 1=1 \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER')))
  
getOrderCountMonthlyDashboardAH = select count(*) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
	AND to_char(lsh.last_update_date,'YYYY-MM-DD')  >=  ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id  \
  			from lt_mast_users lmu  \
  			where 1=1  \
  			and lmu.distributor_id in ( \
  				select lme.distributor_id \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position" \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in ( \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp  \
  								where lmp.position_id = ?  \
  ))  \
  and lmu2.user_type='SALESOFFICER')))
  
  
#  getOrderLineCountMonthlyDashboardAH = select count(lsl.*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select lsh.header_id from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id \
#  			from lt_mast_users lmu \
#  			where 1=1 \
#  			and lmu.distributor_id in ( \
#  				select lme.distributor_id \
#   				from lt_mast_emp_position lmp, lt_mast_employees lme, \
#   					lt_mast_users lmu1, lt_mast_positions lmp2 \
#   				where lme.employee_id = lmp.employee_id \
#       			and lmu1.position_id = lmp2.position_id \
#   	   			and lmp.parent_position = lmp2.position \
#   	   			and lmu1.user_id in( \
#   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in ( \
#							select lmep.position_id \
#							from lt_mast_emp_position lmep \
#							where lmep.parent_position in ( \
#  								select lmp."position" \
#  								from lt_mast_positions lmp \
#  								where lmp.position_id = ? \
#  )) \
#  and lmu2.user_type='SALESOFFICER'))))

getOrderLineCountMonthlyDashboardAH = select (select count(*)from lt_so_lines) all_count  from lt_so_lines lsl \
	where 1=1  \
	and lsl.header_id in (  \
	select lsh.header_id from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
	AND  to_char(lsh.last_update_date,'YYYY-MM-DD') >= ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id  \
  			from lt_mast_users lmu  \
  			where 1=1  \
  			and lmu.distributor_id in (  \
  				select lme.distributor_id  \
   				from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,  \
   					lt_mast_users lmu1, lt_mast_positions_v lmp2  \
   				where lme.employee_id = lmp.employee_id  \
       			and lmu1.position_id = lmp2.position_id  \
   	   			and lmp.parent_position = lmp2."position"  \
   	   			and lmu1.user_id in(  \
   	   				select lmu2.user_id from lt_mast_users lmu2 where lmu2.position_id in (  \
							select lmep.position_id  \
							from lt_mast_emp_position_v lmep \
							where lmep.parent_position in (  \
  								select lmp."position"  \
  								from lt_mast_positions_v lmp  \
  								where lmp.position_id = ?  \
  ))  \
  and lmu2.user_type='SALESOFFICER'))))


#getOrderCountMonthlyDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#	and lsh.last_update_date <= ?::date \
#	AND lsh.last_update_date  >= ?::date \
#	and lsh.last_updated_by in \
#	(select lmu.user_id from lt_mast_users lmu \
#	where 1=1 \
#	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#	and upper(lmu.status) = 'ACTIVE' )

getOrderCountMonthlyDashboardAdmin = select count(*) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
	and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
	AND to_char(lsh.last_update_date,'YYYY-MM-DD') >= ? \
	and lsh.last_updated_by in  \
	(select lmu.user_id from lt_mast_users lmu  \
	where 1=1  \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
	and upper(lmu.status) = 'ACTIVE' )

#getOrderLineCountMonthlyDashboardAdmin = select count(*) from lt_so_lines lsl \
#	where 1=1 \
#	and lsl.header_id in ( \
#	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1 \
#	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#		and lsh.last_update_date <= ?::date \
#		and lsh.last_update_date  >= ?::date \
#		and lsh.last_updated_by in \
#		(select lmu.user_id from lt_mast_users lmu \
#		where 1=1 \
#		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#		and upper(lmu.status) = 'ACTIVE'  ))
		
getOrderLineCountMonthlyDashboardAdmin = select count(*) from lt_so_lines lsl  \
	where 1=1  \
	and lsl.header_id in (  \
	select distinct(lsh.header_id) from lt_so_headers lsh where 1=1  \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
		and to_char(lsh.last_update_date,'YYYY-MM-DD') <= ? \
		and to_char(lsh.last_update_date,'YYYY-MM-DD')  >= ? \
		and lsh.last_updated_by in  \
		(select lmu.user_id from lt_mast_users lmu  \
		where 1=1  \
		and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
		and upper(lmu.status) = 'ACTIVE'  ))	
	
#getRegionV2 = select distinct (ot.region) from lt_mast_outlets ot where ot.distributor_id = ( \
#		select distributor_id from lt_mast_users lmu where lmu.user_id = ? and org_id = ? )

getRegionV2 = select distinct (ot.region) from lt_mast_outlets_v ot where ot.distributor_id = (  \
		select distributor_id from lt_mast_users lmu where lmu.user_id = ? and org_id = ? )
		
#getDistributorIdByAH = select lme.distributor_id from lt_mast_emp_position lmep,lt_mast_employees lme \
#where 1=1 \
#and lme.employee_id = lmep.employee_id \
#and lmep.position_id = lme.position_id \
#and lmep.parent_position in (select lmp1."position" from lt_mast_positions lmp1 \
#				where lmp1.parent_position in (select lmp."position" from lt_mast_positions lmp \
#  				where lmp.position_id = ? )) 

#comment on  13-may-24 me & shubham for report issue
#getDistributorIdByAH = select lme.distributor_id from lt_mast_emp_position_v lmep,lt_mast_employees_v lme  \
#where 1=1  \
#and lme.employee_id = lmep.employee_id  \
#and lmep.position_id = lme.position_id  \
#and lmep.parent_position in (select lmp1."position" from lt_mast_positions_v lmp1  \
#				where lmp1.parent_position in (select lmp."position" from lt_mast_positions_v lmp  \
#  				where lmp.position_id = ? ))

getDistributorIdByAH = select lme.distributor_id from lt_mast_emp_position_v lmep,lt_mast_employees_v lme  \
where 1=1  \
and lme.employee_id = lmep.employee_id  \
and lmep.position_id = lme.position_id  \
and lmep.child_position in (select lmp1."position" from lt_mast_positions_v lmp1  \
				where lmp1."position" in (select lmp."position" from lt_mast_positions_v lmp  \
  				where lmp.position_id = ? ))


  					
#getDistributorIdBySO = select lme.distributor_id from lt_mast_emp_position lmep,lt_mast_employees lme \
#where 1=1 \
#and lme.employee_id = lmep.employee_id \
#and lmep.position_id = lme.position_id \
#and lmep.parent_position in (select lmp."position" from lt_mast_positions lmp where lmp.position_id = ? )
  					
getDistributorIdBySO = select lme.distributor_id from lt_mast_emp_position_v lmep,lt_mast_employees_v lme  \
where 1=1  \
and lme.employee_id = lmep.employee_id  \
and lmep.position_id = lme.position_id  \
and lmep.child_position in (select lmp."position" from lt_mast_positions_v lmp where lmp.position_id = ? )
  					
#getSearchDistributorForRegionOther = select a.* from ( select distinct(lmd.distributor_id), lmd.distributor_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code from lt_mast_distributors lmd,lt_mast_outlets lmo \
#where 1=1 \
#and lmd.distributor_id = lmo.distributor_id \
#and upper(lmd.status) = 'ACTIVE' \
#and lmd.org_id = ? \
#and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region), 'xx') \
#and COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) 

getSearchDistributorForRegionOther = select a.* \
from ( select distinct(lmd.distributor_id), lmd.distributor_id dist_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code from lt_mast_distributors_v lmd,lt_mast_outlets_v lmo  \
where 1=1  \
and lmd.distributor_id = lmo.distributor_id  \
and upper(lmd.status) = 'ACTIVE'  \
and lmd.org_id = ?  \
and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region, 'xx'))  \
and COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like \
COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) 

monthlySalesForAdminV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh, \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lsh.outlet_id = lmo.outlet_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#monthlySalesForAdminV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
#to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month, \
#count(lsl.*)as tls ,count(distinct lsl.header_id)as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

#sum(lsl.ptr_price * lsl.quantity)as sale, commenting this frm below query
#monthlySalesForAdminV2 = select   \
#to_char(lsh.last_update_date, 'DD-MON-YY')as month,  \
#to_char((select count(*)from lt_so_lines)) as tls , \
#to_char (count(distinct lsl.header_id))as dbc, \
#        CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0   \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE TO_NUMBER (nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')) \
#    END AS sale, \
#from  \
#lt_so_headers lsh,  \
#lt_so_lines lsl,  \
#lt_mast_products_v lmp,  \
#lt_mast_users lmu  \
#where 1=1  \
#and lsh.header_id = lsl.header_id  \
#and lsl.product_id = lmp.product_id  \
#and lmu.user_id = lsh.last_updated_by  \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')  \
#and lmu.status = 'ACTIVE'  \
#and lsh.last_update_date >= add_months(SYSDATE,-12) \
#group by  to_char(lsh.last_update_date, 'DD-MON-YY'), lsl.header_id, lsl.ptr_price, lsl.quantity

#AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
#and lsh.last_update_date >= add_months(TO_DATE(? ,'DD-MON-YY'),-12) \


monthlySalesForAdminV2 = SELECT \
    TO_CHAR(lsh.last_update_date, 'MON-YY') AS month, \
    TO_CHAR(COUNT(*)) AS tls, \
    TO_CHAR(COUNT(DISTINCT lsl.header_id)) AS dbc, \
    SUM( \
        CASE \
            WHEN lsl.ptr_price LIKE '%*%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
            ELSE round((nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')),2)  \
        END \
    ) AS sale, \
    SUM( \
        CASE \
            WHEN lsl.ptr_price LIKE '%*%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
            ELSE round((nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')),2) \
        END \
    ) AS totalEff \
FROM \
    lt_so_headers lsh \
    JOIN lt_so_lines lsl ON lsh.header_id = lsl.header_id \
    JOIN lt_mast_products_v lmp ON lsl.product_id = lmp.product_id \
    JOIN lt_mast_users lmu ON lsh.last_updated_by = lmu.user_id \
WHERE \
    (lsh.status = 'PROCESSED' OR lsh.status = 'APPROVED') \
    AND lmu.status = 'ACTIVE' \
    AND lsh.last_update_date >= ADD_MONTHS(SYSDATE, -12) \
GROUP BY \
    TO_CHAR(lsh.last_update_date, 'MON-YY')





#monthlySalesForDistributorV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
#to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month, \
#count(lsl.*)as tls ,count(distinct lsl.header_id)as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmu.user_id = lsh.last_updated_by \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months'

#sum(lsl.ptr_price* lsl.quantity)as sale,  comment temprary but must used in below query orifinal query this is 
#monthlySalesForDistributorV2 = select  \
#to_char(lsh.last_update_date, 'DD-MON-YY')as month,  \
#to_char((select count(*)from lt_so_lines)) as tls , \
#to_char (count(distinct lsl.header_id))as dbc, \
#CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0                   \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE TO_NUMBER(lsl.ptr_price) * (lsl.quantity) \
#    END AS sale \
#from         \
#lt_so_headers lsh,         \
#lt_so_lines lsl,         \
#lt_mast_products_v lmp,         \
#lt_mast_users lmu         \
#where 1=1         \
#and lsh.header_id = lsl.header_id         \
#and lsl.product_id = lmp.product_id         \
#and lmu.user_id = lsh.last_updated_by         \
#and lmu.status = 'ACTIVE'         \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
#and lsh.last_update_date >= add_months(SYSDATE, -12)

#AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH')

#and lsh.last_update_date >= add_months(TO_DATE(? ,'DD-MON-YY'), -12)  \


monthlySalesForDistributorV2 = SELECT \
    TO_CHAR(lsh.last_update_date, 'MON-YY') AS month, \
    TO_CHAR(COUNT(*)) AS tls, \
    TO_CHAR(COUNT(DISTINCT lsl.header_id)) AS dbc, \
    SUM( \
        CASE \
            WHEN lsl.ptr_price LIKE '%*%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
            ELSE round((nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')),2)  \
        END \
    ) AS sale, \
    SUM( \
        CASE \
            WHEN lsl.ptr_price LIKE '%*%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
            WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
            ELSE round((nvl((lsl.ptr_price),'0') * nvl((lsl.quantity),'0')),2) \
        END \
    ) AS totalEff \
FROM \
lt_so_headers lsh,  \
lt_so_lines lsl,     \
lt_mast_products_v lmp, \
lt_mast_users lmu         \
where 1=1         \
and lsh.header_id = lsl.header_id         \
and lsl.product_id = lmp.product_id         \
and lmu.user_id = lsh.last_updated_by         \
and lmu.status = 'ACTIVE'         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(SYSDATE, -12)



monthlySalesForDistributorV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, \
to_char(lsh.last_update_date, 'Mon YYYY')as month \
from \
lt_so_headers lsh , \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_outlets_v lmo \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lsh.outlet_id = lmo.outlet_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' 

#getOrderCountMonthlyDashboardAdminV2 = select count(*)as dbc, to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

getOrderCountMonthlyDashboardAdminV2 = select count(*)as dbc, to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lmu.user_id = lsh.last_updated_by         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'         \
group by to_char(lsh.last_update_date, 'Mon YYYY')  

getOrderCountMonthlyDashboardAdminV2COPY = select count(*)as dbc, to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2 \
where 1=1 \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardAdminV2 = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAdminV2 = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lsl.header_id = lsh.header_id         \
and lmu.user_id = lsh.last_updated_by         \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')         \
and lsh.last_update_date > add_months(?,-12)         \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'     \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAdminV2COPY = select count(*)as tls, to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_lines lsl,lt_so_headers lsh, lt_mast_users lmu, lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2 \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardSOV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
   	lt_so_headers lsh,lt_mast_users lmu \
	where 1=1 \
	and lsh.last_updated_by = lmu.user_id \
	and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
	and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
	and upper(lmu.status) = 'ACTIVE' \
	and lmu.distributor_id in ( select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
 	lt_mast_users lmu3, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
   	and lmu3.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu3.user_id = ? ) \
   	group by to_char(lsh.last_update_date, 'Mon YYYY') 
   	
   	
#getOrderCountMonthlyDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from \
#lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' 

getOrderCountMonthlyDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from         \
lt_so_headers lsh,lt_mast_users lmu         \
where 1=1         \
and lsh.last_updated_by = lmu.user_id         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )         \
and upper(lmu.status) = 'ACTIVE'  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardSOV2COPY1 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY')
   	
getOrderLineCountMonthlyDashboardSOV2COPY = select count(lsl.*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme, \
lt_mast_users lmu3, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu3.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu3.user_id = ? ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardSOV2 = select count(lsl.*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id=lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.user_id in ( \
#select lmu2.user_id from \
#(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
#  from lt_mast_users lmu where lmu.distributor_id in( \
#select lme.distributor_id from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? )) lmu2 \
#,lt_mast_employees lme \
#,lt_mast_emp_position lmep \
#where 1=1 \
#and lmu2.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu2.position_id = lmep.position_id ) \
#group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardSOV2 = select to_char(lsh.last_update_date, 'Mon YYYY')as month,(select count(*) from lt_so_lines) as tls \
from lt_so_lines lsl ,lt_so_headers lsh,lt_mast_users lmu  \
where 1=1  \
and lsl.header_id=lsh.header_id  \
and lmu.user_id=lsh.last_updated_by  \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
and lsh.last_update_date >  add_months(?,-12)  \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.user_id in (  \
select lmu2.user_id from  \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id  \
  from lt_mast_users lmu where lmu.distributor_id in(  \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2  \
where lme.employee_id = lmp.employee_id  \
and lmu.position_id = lmp2.position_id  \
and lmp.parent_position = lmp2."position"  \
and lmu.user_id = ? )) lmu2  \
,lt_mast_employees_v lme  \
,lt_mast_emp_position_v lmep  \
where 1=1  \
and lmu2.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu2.position_id = lmep.position_id )  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardAHV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_headers lsh \
where 1=1 \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lsh.last_updated_by in ( \
select lmu.user_id from lt_mast_users lmu \
where 1=1 and lmu.distributor_id in ( select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER'))) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 


#getOrderCountMonthlyDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_so_headers lsh \
#where 1=1 \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' 

getOrderCountMonthlyDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month         \
from lt_so_headers lsh         \
where 1=1         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= add_months(?,-12)  \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getOrderCountMonthlyDashboardAHV2COPY1 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_headers lsh \
where 1=1 \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lsh.last_updated_by in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in(  select distinct lmu.user_id from  \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAHV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id =lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER')) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

#getOrderLineCountMonthlyDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
#lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id =lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and lsh.last_updated_by in ( \
#select abc.user_id from \
#(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
#from lt_mast_users lmu \
#where 1=1 \
#and lmu.distributor_id in ( \
#  	select lme.distributor_id \
#   	from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu1, lt_mast_positions lmp2 \
#   	where lme.employee_id = lmp.employee_id \
#    and lmu1.position_id = lmp2.position_id \
#   	and lmp.parent_position = lmp2.position \
#   	and lmu1.user_id in(  select distinct lmu.user_id from \
#   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position lmep,lt_mast_positions lmp \
#   where 1=1 and lmep.parent_position=lmp."position" \
#   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees lme \
#  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
#  	and lmu.user_type='SALESOFFICER' )))abc \
#  	, lt_mast_employees lme \
#  	   , lt_mast_emp_position lmep \
#  	   where 1=1 \
#  	   and abc.employee_code = lme.employee_code \
#  	   and lme.employee_id = lmep.employee_id \
#  	   and abc.position_id = lmep.position_id ) \
#group by to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month from   \
lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu   \
where 1=1   \
and lsl.header_id =lsh.header_id   \
and lmu.user_id = lsh.last_updated_by   \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')   \
and lsh.last_update_date >  add_months(?,-12)   \
and lsh.last_updated_by in (   \
select abc.user_id from   \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id   \
from lt_mast_users lmu   \
where 1=1   \
and lmu.distributor_id in (   \
SELECT LME.DISTRIBUTOR_ID   \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2   \
where lme.employee_id = lmp.employee_id   \
and lmu1.position_id = lmp2.position_id   \
and lmp.parent_position = lmp2."position"   \
AND LMU1.USER_ID IN( SELECT DISTINCT LMU.USER_ID FROM   \
( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp   \
WHERE 1=1 AND LMEP.PARENT_POSITION=LMP."position"   \
and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme   \
where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id   \
AND LMU.USER_TYPE='SALESOFFICER' )))ABC   \
, LT_MAST_EMPLOYEES_V LME   \
, lt_mast_emp_position_v lmep   \
where 1=1   \
and abc.employee_code = lme.employee_code   \
and lme.employee_id = lmep.employee_id   \
AND ABC.POSITION_ID = LMEP.POSITION_ID )   \
GROUP BY TO_CHAR(LSH.LAST_UPDATE_DATE, 'Mon YYYY') 

getOrderCountMonthlyDashboardV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month from lt_so_headers lsh, lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#getOrderCountMonthlyDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_so_headers lsh, \
#lt_mast_users lmu, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')

getOrderCountMonthlyDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
from lt_so_headers lsh,  \
lt_mast_users lmu,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')  \
and lsh.last_update_date >= add_months(?,-12)  \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

getOrderLineCountMonthlyDashboardV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_so_lines lsl ,lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lsl.header_id = lsh.header_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

#getOrderLineCountMonthlyDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month \
#from lt_so_lines lsl, \
#lt_mast_users lmu, \
#lt_so_headers lsh, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lsl.header_id = lsh.header_id \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date, 'Mon YYYY') 

getOrderLineCountMonthlyDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
from lt_so_lines lsl,  \
lt_mast_users lmu,  \
lt_so_headers lsh,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and lsl.header_id = lsh.header_id  \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')  \
and lsh.last_update_date >  add_months(?,-12) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )  \
and upper(lmu.status) = 'ACTIVE'  \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY')

dailySalesForAdminV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from \
lt_so_headers lsh, \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_prod_categories lmpc, \
lt_mast_outlets_v lmo, \
lt_mast_users lmu \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lmp.category_id = lmpc.category_id \
and lsh.outlet_id = lmo.outlet_id \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date > date_trunc('month', current_date) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 


#dailySalesForAdminV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#,count(lsl.*)as tls,count(distinct lsl.header_id) as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmp.category_id = lmpc.category_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' > date_trunc('month', current_date) \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

#sum(lsl.ptr_price* lsl.quantity)as sale, temprary comment but must used in below query
#dailySalesForAdminV2 = select to_char(lsh.last_update_date, 'DD-MON-YY')as last_date   \
#,(select count(*) from lt_so_lines)as tls,count(distinct lsl.header_id) as dbc,   \
#        CASE \
#        WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE TO_NUMBER(lsl.ptr_price) * (lsl.quantity) \
#        END AS sale \
#from   \
#lt_so_headers lsh,   \
#lt_so_lines lsl,   \
#lt_mast_products_v lmp,   \
#lt_mast_prod_categories lmpc,   \
#lt_mast_users lmu   \
#where 1=1   \
#and lsh.header_id = lsl.header_id   \
#and lsl.product_id = lmp.product_id   \
#and lmp.category_id = lmpc.category_id   \
#and lsh.last_updated_by = lmu.user_id   \
#and lmu.status = 'ACTIVE'   \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
#group by  to_char(lsh.last_update_date, 'DD-MON-YY'), lsl.header_id, lsl.ptr_price, lsl.quantity 


dailySalesForAdminV2 = select to_char(lsh.last_update_date, 'DD-MON-YY')as "date"   \
,(select count(*) from lt_so_lines)as tls,\
         count(distinct lsl.header_id) as dbc,   \
   sum(     CASE \
        WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE ROUND(NVL(TO_NUMBER(lsl.ptr_price), 0) * NVL(lsl.quantity, 0), 2) \
        END )AS sale \
from   \
lt_so_headers lsh,   \
lt_so_lines lsl,   \
lt_mast_products_v lmp,   \
lt_mast_prod_categories lmpc,   \
lt_mast_users lmu   \
where 1=1   \
and lsh.header_id = lsl.header_id   \
and lsl.product_id = lmp.product_id   \
and lmp.category_id = lmpc.category_id \
and lsh.last_updated_by = lmu.user_id   \
and lmu.status = 'ACTIVE'   \
and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
group by  to_char(lsh.last_update_date, 'DD-MON-YY') \
ORDER BY to_char(lsh.last_update_date, 'DD-MON-YY')



dailySalesForDistributorV2COPY = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from \
lt_so_headers lsh , \
lt_so_lines lsl, \
lt_mast_products_v lmp, \
lt_mast_prod_categories lmpc, \
lt_mast_outlets_v lmo \
where 1=1 \
and lsh.header_id = lsl.header_id \
and lsl.product_id = lmp.product_id \
and lmp.category_id = lmpc.category_id \
and lsh.outlet_id = lmo.outlet_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'INPROCESS' or UPPER(lsh.status) = 'APPROVED') \
and lmo.org_id = ? \
and lsh.last_update_date > date_trunc('month', current_date) 

#dailySalesForDistributorV2 = select sum(lsl.ptr_price::NUMERIC(25,0) * lsl.quantity::NUMERIC(25,0))as sale, to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#,count(lsl.*)as tls,count(distinct lsl.header_id) as dbc \
#from \
#lt_so_headers lsh, \
#lt_so_lines lsl, \
#lt_mast_products lmp, \
#lt_mast_prod_categories lmpc, \
#lt_mast_users lmu \
#where 1=1 \
#and lsh.header_id = lsl.header_id \
#and lsl.product_id = lmp.product_id \
#and lmp.category_id = lmpc.category_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.status = 'ACTIVE' \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date)  

#sum(lsl.ptr_price * lsl.quantity)as sale, comment temprary but must need in below query
#dailySalesForDistributorV2 = select to_char(lsh.last_update_date, 'DD-MON-YY')as last_date \
#,(select count (*) from lt_So_lines )as tls,count(distinct lsl.header_id) as dbc,   \
#        CASE \
#        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
#        WHEN lsl.ptr_price LIKE '%''%' THEN 0 \
#        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
#        ELSE TO_NUMBER(lsl.ptr_price) * (lsl.quantity) \
#    END AS sale \
#from          \
#lt_so_headers lsh,          \
#lt_so_lines lsl,          \
#lt_mast_products_v lmp,          \
#lt_mast_prod_categories lmpc,          \
#lt_mast_users lmu          \
#where 1=1          \
#and lsh.header_id = lsl.header_id          \
#and lsl.product_id = lmp.product_id          \
#and lmp.category_id = lmpc.category_id          \
#and lsh.last_updated_by = lmu.user_id          \
#and lmu.status = 'ACTIVE'          \
#and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') 


dailySalesForDistributorV2 = select to_char(lsh.last_update_date, 'DD-MON-YY')as "date"   \
,(select count(*) from lt_so_lines)as tls, \
         count(distinct lsl.header_id) as dbc,   \
   sum(     CASE \
        WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE ROUND(NVL(TO_NUMBER(lsl.ptr_price), 0) * NVL(lsl.quantity, 0), 2) \
        END )AS sale \
from          \
lt_so_headers lsh,          \
lt_so_lines lsl,          \
lt_mast_products_v lmp,          \
lt_mast_prod_categories lmpc,          \
lt_mast_users lmu          \
where 1=1          \
and lsh.header_id = lsl.header_id          \
and lsl.product_id = lmp.product_id          \
and lmp.category_id = lmpc.category_id          \
and lsh.last_updated_by = lmu.user_id          \
and lmu.status = 'ACTIVE'          \
and (lsh.status = 'PROCESSED' or lsh.status = 'INPROCESS' or lsh.status = 'APPROVED') \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH')


getOrderCountDashboardV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and(UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees lme2,lt_mast_emp_position lmep2 \
#where 1=1 \
#and lmu.employee_code = lme2.employee_code \
#and lme2.employee_id = lmep2.employee_id \
#and lmu.position_id = lmep2.position_id \
#and lsh.last_updated_by=lmu.user_id \
#and(lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

getOrderCountDashboardV2 = select count(*)as dbc,to_char(lsh.last_update_date , 'YYYY-MM-DD')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2     \
where 1=1     \
and lmu.employee_code = lme2.employee_code     \
and lme2.employee_id = lmep2.employee_id     \
and lmu.position_id = lmep2.position_id     \
and lsh.last_updated_by=lmu.user_id     \
and(lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date  >= trunc(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR')     \
and upper(lmu.status) = 'ACTIVE'     \
and lmu.distributor_id = ?     \
group by  to_char(lsh.last_update_date,'YYYY-MM-DD')

getOrderLineCountDashboardV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id = lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position lmep2,lt_mast_employees lme2 \
#where 1=1 \
#and lmu.employee_code = lme2.employee_code \
#and lme2.employee_id = lmep2.employee_id \
#and lmu.position_id = lmep2.position_id \
#and lsl.header_id = lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY')

getOrderLineCountDashboardV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2     \
where 1=1     \
and lmu.employee_code = lme2.employee_code     \
and lme2.employee_id = lmep2.employee_id     \
and lmu.position_id = lmep2.position_id     \
and lsl.header_id = lsh.header_id     \
and lmu.user_id = lsh.last_updated_by     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month')     \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
and upper(lmu.status) = 'ACTIVE'     \
and lmu.distributor_id = ?    \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

getOrderCountDashboardSOV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh ,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in \
( select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme ,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? ) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh ,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by=lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 

getOrderCountDashboardSOV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'YYYY-MM-DD')as last_date         \
from lt_so_headers lsh ,lt_mast_users lmu         \
where 1=1         \
and lsh.last_updated_by=lmu.user_id         \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')         \
and lsh.last_update_date >= trunc(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'month')         \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR')  \


getOrderCountDashboardSOV2COPY2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh ,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by=lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id \
) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') \

getOrderLineCountDashboardSOV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu.user_id = ? ) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardSOV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id=lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and lmu.user_id in ( \
#select lmu2.user_id from \
#(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
#  from lt_mast_users lmu where lmu.distributor_id in( \
#select lme.distributor_id from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu, lt_mast_positions lmp2 \
#where lme.employee_id = lmp.employee_id \
#and lmu.position_id = lmp2.position_id \
#and lmp.parent_position = lmp2.position \
#and lmu.user_id = ? )) lmu2 \
#,lt_mast_employees lme \
#,lt_mast_emp_position lmep \
#where 1=1 \
#and lmu2.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu2.position_id = lmep.position_id ) \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardSOV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lsl.header_id=lsh.header_id     \
and lmu.user_id=lsh.last_updated_by     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month')     \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
and lmu.user_id in (     \
select lmu2.user_id from  \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id     \
  from lt_mast_users lmu where lmu.distributor_id in(     \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2     \
where lme.employee_id = lmp.employee_id     \
and lmu.position_id = lmp2.position_id     \
and lmp.parent_position = lmp2."position"     \
and lmu.user_id = ? )) lmu2     \
,lt_mast_employees_v lme     \
,lt_mast_emp_position_v lmep     \
where 1=1     \
and lmu2.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu2.position_id = lmep.position_id )     \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

getOrderCountDashboardAHV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( \
   	   	select lmu2.user_id from lt_mast_users lmu2,lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   	   		where 1=1 \
   	   		and lmu2.position_id=lmep.position_id \
   	   		and lmep.parent_position=lmp."position" \
   	   		and lmu2.user_type='SALESOFFICER' \
   	   		and lmp.position_id = ? \
  )) \
  group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 
  
  
#getOrderCountDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) 

getOrderCountDashboardAHV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'YYYY-MM-DD')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lsh.last_updated_by = lmu.user_id     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >= trunc(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )

getOrderCountDashboardAHV2COPY2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
and lmu.user_id in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in(select distinct lmu.user_id from  \
   (select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id) \
  group by to_char(lsh.last_update_date, 'DD-MM-YYYY')
  
getOrderLineCountDashboardAHV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu \
where 1=1 \
and lsl.header_id=lsh.header_id \
and lmu.user_id=lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and lmu.distributor_id in ( \
  	select lme.distributor_id \
   		from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   		where lme.employee_id = lmp.employee_id \
       	and lmu1.position_id = lmp2.position_id \
   	   	and lmp.parent_position = lmp2.position \
   	   	and lmu1.user_id in( \
   	   		select lmu2.user_id from lt_mast_users lmu2,lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   	   		where 1=1 \
   	   		and lmu2.position_id=lmep.position_id \
   	   		and lmep.parent_position=lmp."position" \
   	   		and lmu2.user_type='SALESOFFICER' \
   	   		and lmp.position_id = ?)) \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date      \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu      \
where 1=1      \
and lsl.header_id=lsh.header_id      \
and lmu.user_id=lsh.last_updated_by      \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')      \
and lsh.last_update_date > trunc(?,'month')      \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )      \
and lmu.user_id in (      \
select abc.user_id from      \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id      \
from lt_mast_users lmu      \
where 1=1      \
and lmu.distributor_id in (      \
select lme.distributor_id      \
from lt_mast_emp_position lmp, lt_mast_employees lme,lt_mast_users lmu1, lt_mast_positions lmp2      \
where lme.employee_id = lmp.employee_id      \
and lmu1.position_id = lmp2.position_id      \
and lmp.parent_position = lmp2."position"      \
and lmu1.user_id in(  select distinct lmu.user_id from      \
(select lmep.position_id ,lmep.employee_id from lt_mast_emp_position lmep,lt_mast_positions lmp      \
where 1=1 and lmep.parent_position=lmp."position"      \
and lmp.position_id = ?  )lmep2, lt_mast_users lmu ,lt_mast_employees lme      \
where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id      \
and lmu.user_type='SALESOFFICER' )))abc      \
, lt_mast_employees lme      \
, lt_mast_emp_position lmep      \
where 1=1      \
and abc.employee_code = lme.employee_code      \
and lme.employee_id = lmep.employee_id      \
and abc.position_id = lmep.position_id )      \
group by to_char(lsh.last_update_date, 'DD-Mon-YY')  

#getOrderLineCountDashboardAHV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu     \
#where 1=1     \
#and lsl.header_id=lsh.header_id     \
#and lmu.user_id=lsh.last_updated_by  \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
#and lsh.last_update_date > trunc(?,'month')     \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )     \
#and lmu.user_id in (     \
#select abc.user_id from     \
#(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id     \
#from lt_mast_users lmu     \
#where 1=1     \
#and lmu.distributor_id in (     \
#  	select lme.distributor_id     \
#   	from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2     \
#   	where lme.employee_id = lmp.employee_id     \
#    and lmu1.position_id = lmp2.position_id     \
#   	and lmp.parent_position = lmp2."position"     \
#   	and lmu1.user_id in(  select distinct lmu.user_id from     \
#   (select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp     \
#   where 1=1 and lmep.parent_position=lmp."position"     \
#   and lmp.position_id = ?  )lmep2, lt_mast_users lmu ,lt_mast_employees_v lme     \
#  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id     \
#  	and lmu.user_type='SALESOFFICER' )))abc     \
#  	, lt_mast_employees_v lme     \
#  	   , lt_mast_emp_position_v lmep     \
#  	   where 1=1     \
#  	   and abc.employee_code = lme.employee_code     \
#  	   and lme.employee_id = lmep.employee_id     \
#  	   and abc.position_id = lmep.position_id )    \
#  group by to_char(lsh.last_update_date, 'DD-Mon-YY') 

#getOrderCountDashboardAdminV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_users lmu \
#where 1=1 \
#and lmu.user_id = lsh.last_updated_by \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')

getOrderCountDashboardAdminV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date     \
from lt_so_headers lsh,lt_mast_users lmu     \
where 1=1     \
and lmu.user_id = lsh.last_updated_by     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >=trunc(SYSDATE, 'month')     \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR' )     \
and upper(lmu.status) = 'ACTIVE'     \
group by to_char(lsh.last_update_date, 'DD-Mon-YY')  

getOrderCountDashboardAdminV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh,lt_mast_users lmu,lt_mast_emp_position_v lmep2,lt_mast_employees_v lme2 \
where 1=1 \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY')

#getOrderLineCountDashboardAdminV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu  \
#where 1=1 \
#and lsl.header_id=lsh.header_id \
#and lmu.user_id = lsh.last_updated_by \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
#and upper(lmu.status) = 'ACTIVE' \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderLineCountDashboardAdminV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-Mon-YY')as last_date   \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu    \
where 1=1    \
and lsl.header_id=lsh.header_id    \
and lmu.user_id = lsh.last_updated_by    \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')    \
and lsh.last_update_date > trunc(?,'month')    \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' )    \
and upper(lmu.status) = 'ACTIVE'    \
group by to_char(lsh.last_update_date, 'DD-Mon-YY') 

getOrderLineCountDashboardAdminV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh,lt_mast_users lmu,lt_mast_employees_v lme2,lt_mast_emp_position_v lmep2 \
where 1=1 \
and lmu.employee_code = lme2.employee_code \
and lme2.employee_id = lmep2.employee_id \
and lmu.position_id = lmep2.position_id \
and lsl.header_id=lsh.header_id \
and lmu.user_id = lsh.last_updated_by \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and (upper(lmu.user_type) = 'SALES' or upper(lmu.user_type) = 'DISTRIBUTOR' ) \
and upper(lmu.status) = 'ACTIVE' \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

getOrderCountSalesV2COPY = select count(*)as dbc,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_headers lsh \
where 1=1 \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and lsh.last_updated_by = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderCountSalesV2 = select count(*)as dbc,to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY')as date \
#from lt_so_headers lsh,lt_mast_emp_position lmep,lt_mast_users lmu,lt_mast_employees lme \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED') \
#and lsh.last_update_date at time zone 'IST' >= date_trunc('month', current_date) \
#and lsh.last_updated_by = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'DD-MM-YYYY') 

getOrderCountSalesV2 = select count(*)as dbc,to_char(lsh.last_update_date, 'YYYY-MM-DD')as last_date     \
from lt_so_headers lsh,lt_mast_emp_position_v lmep,lt_mast_users lmu,lt_mast_employees_v lme     \
where 1=1     \
and lsh.last_updated_by = lmu.user_id     \
and lmu.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu.position_id = lmep.position_id     \
and (lsh.status = 'PROCESSED' or lsh.status = 'APPROVED')     \
and lsh.last_update_date >= trunc(TO_DATE(SYSDATE ,'YYYY-MM-DD'),'month')     \
and lsh.last_updated_by =?    \
group by  to_char(lsh.last_update_date, 'YYYY-MM-DD')

getOrderLineCountDashboardSalesV2COPY = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
from lt_so_lines lsl,lt_so_headers lsh \
where 1=1 \
and lsl.header_id = lsh.header_id \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
and lsh.last_update_date > date_trunc('month', current_date) \
and lsh.last_updated_by = ? \
group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') 

#getOrderLineCountDashboardSalesV2 = select count(*)as tls,to_char(lsh.last_update_date, 'DD-MM-YYYY')as date \
#from lt_so_lines lsl,lt_so_headers lsh, lt_mast_emp_position lmep, lt_mast_users lmu, lt_mast_employees lme \
#where 1=1 \
#and lsl.header_id = lsh.header_id \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED') \
#and lsh.last_update_date > date_trunc('month', current_date) \
#and lsh.last_updated_by = ? \
#group by  to_char(lsh.last_update_date, 'DD-MM-YYYY') \

getOrderLineCountDashboardSalesV2 = select count(*)as tls,to_char(lsh.last_update_date,'DD-Mon-YY')as last_date     \
from  lt_so_lines lsl,lt_so_headers lsh, lt_mast_emp_position_v lmep, lt_mast_users lmu, lt_mast_employees_v lme     \
where 1=1     \
and lsl.header_id = lsh.header_id     \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code     \
and lme.employee_id = lmep.employee_id     \
and lmu.position_id = lmep.position_id     \
and (UPPER(lsh.status) = 'PROCESSED' or UPPER(lsh.status) = 'APPROVED')     \
and lsh.last_update_date > trunc(?,'month') \
and lsh.last_updated_by = ?     \
group by  to_char(lsh.last_update_date, 'DD-Mon-YY')

#getSalesPersonsMonthlyCountDashAdminV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month from \
#	lt_mast_users lmu, \
#	lt_so_headers lsh \
#	where 1=1 \
#	and lsh.last_updated_by = lmu.user_id \
#	and lmu.user_type = 'SALES' \
#	and lmu.status = 'ACTIVE' \
#	and lsh.last_update_date at time zone 'IST' >=  CURRENT_DATE - INTERVAL '12 months' \
#	group by to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')

#this is original query comment on 20-May-2024
#getSalesPersonsMonthlyCountDashAdminV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'YYYY-MM-DD')as month    \
#from    \
#lt_mast_users lmu,    \
#lt_so_headers lsh    \
#where 1=1    \
#and lsh.last_updated_by = lmu.user_id    \
#and lmu.user_type = 'SALES'    \
#and lmu.status = 'ACTIVE'    \
#and lsh.last_update_date >= add_months(SYSDATE,-12)    \
#group by to_char(lsh.last_update_date, 'YYYY-MM-DD')

getSalesPersonsMonthlyCountDashAdminV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'MON-YY')as month    \
from    \
lt_mast_users lmu,    \
lt_so_headers lsh    \
where 1=1    \
and lsh.last_updated_by = lmu.user_id    \
and lmu.user_type = 'SALES'    \
and lmu.status = 'ACTIVE'    \
and lsh.last_update_date >= add_months(SYSDATE,-12)    \
group by to_char(lsh.last_update_date, 'MON-YY')

	
getSalesPersonsMonthlyCountDashAdminV2COPY = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month from \
	lt_mast_users lmu, \
	lt_so_headers lsh, \
	lt_mast_emp_position_v lmep2, \
	lt_mast_employees_v lme2 \
	where 1=1 \
	and lmu.employee_code = lme2.employee_code \
  	and lme2.employee_id = lmep2.employee_id \
  	and lmu.position_id = lmep2.position_id \
	and lsh.last_updated_by = lmu.user_id \
	and upper(lmu.user_type) = 'SALES' \
	and upper(lmu.status) = 'ACTIVE' \
	and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
	group by  to_char(lsh.last_update_date, 'Mon YYYY')
	
getSalesPersonsMonthlyCountDashSOV2COPY = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in ( \
select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme \
,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? \
) \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getSalesPersonsMonthlyCountDashSOV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_mast_users lmu, lt_so_headers lsh \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.user_type = 'SALES' \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months'  

getSalesPersonsMonthlyCountDashSOV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'YYYY-MM-DD')as month    \
from lt_mast_users lmu, lt_so_headers lsh    \
where 1=1    \
and lsh.last_updated_by = lmu.user_id    \
and lmu.user_type = 'SALES'    \
and lmu.status = 'ACTIVE'    \
and lsh.last_update_date >= add_months(TO_DATE(SYSDATE ,'YYYY-MM-DD'),-12)


#AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH')
  

getSalesPersonsMonthlyCountDashSOV2COPY1 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lmu.user_type = 'SALES' \
and lmu.status = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.user_id in ( \
select lmu2.user_id from \
(select lmu.user_id ,lmu.user_type ,lmu.employee_code ,lmu.position_id \
  from lt_mast_users lmu where lmu.distributor_id in( \
select lme.distributor_id from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu.position_id = lmp2.position_id \
and lmp.parent_position = lmp2.position \
and lmu.user_id = ? )) lmu2 \
,lt_mast_employees_v lme \
,lt_mast_emp_position_v lmep \
where 1=1 \
and lmu2.employee_code = lme.employee_code \
and lme.employee_id = lmep.employee_id \
and lmu2.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY') 

getSalesPersonsMonthlyCountDashAHV2COPY = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and (upper(lmu.user_type) = 'SALES') \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id in (select lme.distributor_id \
from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
where lme.employee_id = lmp.employee_id \
and lmu1.position_id = lmp2.position_id and lmp.parent_position = lmp2.position and lmu1.user_id in( \
select lmu2.user_id from lt_mast_positions_v lmp,lt_mast_emp_position_v lmep,lt_mast_users lmu2 \
where 1=1 and lmp.position =lmep.parent_position and lmu2.position_id=lmep.position_id \
and lmp.position_id = ? and lmu2.user_type='SALESOFFICER')) \
group by  to_char(lsh.last_update_date, 'Mon YYYY')


getSalesPersonsMonthlyCountDashAHV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'YYYY-MM-DD')as month   \
from lt_mast_users lmu,lt_so_headers lsh   \
where 1=1   \
and lsh.last_updated_by = lmu.user_id   \
and lmu.user_type = 'SALES'   \
and lmu.status = 'ACTIVE'   \
and lsh.last_update_date >= add_months(TO_DATE(SYSDATE ,'YYYY-MM-DD'),-12)  \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 
 
#getSalesPersonsMonthlyCountDashAHV2 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month  \
#from lt_mast_users lmu,lt_so_headers lsh  \
#where 1=1  \
#and lsh.last_updated_by = lmu.user_id  \
#and lmu.user_type = 'SALES'  \
#and lmu.status = 'ACTIVE'  \
#and lsh.last_update_date >= add_months(?,-12) \
#and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') 

getSalesPersonsMonthlyCountDashAHV2COPY1 = select count(distinct lmu.user_id)as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu,lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and lmu.user_type = 'SALES' \
and lmu.status = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and (lmu.user_type = 'SALES' or lmu.user_type = 'DISTRIBUTOR') \
and lmu.user_id in ( \
select abc.user_id from \
(select distinct lmu.user_id,lmu.user_type,lmu.employee_code,lmu.position_id \
from lt_mast_users lmu \
where 1=1 \
and lmu.distributor_id in ( \
 select lme.distributor_id \
 from lt_mast_emp_position_v lmp, lt_mast_employees_v lme,lt_mast_users lmu1, lt_mast_positions_v lmp2 \
   	where lme.employee_id = lmp.employee_id \
    and lmu1.position_id = lmp2.position_id \
   	and lmp.parent_position = lmp2.position \
   	and lmu1.user_id in( select distinct lmu.user_id from \
   ( select lmep.position_id ,lmep.employee_id from lt_mast_emp_position_v lmep,lt_mast_positions_v lmp \
   where 1=1 and lmep.parent_position=lmp."position" \
   and lmp.position_id = ? )lmep2 ,lt_mast_users lmu ,lt_mast_employees_v lme \
  	where 1=1 and lmep2.position_id = lmu.position_id and lme.employee_code = lmu.employee_code and lmep2.employee_id = lme.employee_id \
  	and lmu.user_type='SALESOFFICER' )))abc \
  	, lt_mast_employees_v lme \
  	   , lt_mast_emp_position_v lmep \
  	   where 1=1 \
  	   and abc.employee_code = lme.employee_code \
  	   and lme.employee_id = lmep.employee_id \
  	   and abc.position_id = lmep.position_id ) \
group by to_char(lsh.last_update_date, 'Mon YYYY')

getSalesPersonsMonthlyCountDashV2COPY = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date, 'Mon YYYY')as month \
from lt_mast_users lmu, \
lt_so_headers lsh \
where 1=1 \
and lsh.last_updated_by = lmu.user_id \
and upper(lmu.user_type) = 'SALES' \
and upper(lmu.status) = 'ACTIVE' \
and lsh.last_update_date >  CURRENT_DATE - INTERVAL '12 months' \
and lmu.distributor_id = ? \
group by  to_char(lsh.last_update_date, 'Mon YYYY') 

#getSalesPersonsMonthlyCountDashV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY')as month \
#from lt_mast_users lmu, \
#lt_so_headers lsh, \
#lt_mast_employees lme, \
#lt_mast_emp_position lmep \
#where 1=1 \
#and lsh.last_updated_by = lmu.user_id \
#and lmu.employee_code = lme.employee_code \
#and lme.employee_id = lmep.employee_id \
#and lmu.position_id = lmep.position_id \
#and lmu.user_type = 'SALES' \
#and lmu.status = 'ACTIVE' \
#and lsh.last_update_date at time zone 'IST' >= CURRENT_DATE - INTERVAL '12 months' \
#and lmu.distributor_id = ? \
#group by  to_char(lsh.last_update_date at time zone 'IST', 'Mon YYYY') 

getSalesPersonsMonthlyCountDashV2 = select count(distinct lmu.user_id) as totalEff,to_char(lsh.last_update_date , 'YYYY-MM-DD')as month  \
from lt_mast_users lmu,  \
lt_so_headers lsh,  \
lt_mast_employees_v lme,  \
lt_mast_emp_position_v lmep  \
where 1=1  \
and lsh.last_updated_by = lmu.user_id  \
and lmu.employee_code = lme.employee_code  \
and lme.employee_id = lmep.employee_id  \
and lmu.position_id = lmep.position_id  \
and lmu.user_type = 'SALES'  \
and lmu.status = 'ACTIVE'  \
AND LSH.LAST_UPDATE_DATE >  TRUNC(SYSDATE, 'MONTH') \
and lmu.distributor_id =? \
group by  to_char(lsh.last_update_date, 'YYYY-MM-DD')


#and lsh.last_update_date >=add_months(TO_DATE(? ,'YYYY-MM-DD'),-12) \


#getReportDataByDistributorAdmin = select sum(lsl.quantity::NUMERIC(25,0)* lsl.list_price::NUMERIC(25,0))as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code, \
#	lmpc.category_name, lmpc.category_code \
#	from lt_so_headers lsh \
#	,lt_so_lines lsl \
#	,lt_mast_outlets lmo \
#	,lt_mast_products lmp \
#	,lt_mast_distributors lmd \
#	,lt_mast_prod_categories lmpc \
#	,lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND UPPER(lsh.status) = 'PROCESSED' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
#	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) \
#	group by lmd.distributor_crm_code,lmpc.category_code,lmd.distributor_name,lmpc.category_name \
#	order by lmd.distributor_crm_code asc


# sum(lsl.quantity * lsl.list_price)as Amount this ti temprary comment but must use in below query
getReportDataByDistributorAdmin = select lmd.distributor_name, lmd.distributor_crm_code as distributor_code,    \
lmpc.category_name, lmpc.category_code,    \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
END ) * (CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
END ) \
AS amount \
from lt_so_headers lsh    \
,lt_so_lines lsl    \
,lt_mast_outlets_v lmo    \
,lt_mast_products_v lmp    \
,lt_mast_distributors_v lmd    \
,lt_mast_prod_categories lmpc    \
,lt_mast_users lmu    \
where 1 = 1    \
and lsh.header_id = lsl.header_id    \
and lsl.product_id = lmp.product_id    \
and lmp.category_id = lmpc.category_id    \
and lsh.outlet_id = lmo.outlet_id    \
and lmo.distributor_id = lmd.distributor_id    \
and lmu.user_id = lsh.last_updated_by    \
and lmu.status = 'ACTIVE'    \
AND COALESCE(lmo.org_id ,'xx') = COALESCE( ? ,COALESCE(lmo.org_id,'xx'))    \
AND COALESCE(lmpc.category_id ,'xx') = COALESCE( ? ,COALESCE(lmpc.category_id,'xx'))    \
AND COALESCE(lmo.distributor_id ,'xx') = COALESCE(? ,COALESCE(lmo.distributor_id,'xx'))    \
and( lsh.last_update_date between to_date( ?, 'DD-MON-YY')and to_date(?, 'DD-MON-YY')    \
or to_char(lsh.last_update_date, 'DD-MON-YY') = ?   \
or to_char(lsh.last_update_date, 'DD-MON-YY') = ?)  \
group by lmd.distributor_crm_code,lmpc.category_code,lmd.distributor_name,lmpc.category_name,lsl.ptr_price,lsl.quantity    \
order by lmd.distributor_crm_code asc
 
#AND UPPER(lsh.status) = 'PROCESSED'    \


#getReportDataByDistributor = select sum(lsl.quantity::NUMERIC(25,0)* lsl.list_price::NUMERIC(25,0))as Amount,lmd.distributor_name, lmd.distributor_crm_code as distributor_code, \
#	lmpc.category_name, lmpc.category_code \
#	from lt_so_headers lsh \
#	,lt_so_lines lsl \
#	,lt_mast_outlets lmo \
#	,lt_mast_products lmp \
#	,lt_mast_distributors lmd \
#	,lt_mast_prod_categories lmpc \
#	,lt_mast_users lmu \
#	where 1 = 1 \
#	and lsh.header_id = lsl.header_id \
#	and lsl.product_id = lmp.product_id \
#	and lmp.category_id = lmpc.category_id \
#	and lsh.outlet_id = lmo.outlet_id \
#	and lmo.distributor_id = lmd.distributor_id \
#	and lmu.user_id = lsh.last_updated_by \
#	and lmu.status = 'ACTIVE' \
#	AND lsh.status = 'PROCESSED' \
#	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
#	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
#	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
#	and ((lsh.last_update_date at time zone 'IST' between ? and  ? ) or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? \
#	or to_char(lsh.last_update_date at time zone 'IST', 'yyyy-mm-dd') = ? ) 


# sum(lsl.quantity * lsl.list_price)as Amount this is temprary comment, need to used in below querycomment 
getReportDataByDistributor = select lmd.distributor_name, lmd.distributor_crm_code as distributor_code,    \
lmpc.category_name, lmpc.category_code,    \
CASE \
        WHEN lsl.ptr_price LIKE '%*%' THEN 0  \
        WHEN nvl(lsl.ptr_price,'0') LIKE '%''%' THEN 0 \
        WHEN lsl.ptr_price LIKE '%null%' THEN 0 \
        ELSE to_number(nvl((lsl.ptr_price),'0') * nvl((lsl.quantity), 0)) \
    END AS amount \
from lt_so_headers lsh    \
,lt_so_lines lsl    \
,lt_mast_outlets_v lmo    \
,lt_mast_products_v lmp    \
,lt_mast_distributors_v lmd    \
,lt_mast_prod_categories lmpc    \
,lt_mast_users lmu    \
where 1 = 1    \
and lsh.header_id = lsl.header_id    \
and lsl.product_id = lmp.product_id    \
and lmp.category_id = lmpc.category_id    \
and lsh.outlet_id = lmo.outlet_id    \
and lmo.distributor_id = lmd.distributor_id    \
and lmu.user_id = lsh.last_updated_by    \
and lmu.status = 'ACTIVE'    \
AND COALESCE(lmo.org_id ,'-99') = COALESCE(?,COALESCE(lmo.org_id,'-99'))    \
AND COALESCE(lmpc.category_id ,'-99') = COALESCE(?,COALESCE(lmpc.category_id,'-99'))    \
AND COALESCE(lmo.distributor_id ,'-99') = COALESCE(?,COALESCE(lmo.distributor_id,'-99'))    \
and ((lsh.last_update_date between to_date(?,'DD-MON-YY') and to_date(?,'DD-MON-YY')    \
or to_char(lsh.last_update_date,'DD-MON-YY') =  ? \
or to_char(lsh.last_update_date,'DD-MON-YY') = ?)) \

#AND lsh.status = 'PROCESSED'    \
#group by lmd.distributor_name,lmd.distributor_crm_code,lmpc.category_name,lmpc.category_code    

	
getReportDataByDistributorCOPY = select lmd.distributor_id, lmd.distributor_name, lmd.distributor_code, lmd.distributor_crm_code,\
	lmpc.category_name, lmpc.category_code, \
	lsl.ptr_price, lsl.list_price , lsl.quantity, lsl.header_id, lsl.line_id from \
	lt_so_headers lsh , \
	lt_so_lines lsl, \
	lt_mast_outlets_v lmo , \
	lt_mast_products_v lmp, \
	lt_mast_distributors_v lmd, \
	lt_mast_prod_categories lmpc \
	where 1 = 1 \
	and lsh.header_id = lsl.header_id \
	and lsh.outlet_id = lmo.outlet_id \
	and lsl.product_id = lmp.product_id  \
	and lmo.distributor_id = lmd.distributor_id \
	and lmp.category_id = lmpc.category_id \
	AND UPPER(lsh.status) = 'PROCESSED' \
	AND COALESCE(lmo.org_id ,-99) =  COALESCE( ? ,COALESCE(lmo.org_id),-99) \
	AND COALESCE(lmpc.category_id ,-99) =  COALESCE( ? ,COALESCE(lmpc.category_id  ),-99) \
	AND COALESCE(lmo.distributor_id  ,-99) =  COALESCE( ? ,COALESCE(lmo.distributor_id ),-99) \
	and ((lsh.last_update_date between ? and  ? )    or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? \
	or to_char(lsh.last_update_date, 'yyyy-mm-dd') = ? )

#This is original query comment on 3-July-2024 for query fast response	
#getInStockProductAdmin = SELECT B.* FROM (  \
#SELECT ROWNUM RNUM,A.*  \
#FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
#LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#,LMI.QUANTITY AS inventory_quantity, '0' AS PTR_PRICE, '0' AS LIST_PRICE \
#from  \
#LT_MAST_PRODUCTS_V LMP, \
#LT_MAST_PROD_CATEGORIES LMPC, \
#LT_MAST_INVENTORY LMI \
#where  \
#1=1  \
#AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
#AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
#AND UPPER(LMP.STATUS) = 'ACTIVE' \
#AND LMI.QUANTITY <> 0 \
#AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
#AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
#AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE  \
#COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx')) \
#AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY 

##RNUM BETWEEN ?  AND ?


#comment on 31-Aug-2024 for inventQty for single mrp using fun
#getInStockProductAdmin = SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
#    SPI.ROW_ID AS PRODUCT_ID \
#      ,    LMPC.CATEGORY_ID,'1' AS org_id \
#      ,    SPI."TYPE" AS product_type \
#      ,    SPI.ref_number_5 AS "CATEGORY" \
#      ,    SPI.category_cd AS subcategory \
#      ,    SPI.cfg_model_id AS product_code \
#      ,    SPI.x_long_desc AS product_name \
#      ,    SPI.part_num AS product_desc \
#      ,    SPI.reason_txt AS prod_short_desc \
#      ,    SPI.uom_cd AS primary_uom \
#      ,    SPI.x_subbrand AS secondary_uom \
#      ,    SPI.x_sec_uom_value AS secondary_uom_value \
#      ,    SPI.case_pack AS units_per_case \
#      ,    SPI.x_segment AS "SEGMENT" \
#      ,    SPI.x_style AS style \
#      ,    SPI.x_flavor AS flavor \
#      ,    SPI.case_pack AS case_pack \
#      ,    SPI.ref_number_1 AS hsn_code \
#      ,    SPI.orderable_flg AS orderable \
#      ,    'Y' PTR_FLAG \
#      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
#      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#FROM   SIEBEL.S_PROD_INT SPI, \
#       LT_MAST_PROD_CATEGORIES LMPC, \
#       LT_MAST_INVENTORY_V INV \
#WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
#AND   SPI.ROW_ID = INV.PRODUCT_CODE  \
#AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
#AND   INV.QUANTITY <> 0 \
#AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
#AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
#AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
#      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY

getInStockProductAdmin = SELECT SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
FROM   SIEBEL.S_PROD_INT SPI, \
       LT_MAST_PROD_CATEGORIES LMPC \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY


getInstockProductsForSysAdminTemplate = SELECT SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
FROM   SIEBEL.S_PROD_INT SPI, \
       LT_MAST_PROD_CATEGORIES LMPC \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY


#getInStockProductAdmin = SELECT XXATFL_GET_INVENTORY_QTY(INV.DIST_CODE,SPI.ROW_ID) AS INVENTORY_QUANTITY \
#,INV.INVENTORY_CODE \
#      ,    SPI.ROW_ID AS PRODUCT_ID \
#      ,    LMPC.CATEGORY_ID,'1' AS org_id \
#      ,    SPI."TYPE" AS product_type \
#      ,    SPI.ref_number_5 AS "CATEGORY" \
#      ,    SPI.category_cd AS subcategory \
#      ,    SPI.cfg_model_id AS product_code \
#      ,    SPI.x_long_desc AS product_name \
#      ,    SPI.part_num AS product_desc \
#      ,    SPI.reason_txt AS prod_short_desc \
#      ,    SPI.uom_cd AS primary_uom \
#      ,    SPI.x_subbrand AS secondary_uom \
#      ,    SPI.x_sec_uom_value AS secondary_uom_value \
#      ,    SPI.case_pack AS units_per_case \
#      ,    SPI.x_segment AS "SEGMENT" \
#      ,    SPI.x_style AS style \
#      ,    SPI.x_flavor AS flavor \
#      ,    SPI.case_pack AS case_pack \
#      ,    SPI.ref_number_1 AS hsn_code \
#      ,    SPI.orderable_flg AS orderable \
#      ,    'Y' PTR_FLAG \
#      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
#      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#FROM   SIEBEL.S_PROD_INT SPI, \
#       LT_MAST_PROD_CATEGORIES LMPC, \
#       LT_MAST_INVENTORY_V INV \
#WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
#AND   SPI.ROW_ID = INV.PRODUCT_CODE  \
#AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
#AND   INV.QUANTITY <> 0 \
#AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
#AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
#AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
#      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY


#This is original query comment on 3-July-2024 for fast result
#getOutOfStockProductForAdmin = SELECT B.* FROM (  \
#SELECT ROWNUM RNUM,A.*  \
#FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
#LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#,LMI.QUANTITY \
#from  \
#LT_MAST_PRODUCTS_V LMP, \
#LT_MAST_PROD_CATEGORIES LMPC, \
#LT_MAST_INVENTORY LMI \
#where  \
#1=1  \
#AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
#AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
#AND UPPER(LMP.STATUS) = 'ACTIVE' \
#AND LMI.QUANTITY = 0 \
#AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
#AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
#AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE  \
#COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx')) \
#AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY 
##WHERE RNUM BETWEEN ?  AND ?


getOutOfStockProductForAdmin = SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
      ,    SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
FROM   SIEBEL.S_PROD_INT SPI, \
       LT_MAST_PROD_CATEGORIES LMPC, \
       LT_MAST_INVENTORY_V INV \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
AND   SPI.ROW_ID = INV.PRODUCT_CODE  \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   INV.QUANTITY = 0 \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY


getOutOfStockProductsForSysAdminTemplate = SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
      ,    SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
FROM   SIEBEL.S_PROD_INT SPI, \
       LT_MAST_PROD_CATEGORIES LMPC, \
       LT_MAST_INVENTORY_V INV \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
AND   SPI.ROW_ID = INV.PRODUCT_CODE  \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   INV.QUANTITY = 0 \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY


getOutOfStockProductCountForAdmin=  SELECT count(*) FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
,LMI.QUANTITY \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC, \
LT_MAST_INVENTORY LMI \
where  \
1=1  \
AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
AND UPPER(LMP.STATUS) = 'ACTIVE' \
AND LMI.QUANTITY = 0 \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
AND COALESCE (LMP.ORG_ID,'xx') =COALESCE ( ?, COALESCE(LMP.ORG_ID,'xx')) ) A )B 

#getInStockProductCountForAdmin = SELECT count(*) FROM (  \   on 18-April-2024 shubham for count issue
#SELECT ROWNUM RNUM,A.*  \
#FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
#LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#,LMI.QUANTITY \
#from  \
#LT_MAST_PRODUCTS_V LMP, \
#LT_MAST_PROD_CATEGORIES LMPC, \
#LT_MAST_INVENTORY LMI \
#where  \
#1=1  \
#AND LMP.CATEGORY_ID = LMPC.CATEGORY_ID \
#AND LMP.PRODUCT_CODE = LMI.PRODUCT_CODE \
#AND UPPER(LMP.STATUS) = 'ACTIVE' \
#AND LMI.QUANTITY <> 0 \
#AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
#AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
#AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
#COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
#AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) ) A )B


#Comment on 4-july-2024 for fast result
#getInStockProductCountForAdmin =SELECT count(*) FROM (  \
#SELECT ROWNUM RNUM,A.*  \
#FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG, \
#LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS  \
#from  \
#LT_MAST_PRODUCTS_V LMP, \
#LT_MAST_PROD_CATEGORIES LMPC \
#WHERE  LMP.CATEGORY_ID = LMPC.CATEGORY_ID  \
#AND UPPER(LMP.STATUS) = 'ACTIVE'  \
#AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
#AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
#AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
#COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
#AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (? , COALESCE(LMP.ORG_ID,'xx')) ) A )B


getInStockProductCountForAdmin = SELECT count(*) FROM (  \
SELECT ROWNUM RNUM,A.*  \
FROM (SELECT DISTINCT LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
LMP."SEGMENT",LMP.BRAND,LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG, \
LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS  \
from  \
LT_MAST_PRODUCTS_V LMP, \
LT_MAST_PROD_CATEGORIES LMPC \
WHERE  LMP.CATEGORY_ID = LMPC.CATEGORY_ID  \
AND UPPER(LMP.STATUS) = 'ACTIVE'  \
AND COALESCE(LMP.PRODUCT_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.PRODUCT_ID,'xx')) \
AND COALESCE(LMP.CATEGORY_ID ,'xx') =  COALESCE( ? ,COALESCE(LMP.CATEGORY_ID,'xx')) \
AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE),'xx')) \
) A )B

#getInStockProductCountForAdmin = SELECT count(*) FROM ( \
#SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
#      ,    SPI.ROW_ID AS PRODUCT_ID \
#      ,    LMPC.CATEGORY_ID,'1' AS org_id \
#      ,    SPI."TYPE" AS product_type \
#      ,    SPI.ref_number_5 AS "CATEGORY" \
#      ,    SPI.category_cd AS subcategory \
#      ,    SPI.cfg_model_id AS product_code \
#      ,    SPI.x_long_desc AS product_name \
#      ,    SPI.part_num AS product_desc \
#      ,    SPI.reason_txt AS prod_short_desc \
#      ,    SPI.uom_cd AS primary_uom \
#      ,    SPI.x_subbrand AS secondary_uom \
#      ,    SPI.x_sec_uom_value AS secondary_uom_value \
#      ,    SPI.case_pack AS units_per_case \
#      ,    SPI.x_segment AS "SEGMENT" \
#      ,    SPI.x_style AS style \
#      ,    SPI.x_flavor AS flavor \
#      ,    SPI.case_pack AS case_pack \
#      ,    SPI.ref_number_1 AS hsn_code \
#      ,    SPI.orderable_flg AS orderable \
#      ,    'Y' PTR_FLAG \
#      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
#      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#FROM   SIEBEL.S_PROD_INT SPI, \
#       LT_MAST_PROD_CATEGORIES LMPC, \
#       LT_MAST_INVENTORY_V INV \
#WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
#AND   SPI.ROW_ID = INV.PRODUCT_CODE  \
#AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
#AND   INV.QUANTITY <> 0 \
#AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
#AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
#AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
#      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')))


#getInStockProductWithInventory =SELECT B.* FROM \          vaibhav& shubham 18-Mar-2024 queryOptimize
#(select a.*,ROWNUM RNUM from(  \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#    LMPL.PRICE_LIST, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from \
#		lt_mast_products_v lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
#		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#		LEFT JOIN INV_LOCATION_NAME ILN ON  ILN.DISTRIBUTOR_ID = lmd.distributor_id \
#		where 1=1 \
#		AND UPPER(LMP.STATUS) = 'ACTIVE' \
#        AND INV.QUANTITY <> 0 \
#		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
#		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
#		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC),'xx') LIKE \
#		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC),'xx')) \
#		and lmo.outlet_id = ?  \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
#	) A )B \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY 


# original query commen to 1-July-2024 for query optimization
#getInStockProductWithInventory = SELECT B.* FROM \
#(select a.*,ROWNUM RNUM from(  \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#    LMPL.PRICE_LIST, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from \
#		lt_mast_products_v lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
#		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#		where 1=1 \
#		AND UPPER(LMP.STATUS) = 'ACTIVE' \
#        AND INV.QUANTITY <> 0 \
#		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE ( ? , COALESCE(LMP.ORG_ID,'xx')) \
#		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
#		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE \
#		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx')) \
#	and lmo.outlet_id = ?  \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
#	) A )B \
#OFFSET ? ROWS \
#FETCH NEXT ? ROWS ONLY


#comment on 31-Aug-2024 for get inventQty for sigle mrp using fun 
#getInStockProductWithInventory = SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
#      ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
#      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
#      ,    SPI."TYPE" AS product_type \
#      ,    SPI.ref_number_5 AS "CATEGORY" \
#      ,    SPI.category_cd AS subcategory \
#      ,    SPI.cfg_model_id AS product_code \
#      ,    SPI.x_long_desc AS product_name \
#      ,    SPI.part_num AS product_desc \
#      ,    SPI.reason_txt AS prod_short_desc \
#      ,    SPI.uom_cd AS primary_uom \
#      ,    SPI.x_subbrand AS secondary_uom \
#      ,    SPI.x_sec_uom_value AS secondary_uom_value \
#      ,    SPI.case_pack AS units_per_case \
#      ,    SPI.x_segment AS "SEGMENT" \
#      ,    SPI.x_style AS style \
#      ,    SPI.x_flavor AS flavor \
#      ,    SPI.case_pack AS case_pack \
#      ,    SPI.ref_number_1 AS hsn_code \
#      ,    SPI.orderable_flg AS orderable \
#      ,    'Y' PTR_FLAG \
#      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
#      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#      ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE \
#FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
#       LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
#      ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
#WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+)) \
#AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
#AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
#AND   lmpl.price_list = lmo.price_list \
#AND   lmo.OUTLET_ID = SOE1.ROW_ID \
#AND   SOE1.BU_ID = SOE2.ROW_ID  \
#AND   SPI.ROW_ID = INV.PRODUCT_CODE \
#AND   SOE2.ROW_ID = INV.DIST_CODE   \
#AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
#AND   INV.QUANTITY <> 0 \
#AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
#AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
#AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
#      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
#AND   SOE1.ROW_ID = ?  \
#ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC, SPI.ROW_ID ASC \
#OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


getInStockProductWithInventory = SELECT XXATFL_GET_INVENTORY_QTY(SOE2.ROW_ID,SPI.ROW_ID) AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
      ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
      ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE \
FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
       LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
      ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+)) \
AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
AND   lmpl.price_list = lmo.price_list \
AND   lmo.OUTLET_ID = SOE1.ROW_ID \
AND   SOE1.BU_ID = SOE2.ROW_ID  \
AND   SPI.ROW_ID = INV.PRODUCT_CODE \
AND   SOE2.ROW_ID = INV.DIST_CODE   \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   INV.QUANTITY <> 0 \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
AND   SOE1.ROW_ID = ?  \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC, SPI.ROW_ID ASC \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY



# Comment on 3-july-2024 for query fast result
#getInStockProductCountWithInventory =SELECT count(*) FROM \
#(select a.*,ROWNUM RNUM from(  \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#    LMPL.PRICE_LIST, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from \
#		lt_mast_products_v lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
#		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#		LEFT JOIN INV_LOCATION_NAME ILN ON  ILN.DISTRIBUTOR_ID = lmd.distributor_id \
#		where 1=1 \
#		AND UPPER(LMP.STATUS) = 'ACTIVE' \
#        AND INV.QUANTITY <> 0 \
#		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
#		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
#		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
#		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
#		and lmo.outlet_id = ?  \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
#	) A )B


getInStockProductCountWithInventory = SELECT COUNT(*) FROM( \
SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
      ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
      ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE \
FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
       LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
      ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+))  \
AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
AND   lmpl.price_list = lmo.price_list \
AND   lmo.OUTLET_ID = SOE1.ROW_ID \
AND   SOE1.BU_ID = SOE2.ROW_ID  \
AND   SPI.ROW_ID = INV.PRODUCT_CODE \
AND   SOE2.ROW_ID = INV.DIST_CODE   \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   INV.QUANTITY <> 0 \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
AND   SOE1.ROW_ID = ?  \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC)

	
getOutOfStockProductWithInventory =  SELECT B.* FROM \
(select a.*,ROWNUM RNUM from(  \
		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC, LMP.PROD_SHORT_DESC ,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE,LMP.PTR_FLAG, \
    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMP.STATUS, \
    LMPL.PRICE_LIST, \
		 lmpl.list_price, lmpl.currency , lmpl.ptr_price, \
		 lmp.PRODUCT_IMAGE   AS PRODUCT_IMAGE, \
         lmp.PRODUCT_IMAGE AS THUMBNAIL_IMAGE \
	from \
		lt_mast_products_v lmp \
		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
		where 1=1 \
		AND INV.QUANTITY = 0 \
		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx') LIKE \
		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE || LMP.PROD_SHORT_DESC || LMP.PRODUCT_DESC),'xx')) \
		and lmo.outlet_id = ?  \
		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
	) A )B \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY 
##WHERE RNUM BETWEEN ? AND ?

#getOutOfStockProductWithInventory = SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
#      ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
#      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
#      ,    SPI."TYPE" AS product_type \
#      ,    SPI.ref_number_5 AS "CATEGORY" \
#      ,    SPI.category_cd AS subcategory \
#      ,    SPI.cfg_model_id AS product_code \
#      ,    SPI.x_long_desc AS product_name \
#      ,    SPI.part_num AS product_desc \
#      ,    SPI.reason_txt AS prod_short_desc \
#      ,    SPI.uom_cd AS primary_uom \
#      ,    SPI.x_subbrand AS secondary_uom \
#      ,    SPI.x_sec_uom_value AS secondary_uom_value \
#      ,    SPI.case_pack AS units_per_case \
#      ,    SPI.x_segment AS "SEGMENT" \
#      ,    SPI.x_style AS style \
#      ,    SPI.x_flavor AS flavor \ 
#      ,    SPI.case_pack AS case_pack \
#      ,    SPI.ref_number_1 AS hsn_code \
#      ,    SPI.orderable_flg AS orderable \
#      ,    'Y' PTR_FLAG \
#      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
#      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
#      ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE \
#FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
#       LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
#      ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
#WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+)) \
#AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
#AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
#AND   lmpl.price_list = lmo.price_list \
#AND   lmo.OUTLET_ID = SOE1.ROW_ID \
#AND   SOE1.BU_ID = SOE2.ROW_ID  \
#AND   SPI.ROW_ID = INV.PRODUCT_CODE \
#AND   SOE2.ROW_ID = INV.DIST_CODE   \
#AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
#AND   INV.QUANTITY = 0 \
#AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
#AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
#AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
#      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
#AND   lmo.OUTLET_ID = ?  \
#ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
#OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


# Comment on 3-july-24 for query fast result	
#getOutOfStockProductCountWithInventory = SELECT count(*) FROM \
#(select a.*,ROWNUM RNUM from(  \
#		 select inv.quantity as inventory_quantity, inv.inventory_code, lmo.outlet_id, \
#		 LMP.PRODUCT_ID,LMP.CATEGORY_ID,LMP.ORG_ID,LMP.SUB_CATEGORY_ID,LMP.PRODUCT_TYPE,LMP."CATEGORY",LMP.SUBCATEGORY, \
#		 LMP.PRODUCT_CODE,LMP.PRODUCT_NAME,LMP.PRODUCT_DESC,LMP.PRIMARY_UOM,LMP.SECONDARY_UOM,LMP.SECONDARY_UOM_VALUE,LMP.UNITS_PER_CASE, \
#    LMP."SEGMENT",LMP."STYLE",LMP.FLAVOR,LMP.CASE_PACK,LMP.HSN_CODE,LMP.ORDERABLE, LMP.PTR_FLAG,\
#    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE,LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS, \
#    LMPL.PRICE_LIST, \
#		 lmpl.list_price, lmpl.currency , lmpl.ptr_price \
#	from \
#		lt_mast_products_v lmp \
#		inner join lt_mast_prod_categories lmpc on lmp.category_id = lmpc.category_id \
#		left join lt_mast_price_lists_v lmpl on lmp.product_code = lmpl.product_code  \
#		left join lt_mast_outlets_v lmo on lmpl.price_list = lmo.price_list \
#		left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
#		left join lt_mast_inventory_v inv on lmp.product_code = inv.product_code and lmd.distributor_code = inv.dist_code \
#		where 1=1 \
#		AND UPPER(LMP.STATUS) = 'ACTIVE' \
#        AND INV.QUANTITY = 0 \
#		AND COALESCE (LMP.ORG_ID,'xx') =COALESCE (?, COALESCE(LMP.ORG_ID,'xx')) \
#		AND COALESCE(LMP.PRODUCT_ID,'xx') = COALESCE( ? , COALESCE(LMP.PRODUCT_ID,'xx'))  \
#		AND COALESCE(lmpc.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(lmpc.CATEGORY_ID,'xx'))  \
#		AND COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx') LIKE \
#		COALESCE( ? ,COALESCE(UPPER(LMP.PRODUCT_NAME || LMP.PRODUCT_CODE || LMPL.LIST_PRICE),'xx')) \
#		and lmo.outlet_id = ?  \
#		ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC \
#	) A )B
	

getOutOfStockProductCountWithInventory = SELECT COUNT(*) FROM( \
 SELECT INV.QUANTITY AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
       ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
       ,    SPI."TYPE" AS product_type \
       ,    SPI.ref_number_5 AS "CATEGORY" \
       ,    SPI.category_cd AS subcategory \
       ,    SPI.cfg_model_id AS product_code \
       ,    SPI.x_long_desc AS product_name \
       ,    SPI.part_num AS product_desc \
       ,    SPI.reason_txt AS prod_short_desc \
       ,    SPI.uom_cd AS primary_uom \
       ,    SPI.x_subbrand AS secondary_uom \
       ,    SPI.x_sec_uom_value AS secondary_uom_value \
       ,    SPI.case_pack AS units_per_case \
       ,    SPI.x_segment AS "SEGMENT" \
       ,    SPI.x_style AS style \
       ,    SPI.x_flavor AS flavor \
       ,    SPI.case_pack AS case_pack \
       ,    SPI.ref_number_1 AS hsn_code \
       ,    SPI.orderable_flg AS orderable \
       ,    'Y' PTR_FLAG \
       ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
       ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
       ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE \
 FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
        LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
       ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
 WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+)) \
 AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
 AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
 AND   lmpl.price_list = lmo.price_list \
 AND   lmo.OUTLET_ID = SOE1.ROW_ID \
 AND   SOE1.BU_ID = SOE2.ROW_ID  \
 AND   SPI.ROW_ID = INV.PRODUCT_CODE \
 AND   SOE2.ROW_ID = INV.DIST_CODE   \
 AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
 AND   INV.QUANTITY = 0 \
 AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
 AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
 AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
       COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
 AND   SOE1.ROW_ID = ?  \
 ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC)

	
#getMultipleMrpForProduct = SELECT DISTINCT SOE2.NAME DISTRIBUTOR_NAME,SOE2.ROW_ID DISTRIBUTOR_CODE, \
#       SOE1.NAME OUTLET_NAME,SOE1.ROW_ID AS OUTLET_CODE,SI.ROW_ID INVENTORY_CODE \
#       ,SI.NAME AS INVENTORY_NAME, spt.name AS PRODUCT_NAME \
#       ,SPLI.STD_PRI_UNIT \
#FROM  SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_INVLOC SI \
#     ,SIEBEL.S_PROD_INVLOC SPIL,SIEBEL.S_PROD_INV SPIV,SIEBEL.S_PROD_INV_CAT SPIC,SIEBEL.S_PROD_INT SPT \
#     ,SIEBEL.S_PRI_LST_ITEM SPLI \
#WHERE SOE2.ROW_ID = ? \
#AND SOE1.ROW_ID = ? \
#AND SI.ACTIVE_FLG = 'Y' \
#AND spt.row_id = ? \
#AND SOE1.BU_ID = SOE2.ROW_ID \
#AND SOE2.ROW_ID = SI.BU_ID \
#AND SI.ROW_ID = SPIL.INVLOC_ID \
#AND SPIV.PROD_INVLOC_ID = SPIL.ROW_ID \
#AND SPIV.PROD_INV_CAT_ID = SPIC.ROW_ID \
#AND SPT.ROW_ID = SPIL.PROD_ID \
#AND SPLI.PROD_NAME   = SPT.NAME \
#AND SI.X_INVLOC_CODE = 'Primary' \
#AND SPIC.AVAIL_CD = 'On Hand' \
#and SPLI.EFF_END_DT is null
	


getTlForProductDescription = SELECT DISTINCT SPR.NAME PRICE_LIST,SAG.ADJ_GROUP_NAME,SPI.NAME PRODUCT_NAME,SSP.PRI_ADJ_TYPE_CD,SSP.ADJ_VAL_AMT,spi.row_id AS PRODUCT_ID \
FROM siebel.s_stdprod_pmtrx ssp,siebel.S_ADJ_GROUP sag,siebel.s_pri_lst spr,siebel.s_prod_int spi \
where spr.name = ? \
and spr.X_DMATRIX2_NAME = sag.ADJ_GROUP_NAME \
and sag.row_id = ssp.ADJ_GROUP_ID \
AND SSP.EFF_END_DT IS NULL \
AND SSP.PROD_ID = SPI.ROW_ID \
and spi.row_id = ?

	
getEtlForProductDescription= SELECT DISTINCT SPR.NAME PRICE_LIST,SAG.ADJ_GROUP_NAME,SPI.NAME PRODUCT_NAME, \
SSP.PRI_ADJ_TYPE_CD,SSP.ADJ_VAL_AMT,spi.row_id AS PRODUCT_ID \
FROM siebel.s_stdprod_pmtrx ssp,siebel.S_ADJ_GROUP sag,siebel.s_pri_lst spr,siebel.s_prod_int spi \
where spr.name = ? \
and spr.X_DMATRIX3_NAME = sag.ADJ_GROUP_NAME \
and sag.row_id = ssp.ADJ_GROUP_ID \
AND SSP.EFF_END_DT IS NULL \
AND SSP.PROD_ID = SPI.ROW_ID \
and spi.row_id = ?
	
offset_value = 10	


# this is original query comment on 03-June-2024 for add mrp in prodList & optimization
#getMultipleMrpForProduct = SELECT distinct \
#       SPLI.STD_PRI_UNIT AS MRP \
#FROM SIEBEL.S_ORG_EXT      SOE1, \
#       SIEBEL.S_ORG_EXT      SOE2, \
#       SIEBEL.S_INVLOC       SI, \
#       siebel.s_prod_invloc  spil, \
#       SIEBEL.S_PROD_INV     SPIV, \
#       SIEBEL.S_PROD_INV_CAT SPIC \
#      ,SIEBEL.S_PROD_INT     SP \
#      ,SIEBEL.S_PRI_LST_ITEM SPLI \
#      ,SIEBEL.S_PRI_LST      SPL \
#WHERE   SOE2.ROW_ID = ? \
#       AND SOE1.ROW_ID = ? \
#       AND si.X_INVLOC_CODE = 'Primary' \
#       AND SI.ACTIVE_FLG = 'Y' \
#       AND SP.ROW_ID = ? \
#       AND SPL.NAME = ? \
#       AND spiv.prod_invloc_id = spil.row_id \
#       AND SOE1.BU_ID = SOE2.ROW_ID \
#       AND SOE2.ROW_ID = SI.BU_ID \
#       AND SI.ROW_ID = SPIL.INVLOC_ID \
#       AND SPIV.PROD_INVLOC_ID = SPIL.ROW_ID \
#       AND SPIV.PROD_INV_CAT_ID = SPIC.ROW_ID \
#       and spil.PROD_ID = SP.row_id \
#       AND SPLI.PROD_ID = SP.ROW_ID \
#       AND SPLI.PRI_LST_ID = SPL.ROW_ID \
#       AND SPIC.STATUS_CD = 'Good' \
#       and spic.avail_Cd = 'On Hand'

getMultipleMrpForProduct = SELECT distinct SP.ROW_ID as product_Id, \
       SPLI.STD_PRI_UNIT AS MRP \
FROM SIEBEL.S_ORG_EXT      SOE1, \
       SIEBEL.S_ORG_EXT      SOE2, \
       SIEBEL.S_INVLOC       SI, \
       siebel.s_prod_invloc  spil, \
       SIEBEL.S_PROD_INV     SPIV, \
       SIEBEL.S_PROD_INV_CAT SPIC \
      ,SIEBEL.S_PROD_INT     SP \
      ,SIEBEL.S_PRI_LST_ITEM SPLI \
      ,SIEBEL.S_PRI_LST      SPL \
WHERE   SOE2.ROW_ID = ? \
       AND COALESCE(SOE1.ROW_ID, 'xx') = COALESCE(?, COALESCE(SOE1.ROW_ID, 'xx')) \
       AND si.X_INVLOC_CODE = 'Primary' \
       AND SI.ACTIVE_FLG = 'Y' \
       AND COALESCE(SP.ROW_ID, 'xx') = COALESCE(?, COALESCE(SP.ROW_ID, 'xx'))   \
       AND COALESCE(SPL.NAME, 'xx') = COALESCE(?, COALESCE(SPL.NAME, 'xx')) \
       AND spiv.prod_invloc_id = spil.row_id \
       AND SOE1.BU_ID = SOE2.ROW_ID \
       AND SOE2.ROW_ID = SI.BU_ID \
       AND SI.ROW_ID = SPIL.INVLOC_ID \
       AND SPIV.PROD_INVLOC_ID = SPIL.ROW_ID \
       AND SPIV.PROD_INV_CAT_ID = SPIC.ROW_ID \
       AND SPLI.PROD_ID = SP.ROW_ID \
       AND SPLI.PRI_LST_ID = SPL.ROW_ID \
       AND SPIC.STATUS_CD = 'Good' \
       and spic.avail_Cd = 'On Hand' \
       AND SPLI.STD_PRI_UNIT IS NOT NULL


getSearchDistributorForSysAdmin = select a.* \
from ( select distinct(lmd.distributor_id), lmd.distributor_id dist_id, lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code from lt_mast_distributors_v lmd,lt_mast_outlets_v lmo  \
where 1=1  \
and lmd.distributor_id = lmo.distributor_id  \
and upper(lmd.status) = 'ACTIVE'  \
and lmd.org_id = ? \
and COALESCE(lmo.region ,'xx') =  COALESCE( ? ,COALESCE(lmo.region, 'xx'))  \
and COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx') like \
COALESCE( ? ,COALESCE(CONCAT(lmd.distributor_name , lmd.distributor_crm_code),'xx')) \
order by distributor_id asc ) a \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

getProductListFromProcedure = SELECT * FROM LT_PRODUCT_DATA_GT
 
getMultipleMrpFromProcedure = SELECT * FROM LT_MULTIPLE_MRP_PRODUCT_GT

getProductCountFromProcedure = select * from LT_PRODUCT_DATA_CNT

getInStockProductForAreaHead = SELECT INV.QUANTITY AS INVENTORY_QUANTITY \
       ,INV.INVENTORY_CODE \
      ,    SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID \
      ,    '1' AS org_id \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc  \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1 \
      ,    LMPC.ORG_ID ORG_ID1 \
      ,    LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME \
      ,    LMPC.CATEGORY_DESC \
      ,    LMPC.STATUS \
    FROM   SIEBEL.S_PROD_INT SPI, \
           LT_MAST_PROD_CATEGORIES LMPC, \
           LT_MAST_INVENTORY_V INV \
    WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME)  \
    AND   SPI.ROW_ID = INV.PRODUCT_CODE \
    AND   INV.QUANTITY = (select Max(QUANTITY) from LT_MAST_INVENTORY_V where PRODUCT_CODE = INV.PRODUCT_CODE) \
    AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
    AND   INV.QUANTITY <> 0 \
    AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
    AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
    AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || SPI.PART_NUM || SPI.REASON_TXT),'xx') LIKE \
          COALESCE( UPPER(?) ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID|| SPI.part_num || SPI.REASON_TXT),'xx')) \
OFFSET ? ROWS \
FETCH NEXT ? ROWS ONLY	


getMultipleMrpForProductV1-5-Aug-24 = select \
      distinct \
      T20.PROD_ID AS product_id, \
      T20.X_LOT_GRADE AS MRP, \
      sum(t20.qty) AS inventory_quantity \
   FROM \
       SIEBEL.S_PROD_INT T1, \
       SIEBEL.S_VOD T2, \
       SIEBEL.S_PROD_LN T3, \
       SIEBEL.S_ASSET_OM T4, \
       SIEBEL.S_ISS_OBJ_DEF T5, \
       SIEBEL.S_PARTY T6, \
       SIEBEL.S_VOD_VER T7,\
       SIEBEL.S_ASSET_BU T8,\
       SIEBEL.S_CTLG_CAT T9,\
       SIEBEL.S_PARTY T10,\
       SIEBEL.S_PROD_INT T11,\
       SIEBEL.S_CTLG_CAT T12,\
       SIEBEL.S_ORG_EXT T13, \
       SIEBEL.S_ASSET_OM T14,\
       SIEBEL.S_ASSET T15,\
       SIEBEL.S_DOC_AGREE T16,\
       SIEBEL.S_ORG_EXT T17,\
       SIEBEL.S_PROD_INV_CAT T18,\
       SIEBEL.S_PROD_INV T19,\
       SIEBEL.S_ASSET T20 \
   WHERE \
      T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 \
      AND \
      T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
      T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
      T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
      T20.PROD_ID = T11.ROW_ID AND \
      T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
      T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
      T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
      T2.ROW_ID = T7.VOD_ID AND \
      T15.PROD_ID = T1.ROW_ID (+) AND \
      T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
      T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
      T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
      T20.PROD_INV_ID = T19.ROW_ID (+) AND \
      T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
      T20.PR_CON_ID = T10.ROW_ID (+) AND \
      T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
      T8.BU_ID = T6.ROW_ID (+) AND \
      T8.BU_ID = T13.PAR_ROW_ID (+) AND \
      ((T7.VER_NUM = 1) AND \
      (T20.PROD_ID = ? AND T20.INVLOC_ID in (select SPIL.INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id = ? \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
      (T20.PROD_ID = ? AND T20.INVLOC_ID in (select SPIL.INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id = ? \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID) AND T20.QTY > 0) \
      GROUP BY t20.X_LOT_GRADE,T20.PROD_ID    


getMultipleMrpForOutofStockProductV1-5-Aug-24 = select \
      distinct \
      T20.PROD_ID AS product_id, \
      T20.X_LOT_GRADE AS MRP, \
      sum(t20.qty) AS inventory_quantity \
   FROM \
       SIEBEL.S_PROD_INT T1, \
       SIEBEL.S_VOD T2, \
       SIEBEL.S_PROD_LN T3, \
       SIEBEL.S_ASSET_OM T4, \
       SIEBEL.S_ISS_OBJ_DEF T5, \
       SIEBEL.S_PARTY T6, \
       SIEBEL.S_VOD_VER T7,\
       SIEBEL.S_ASSET_BU T8,\
       SIEBEL.S_CTLG_CAT T9,\
       SIEBEL.S_PARTY T10,\
       SIEBEL.S_PROD_INT T11,\
       SIEBEL.S_CTLG_CAT T12,\
       SIEBEL.S_ORG_EXT T13, \
       SIEBEL.S_ASSET_OM T14,\
       SIEBEL.S_ASSET T15,\
       SIEBEL.S_DOC_AGREE T16,\
       SIEBEL.S_ORG_EXT T17,\
       SIEBEL.S_PROD_INV_CAT T18,\
       SIEBEL.S_PROD_INV T19,\
       SIEBEL.S_ASSET T20 \
   WHERE \
      T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 \
      AND \
      T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
      T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
      T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
      T20.PROD_ID = T11.ROW_ID AND \
      T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
      T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
      T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
      T2.ROW_ID = T7.VOD_ID AND \
      T15.PROD_ID = T1.ROW_ID (+) AND \
      T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
      T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
      T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
      T20.PROD_INV_ID = T19.ROW_ID (+) AND \
      T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
      T20.PR_CON_ID = T10.ROW_ID (+) AND \
      T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
      T8.BU_ID = T6.ROW_ID (+) AND \
      T8.BU_ID = T13.PAR_ROW_ID (+) AND \
      ((T7.VER_NUM = 1) AND \
      (T20.PROD_ID = ? AND T20.INVLOC_ID in (select SPIL.INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id = ? \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
      (T20.PROD_ID = ? AND T20.INVLOC_ID in (select SPIL.INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id = ? \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID) AND T20.QTY = 0) \
      GROUP BY t20.X_LOT_GRADE,T20.PROD_ID 
      
      
      
getMultipleMrpForProductV1 = select DISTINCT \
T20.PROD_ID AS product_id, \
T20.X_LOT_GRADE AS MRP, \
sum(t20.qty) AS Inventory_Quantity, \
NVL((select MAX(case_pack) from SIEBEL.S_PROD_INT where ROW_ID = T20.PROD_ID),0) AS units_Per_Case \
FROM \
SIEBEL.S_PROD_INT T1, \
SIEBEL.S_VOD T2, \
SIEBEL.S_PROD_LN T3, \
SIEBEL.S_ASSET_OM T4, \
SIEBEL.S_ISS_OBJ_DEF T5, \
SIEBEL.S_PARTY T6, \
SIEBEL.S_VOD_VER T7, \
SIEBEL.S_ASSET_BU T8, \
SIEBEL.S_CTLG_CAT T9, \
SIEBEL.S_PARTY T10, \
SIEBEL.S_PROD_INT T11, \
SIEBEL.S_CTLG_CAT T12, \
SIEBEL.S_ORG_EXT T13, \
SIEBEL.S_ASSET_OM T14, \
SIEBEL.S_ASSET T15, \
SIEBEL.S_DOC_AGREE T16, \
SIEBEL.S_ORG_EXT T17, \
SIEBEL.S_PROD_INV_CAT T18, \
SIEBEL.S_PROD_INV T19, \
SIEBEL.S_ASSET T20 \
WHERE \
T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 AND \
T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
T20.PROD_ID = T11.ROW_ID AND \
T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
T2.ROW_ID = T7.VOD_ID AND \
T15.PROD_ID = T1.ROW_ID (+) AND \
T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
T20.PROD_INV_ID = T19.ROW_ID (+) AND \
T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
T20.PR_CON_ID = T10.ROW_ID (+) AND \
T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
T8.BU_ID = T6.ROW_ID (+) AND \
T8.BU_ID = T13.PAR_ROW_ID (+) AND \
((T7.VER_NUM = 1) AND \
(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id IN (?) \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id IN (?) \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID) AND T20.QTY > 0) \
GROUP BY t20.X_LOT_GRADE,T20.PROD_ID
      

#getMultipleMrpForProductV1 = select DISTINCT \
#T20.PROD_ID AS product_id, \
#T20.X_LOT_GRADE AS MRP, \
#XXATFL_GET_INVENTORY_QTY(T20.bu_id,T20.PROD_ID) AS Inventory_Quantity, \
#NVL((select MAX(case_pack) from SIEBEL.S_PROD_INT where ROW_ID = T20.PROD_ID),0) AS units_Per_Case \
#FROM \
#SIEBEL.S_PROD_INT T1, \
#SIEBEL.S_VOD T2, \
#SIEBEL.S_PROD_LN T3, \
#SIEBEL.S_ASSET_OM T4, \
#SIEBEL.S_ISS_OBJ_DEF T5, \
#SIEBEL.S_PARTY T6, \
#SIEBEL.S_VOD_VER T7, \
#SIEBEL.S_ASSET_BU T8, \
#SIEBEL.S_CTLG_CAT T9, \
#SIEBEL.S_PARTY T10, \
#SIEBEL.S_PROD_INT T11, \
#SIEBEL.S_CTLG_CAT T12, \
#SIEBEL.S_ORG_EXT T13, \
#SIEBEL.S_ASSET_OM T14, \
#SIEBEL.S_ASSET T15, \
#SIEBEL.S_DOC_AGREE T16, \
#SIEBEL.S_ORG_EXT T17, \
#SIEBEL.S_PROD_INV_CAT T18, \
#SIEBEL.S_PROD_INV T19, \
#SIEBEL.S_ASSET T20 \
#WHERE \
#T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 AND \
#T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
#T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
#T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
#T20.PROD_ID = T11.ROW_ID AND \
#T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
#T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
#T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
#T2.ROW_ID = T7.VOD_ID AND \
#T15.PROD_ID = T1.ROW_ID (+) AND \
#T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
#T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
#T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
#T20.PROD_INV_ID = T19.ROW_ID (+) AND \
#T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
#T20.PR_CON_ID = T10.ROW_ID (+) AND \
#T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
#T8.BU_ID = T6.ROW_ID (+) AND \
#T8.BU_ID = T13.PAR_ROW_ID (+) AND \
#((T7.VER_NUM = 1) AND \
#(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
#FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
#WHERE SOE.ROW_ID = ? \
#AND SI.ACTIVE_FLG = 'Y' \
#AND spil.prod_id IN (?) \
#AND SOE.ROW_ID = SI.BU_ID \
#AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
#(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
#FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
#WHERE SOE.ROW_ID = ? \
#AND SI.ACTIVE_FLG = 'Y' \
#AND spil.prod_id IN (?) \
#AND SOE.ROW_ID = SI.BU_ID \
#AND SI.ROW_ID = SPIL.INVLOC_ID) \
#AND XXATFL_GET_INVENTORY_QTY(T20.bu_id,T20.PROD_ID) > 0) 



#getMultipleMrpForOutofStockProductV1 = select DISTINCT \
#T20.PROD_ID AS product_id, \
#T20.X_LOT_GRADE AS MRP, \
#sum(t20.qty) AS Inventory_Quantity, \
#NVL((select MAX(case_pack) from SIEBEL.S_PROD_INT where ROW_ID = T20.PROD_ID),0) AS units_Per_Case \
#FROM \
#SIEBEL.S_PROD_INT T1, \
#SIEBEL.S_VOD T2, \
#SIEBEL.S_PROD_LN T3, \
#SIEBEL.S_ASSET_OM T4, \
#SIEBEL.S_ISS_OBJ_DEF T5, \
#SIEBEL.S_PARTY T6, \
#SIEBEL.S_VOD_VER T7, \
#SIEBEL.S_ASSET_BU T8, \
#SIEBEL.S_CTLG_CAT T9, \
#SIEBEL.S_PARTY T10, \
#SIEBEL.S_PROD_INT T11, \
#SIEBEL.S_CTLG_CAT T12, \
#SIEBEL.S_ORG_EXT T13, \
#SIEBEL.S_ASSET_OM T14, \
#SIEBEL.S_ASSET T15, \
#SIEBEL.S_DOC_AGREE T16, \
#SIEBEL.S_ORG_EXT T17, \
#SIEBEL.S_PROD_INV_CAT T18, \
#SIEBEL.S_PROD_INV T19, \
#SIEBEL.S_ASSET T20 \
#WHERE \
#T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 AND \
#T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
#T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
#T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
#T20.PROD_ID = T11.ROW_ID AND \
#T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
#T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
#T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
#T2.ROW_ID = T7.VOD_ID AND \
#T15.PROD_ID = T1.ROW_ID (+) AND \
#T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
#T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
#T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
#T20.PROD_INV_ID = T19.ROW_ID (+) AND \
#T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
#T20.PR_CON_ID = T10.ROW_ID (+) AND \
#T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
#T8.BU_ID = T6.ROW_ID (+) AND \
#T8.BU_ID = T13.PAR_ROW_ID (+) AND \
#((T7.VER_NUM = 1) AND \
#(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
#FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
#WHERE SOE.ROW_ID = ? \
#AND SI.ACTIVE_FLG = 'Y' \
#AND spil.prod_id IN (?) \
#AND SOE.ROW_ID = SI.BU_ID \
#AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
#(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
#FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
#WHERE SOE.ROW_ID = ? \
#AND SI.ACTIVE_FLG = 'Y' \
#AND spil.prod_id IN (?) \
#AND SOE.ROW_ID = SI.BU_ID \
#AND SI.ROW_ID = SPIL.INVLOC_ID) AND T20.QTY = 0) \
#GROUP BY t20.X_LOT_GRADE,T20.PROD_ID


getMultipleMrpForOutofStockProductV1 = select DISTINCT \
T20.PROD_ID AS product_id, \
T20.X_LOT_GRADE AS MRP, \
XXATFL_GET_INVENTORY_QTY(T20.bu_id,T20.PROD_ID) AS Inventory_Quantity, \
NVL((select MAX(case_pack) from SIEBEL.S_PROD_INT where ROW_ID = T20.PROD_ID),0) AS units_Per_Case \
FROM \
SIEBEL.S_PROD_INT T1, \
SIEBEL.S_VOD T2, \
SIEBEL.S_PROD_LN T3, \
SIEBEL.S_ASSET_OM T4, \
SIEBEL.S_ISS_OBJ_DEF T5, \
SIEBEL.S_PARTY T6, \
SIEBEL.S_VOD_VER T7, \
SIEBEL.S_ASSET_BU T8, \
SIEBEL.S_CTLG_CAT T9, \
SIEBEL.S_PARTY T10, \
SIEBEL.S_PROD_INT T11, \
SIEBEL.S_CTLG_CAT T12, \
SIEBEL.S_ORG_EXT T13, \
SIEBEL.S_ASSET_OM T14, \
SIEBEL.S_ASSET T15, \
SIEBEL.S_DOC_AGREE T16, \
SIEBEL.S_ORG_EXT T17, \
SIEBEL.S_PROD_INV_CAT T18, \
SIEBEL.S_PROD_INV T19, \
SIEBEL.S_ASSET T20 \
WHERE \
T2.ROW_ID = T5.VOD_ID (+) AND T5.LAST_VERS (+) = 0 AND \
T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) AND \
T20.CUR_AGREE_ID = T16.ROW_ID (+) AND \
T19.PROD_INV_CAT_ID = T18.ROW_ID (+) AND \
T20.PROD_ID = T11.ROW_ID AND \
T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) AND \
T12.PAR_CAT_ID = T9.ROW_ID (+) AND \
T11.CFG_MODEL_ID = T2.OBJECT_NUM AND \
T2.ROW_ID = T7.VOD_ID AND \
T15.PROD_ID = T1.ROW_ID (+) AND \
T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) AND \
T11.PR_PROD_LN_ID = T3.ROW_ID (+) AND \
T20.ROOT_ASSET_ID = T15.ROW_ID (+) AND \
T20.PROD_INV_ID = T19.ROW_ID (+) AND \
T20.ROW_ID = T4.PAR_ROW_ID (+) AND \
T20.PR_CON_ID = T10.ROW_ID (+) AND \
T20.BU_ID = T8.BU_ID (+) AND T20.ROW_ID = T8.ASSET_ID (+) AND \
T8.BU_ID = T6.ROW_ID (+) AND \
T8.BU_ID = T13.PAR_ROW_ID (+) AND \
((T7.VER_NUM = 1) AND \
(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id IN (?) \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID))) AND \
(T20.PROD_ID IN (?) AND T20.INVLOC_ID in (select soe.PR_FULFL_INVLOC_ID \
FROM SIEBEL.S_ORG_EXT SOE,SIEBEL.S_INVLOC SI, siebel.s_prod_invloc spil \
WHERE SOE.ROW_ID = ? \
AND SI.ACTIVE_FLG = 'Y' \
AND spil.prod_id IN (?) \
AND SOE.ROW_ID = SI.BU_ID \
AND SI.ROW_ID = SPIL.INVLOC_ID) \
AND XXATFL_GET_INVENTORY_QTY(T20.bu_id,T20.PROD_ID) = 0) 


getMultipleMrpForInStockProductV3 = SELECT \
	DISTINCT \
T20.PROD_ID AS PRODUCT_ID, \
	T20.X_LOT_GRADE AS MRP11, \
	XXATFL_NEW_SIEBEL_LAKSHYA_PKG.get_new_ptr_val(T20.X_LOT_GRADE, \
	T22.NAME, \
	T21.PROD_ID) AS ptr_price, \
	sum(t20.qty) AS Inventory_Quantity, \
	NVL((SELECT MAX(case_pack) FROM SIEBEL.S_PROD_INT \
WHERE ROW_ID = T20.PROD_ID), 0) AS units_per_case \
FROM \
	SIEBEL.S_PROD_INT T1, \
	SIEBEL.S_VOD T2, \
	SIEBEL.S_PROD_LN T3, \
	SIEBEL.S_ASSET_OM T4, \
	SIEBEL.S_ISS_OBJ_DEF T5, \
	SIEBEL.S_PARTY T6, \
	SIEBEL.S_VOD_VER T7, \
	SIEBEL.S_ASSET_BU T8, \
	SIEBEL.S_CTLG_CAT T9, \
	SIEBEL.S_PARTY T10, \
	SIEBEL.S_PROD_INT T11, \
	SIEBEL.S_CTLG_CAT T12, \
	SIEBEL.S_ORG_EXT T13, \
	SIEBEL.S_ASSET_OM T14, \
	SIEBEL.S_ASSET T15, \
	SIEBEL.S_DOC_AGREE T16, \
	SIEBEL.S_ORG_EXT T17, \
	SIEBEL.S_PROD_INV_CAT T18, \
	SIEBEL.S_PROD_INV T19, \
	SIEBEL.S_ASSET T20, \
	siebel.s_pri_lst_item T21, \
	siebel.s_pri_lst T22 \
WHERE \
	T2.ROW_ID = T5.VOD_ID (+) \
	AND T5.LAST_VERS (+) = 0 \
	AND \
T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) \
	AND T20.CUR_AGREE_ID = T16.ROW_ID (+) \
	AND T19.PROD_INV_CAT_ID = T18.ROW_ID (+) \
	AND T20.PROD_ID = T11.ROW_ID \
	AND T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) \
	AND T12.PAR_CAT_ID = T9.ROW_ID (+) \
	AND T11.CFG_MODEL_ID = T2.OBJECT_NUM \
	AND T2.ROW_ID = T7.VOD_ID \
	AND T15.PROD_ID = T1.ROW_ID (+) \
	AND T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) \
	AND T11.PR_PROD_LN_ID = T3.ROW_ID (+) \
	AND T20.ROOT_ASSET_ID = T15.ROW_ID (+) \
	AND T20.PROD_INV_ID = T19.ROW_ID (+) \
	AND T20.ROW_ID = T4.PAR_ROW_ID (+) \
	AND T20.PR_CON_ID = T10.ROW_ID (+) \
	AND T20.BU_ID = T8.BU_ID (+) \
	AND T20.ROW_ID = T8.ASSET_ID (+) \
	AND T8.BU_ID = T6.ROW_ID (+) \
	AND T8.BU_ID = T13.PAR_ROW_ID (+) \
	AND T1.ROW_ID = T21.PROD_ID \
	AND T21.PRI_LST_ID = T22.ROW_ID \
	AND ((T7.VER_NUM = 1) \
	AND (T20.PROD_ID IN (?) \
	AND T20.INVLOC_ID IN ( \
			SELECT soe.PR_FULFL_INVLOC_ID \
			FROM \
				SIEBEL.S_ORG_EXT SOE, \
				SIEBEL.S_INVLOC SI, \
				siebel.s_prod_invloc spil \
			WHERE \
				SOE.ROW_ID = ? \
				AND SI.ACTIVE_FLG = 'Y' \
				AND spil.prod_id IN (?) \
				AND SOE.ROW_ID = SI.BU_ID \
				AND SI.ROW_ID = SPIL.INVLOC_ID))) \
	AND \
(T20.PROD_ID IN (?) \
		AND T20.INVLOC_ID IN ( \
		SELECT \
			soe.PR_FULFL_INVLOC_ID \
		FROM \
			SIEBEL.S_ORG_EXT SOE, \
			SIEBEL.S_INVLOC SI, \
			siebel.s_prod_invloc spil \
		WHERE \
			SOE.ROW_ID = ? \
			AND SI.ACTIVE_FLG = 'Y' \
			AND spil.prod_id IN (?) \
				AND SOE.ROW_ID = SI.BU_ID \
				AND SI.ROW_ID = SPIL.INVLOC_ID) \
		AND T20.QTY > 0) \
	AND T22.NAME = ? \
GROUP BY \
	t20.X_LOT_GRADE, \
	T20.PROD_ID, \
	T22.NAME, \
	T21.PROD_ID

         
getMultipleMrpForOutofStockProductV2 = SELECT \
	DISTINCT \
T20.PROD_ID AS PRODUCT_ID, \
	T20.X_LOT_GRADE AS MRP11, \
	XXATFL_NEW_SIEBEL_LAKSHYA_PKG.get_new_ptr_val(T20.X_LOT_GRADE, \
	T22.NAME, \
	T21.PROD_ID) AS ptr_price, \
	sum(t20.qty) AS Inventory_Quantity, \
	NVL((SELECT MAX(case_pack) FROM SIEBEL.S_PROD_INT \
WHERE ROW_ID = T20.PROD_ID), 0) AS units_per_case \
FROM \
	SIEBEL.S_PROD_INT T1, \
	SIEBEL.S_VOD T2, \
	SIEBEL.S_PROD_LN T3, \
	SIEBEL.S_ASSET_OM T4, \
	SIEBEL.S_ISS_OBJ_DEF T5, \
	SIEBEL.S_PARTY T6, \
	SIEBEL.S_VOD_VER T7, \
	SIEBEL.S_ASSET_BU T8, \
	SIEBEL.S_CTLG_CAT T9, \
	SIEBEL.S_PARTY T10, \
	SIEBEL.S_PROD_INT T11, \
	SIEBEL.S_CTLG_CAT T12, \
	SIEBEL.S_ORG_EXT T13, \
	SIEBEL.S_ASSET_OM T14, \
	SIEBEL.S_ASSET T15, \
	SIEBEL.S_DOC_AGREE T16, \
	SIEBEL.S_ORG_EXT T17, \
	SIEBEL.S_PROD_INV_CAT T18, \
	SIEBEL.S_PROD_INV T19, \
	SIEBEL.S_ASSET T20, \
	siebel.s_pri_lst_item T21, \
	siebel.s_pri_lst T22 \
WHERE \
	T2.ROW_ID = T5.VOD_ID (+) \
	AND T5.LAST_VERS (+) = 0 \
	AND \
T11.CG_PR_CTLG_CAT_ID = T12.ROW_ID (+) \
	AND T20.CUR_AGREE_ID = T16.ROW_ID (+) \
	AND T19.PROD_INV_CAT_ID = T18.ROW_ID (+) \
	AND T20.PROD_ID = T11.ROW_ID \
	AND T20.OWNER_ACCNT_ID = T17.PAR_ROW_ID (+) \
	AND T12.PAR_CAT_ID = T9.ROW_ID (+) \
	AND T11.CFG_MODEL_ID = T2.OBJECT_NUM \
	AND T2.ROW_ID = T7.VOD_ID \
	AND T15.PROD_ID = T1.ROW_ID (+) \
	AND T20.ROOT_ASSET_ID = T14.PAR_ROW_ID (+) \
	AND T11.PR_PROD_LN_ID = T3.ROW_ID (+) \
	AND T20.ROOT_ASSET_ID = T15.ROW_ID (+) \
	AND T20.PROD_INV_ID = T19.ROW_ID (+) \
	AND T20.ROW_ID = T4.PAR_ROW_ID (+) \
	AND T20.PR_CON_ID = T10.ROW_ID (+) \
	AND T20.BU_ID = T8.BU_ID (+) \
	AND T20.ROW_ID = T8.ASSET_ID (+) \
	AND T8.BU_ID = T6.ROW_ID (+) \
	AND T8.BU_ID = T13.PAR_ROW_ID (+) \
	AND T1.ROW_ID = T21.PROD_ID \
	AND T21.PRI_LST_ID = T22.ROW_ID \
	AND ((T7.VER_NUM = 1) \
	AND (T20.PROD_ID IN (?) \
	AND T20.INVLOC_ID IN ( \
			SELECT soe.PR_FULFL_INVLOC_ID \
			FROM \
				SIEBEL.S_ORG_EXT SOE, \
				SIEBEL.S_INVLOC SI, \
				siebel.s_prod_invloc spil \
			WHERE \
				SOE.ROW_ID = ? \
				AND SI.ACTIVE_FLG = 'Y' \
				AND spil.prod_id IN (?) \
				AND SOE.ROW_ID = SI.BU_ID \
				AND SI.ROW_ID = SPIL.INVLOC_ID))) \
	AND \
(T20.PROD_ID IN (?) \
		AND T20.INVLOC_ID IN ( \
		SELECT \
			soe.PR_FULFL_INVLOC_ID \
		FROM \
			SIEBEL.S_ORG_EXT SOE, \
			SIEBEL.S_INVLOC SI, \
			siebel.s_prod_invloc spil \
		WHERE \
			SOE.ROW_ID = ? \
			AND SI.ACTIVE_FLG = 'Y' \
			AND spil.prod_id IN (?) \
				AND SOE.ROW_ID = SI.BU_ID \
				AND SI.ROW_ID = SPIL.INVLOC_ID) \
		AND T20.QTY = 0) \
	AND T22.NAME = ? \
GROUP BY \
	t20.X_LOT_GRADE, \
	T20.PROD_ID, \
	T22.NAME, \
	T21.PROD_ID
         
getInStockProductWithInventoryHardCode = SELECT XXATFL_GET_INVENTORY_QTY(SOE2.ROW_ID,SPI.ROW_ID) AS INVENTORY_QUANTITY,INV.INVENTORY_CODE \
      ,    LMO.OUTLET_ID, SPI.ROW_ID AS PRODUCT_ID \
      ,    LMPC.CATEGORY_ID,'1' AS org_id,lmpsc.SUB_CATEGORY_ID \
      ,    SPI."TYPE" AS product_type \
      ,    SPI.ref_number_5 AS "CATEGORY" \
      ,    SPI.category_cd AS subcategory \
      ,    SPI.cfg_model_id AS product_code \
      ,    SPI.x_long_desc AS product_name \
      ,    SPI.part_num AS product_desc \
      ,    SPI.reason_txt AS prod_short_desc \
      ,    SPI.uom_cd AS primary_uom \
      ,    SPI.x_subbrand AS secondary_uom \
      ,    SPI.x_sec_uom_value AS secondary_uom_value \
      ,    SPI.case_pack AS units_per_case \
      ,    SPI.x_segment AS "SEGMENT" \
      ,    SPI.x_style AS style \
      ,    SPI.x_flavor AS flavor \
      ,    SPI.case_pack AS case_pack \
      ,    SPI.ref_number_1 AS hsn_code \
      ,    SPI.orderable_flg AS orderable \
      ,    'Y' PTR_FLAG \
      ,    LMPC.CATEGORY_ID CATEGORY_ID1,LMPC.ORG_ID ORG_ID1,LMPC.CATEGORY_CODE \
      ,    LMPC.CATEGORY_NAME,LMPC.CATEGORY_DESC,LMPC.STATUS \
      ,    LMPL.PRICE_LIST,LMPL.LIST_PRICE, LMPL.CURRENCY , LMPL.PTR_PRICE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS PRODUCT_IMAGE, \
      (SELECT lmpv.PRODUCT_IMAGE  FROM LT_MAST_PRODUCTS_V lmpv WHERE lmpv.PRODUCT_CODE = SPI.ROW_ID) AS THUMBNAIL_IMAGE \
FROM   SIEBEL.S_PROD_INT SPI, LT_MAST_PROD_CATEGORIES LMPC ,LT_MAST_PRICE_LISTS_V LMPL, \
       LT_MAST_OUTLETS_V LMO,SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2 \
      ,LT_MAST_INVENTORY_V INV ,lt_mast_prod_sub_categories lmpsc \
WHERE UPPER(SPI.REF_NUMBER_5) = UPPER (LMPC.CATEGORY_NAME(+)) \
AND  upper (SPI.category_cd) = upper (lmpsc.sub_category_name(+)) \
AND   LMPL.PRODUCT_CODE= SPI.ROW_ID \
AND   lmpl.price_list = lmo.price_list \
AND   lmo.OUTLET_ID = SOE1.ROW_ID \
AND   SOE1.BU_ID = SOE2.ROW_ID  \
AND   SPI.ROW_ID = INV.PRODUCT_CODE \
AND   SOE2.ROW_ID = INV.DIST_CODE   \
AND   UPPER(SPI.STATUS_CD) = 'ACTIVE' \
AND   INV.QUANTITY <> 0 \
AND   COALESCE(SPI.ROW_ID,'xx') = COALESCE( ? , COALESCE(SPI.ROW_ID,'xx'))  \
AND   COALESCE(LMPC.CATEGORY_ID,'xx') = COALESCE( ? , COALESCE(LMPC.CATEGORY_ID,'xx'))  \
AND   COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx') LIKE \
      COALESCE( ? ,COALESCE(UPPER(SPI.X_LONG_DESC || SPI.ROW_ID || LMPL.LIST_PRICE || SPI.REASON_TXT),'xx')) \
AND   SOE1.ROW_ID = ?  \
ORDER BY CAST(COALESCE(LMPL.LIST_PRICE, 0) AS NUMERIC) ASC, SPI.ROW_ID ASC \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY



getReportDataBySalesPersonDistributorAH = select lsh.order_number, (lme.first_name ||' '|| lme.last_name) as SalesPersonName, \
lme.employee_code,  LMO.OUTLET_NAME ,LMO.OUTLET_CODE ,  \
lmo.outlet_id, (lmo.address_1 ||' '|| lmo.address_2 ) as outletAddress, \
(case \
WHEN lsl.list_price LIKE '%*%' OR lsl.list_price LIKE '%''%' OR lsl.list_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(LSL.LIST_PRICE),2) \
END )AS list_price1, \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
END )AS ptr_price1, \
(CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
END )AS QUANTITY1,   \
(case \
WHEN lsl.ptr_price LIKE '%*%' OR lsl.ptr_price LIKE '%''%' OR lsl.ptr_price LIKE '%null%' THEN 0 \
ELSE ROUND(TO_NUMBER(LSL.PTR_PRICE),2) \
END ) * (CASE \
	WHEN lsl.quantity LIKE '%*%' OR lsl.quantity LIKE '%''%' OR lsl.quantity LIKE '%null%' THEN 0 \
	ELSE ROUND(TO_NUMBER (LSL.QUANTITY),2) \
END ) \
AS total, \
lmd.distributor_id, lme.employee_id ,  \
lmd.distributor_code, lmd.distributor_name, lmd.distributor_crm_code  , \
lmpd.product_code ,lmpd.product_name ,lmpd.product_desc, \
lsh.status, lsh.order_date as orderDate  \
FROM  \
LT_MAST_EMPLOYEES_V LME,  \
LT_MAST_DISTRIBUTORS_V LMD,  \
lt_mast_outlets_v lmo ,   \
lt_so_headers lsh ,   \
LT_SO_LINES LSL,  \
LT_MAST_PRODUCTS_V LMPD,  \
lt_mast_price_lists_v lmpl,  \
lt_mast_users lmu \
where 1=1   \
and lmu.status = 'ACTIVE'  \
and lsh.header_id = lsl.header_id  \
and lsh.outlet_id = lmo.outlet_id  \
and lsl.product_id = lmpd.product_id  \
and lmpl.price_list  = lmo.price_list  \
and lmpd.product_code = lmpl.product_code  \
AND lme.distributor_id =lmd.distributor_id  \
AND lmo.distributor_id= lme.distributor_id  \
AND lmu.user_id = lsh.last_updated_by  \
AND COALESCE(LSH.STATUS ,'xx') =  COALESCE( ? ,COALESCE(LSH.STATUS,'xx'))  \
AND COALESCE(LSH.DISTRIBUTOR_ID ,'xx') =  COALESCE( ? ,COALESCE(LSH.DISTRIBUTOR_ID,'xx'))  \
AND LSH.SALES_PERSON_ID = ? \
AND (TRUNC(lsh.LAST_UPDATE_DATE) BETWEEN TO_DATE(?, 'DD-MON-YY') AND TO_DATE(?, 'DD-MON-YY'))   \
order by lsh.order_number DESC


	