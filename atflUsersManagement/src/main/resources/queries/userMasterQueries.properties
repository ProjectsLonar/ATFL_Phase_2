
limit_value = -1

getUsersList = SELECT A.* FROM( \
SELECT LMU.*,ROWNUM RNUM, LME.FIRST_NAME ||' '||LME.LAST_NAME AS EMPNAME,LMO.OUTLET_CODE \
,LMP."position" \
from \
lt_mast_users lmu \
left join  lt_mast_outlets_v lmo on lmu.outlet_id =lmo.outlet_id \
left join lt_mast_positions_v lmp on lmp.position_id = lmu.position_id \
left join lt_mast_employees_v lme on lme.position_id = lmp.position_id \
WHERE 1 =1 \
AND LMU.ORG_ID = ? \
AND COALESCE(LMU.DISTRIBUTOR_ID,'xx') =  COALESCE( ? ,COALESCE(LMU.DISTRIBUTOR_ID,'xx')) \
AND COALESCE(LMU.OUTLET_ID ,'xx') =  COALESCE( ? ,COALESCE(LMU.OUTLET_ID,'xx')) \
AND COALESCE(UPPER(LMU.STATUS),'xx') =  COALESCE( ? ,COALESCE(UPPER(LMU.STATUS),'xx')) \
AND COALESCE(UPPER(LMU.USER_TYPE ),'xx') =  COALESCE( ? ,COALESCE(UPPER(LMU.USER_TYPE),'xx')) \
AND COALESCE(UPPER(LMU.USER_NAME || LMU.STATUS || LMU.USER_TYPE || LMU.ADDRESS || LMO.OUTLET_CODE || LMP."position"),'xx') \
like  COALESCE( ? ,COALESCE(upper(lmu.user_name || lmu.status || lmu.user_type || lmu.address || lmo.outlet_code || lmp."position"),'xx')) \
AND COALESCE(lme.employee_id,'xx') =  COALESCE( ? ,COALESCE(lme.employee_id,'xx')) \
and lmu.user_id  !=  ?  \
AND LMU.STATUS !='INPROCESS' \
ORDER BY LMU.CREATION_DATE DESC ) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#where RNUM BETWEEN ? AND ?


getUserAllMasterDataById = SELECT LMU.*,LMD.DISTRIBUTOR_CODE ,LMD.DISTRIBUTOR_CRM_CODE,lmd.TERRITORY, LMD.DISTRIBUTOR_NAME , (LMD.ADDRESS_1||' '||LMD.ADDRESS_2 ) AS DISTRIBUTORADDRESS  \
,lmo.organisation_code ,lmo.organisation_name ,lmou.outlet_code ,lmou.proprietor_name,lmou.outlet_name ,(lmou.address_1 ||' '||lmou.address_2 ) as outletAddress,   \
LME.EMPLOYEE_ID ,LME.EMPLOYEE_CODE AS EMPCODE,LME.EMAIL,LME.PRIMARY_MOBILE,LME.FIRST_NAME ||' '|| LME.LAST_NAME AS EMPNAME,LME."position"  \
,ILN.LOCATION_NAME AS inventory_location_name  \
from lt_mast_users lmu  \
left join lt_mast_distributors_v lmd on lmu.distributor_id = lmd.distributor_id  \
left join lt_mast_organisations lmo on lmu.org_id = lmo.org_id  \
left join lt_mast_outlets_v lmou on lmu.outlet_id = lmou.outlet_id  \
left join lt_mast_employees_v lme on lmu.position_id = lme.position_id  \
LEFT JOIN LT_MAST_POSITIONS_V LMP ON LMP.POSITION_ID = LMU.POSITION_ID   \
left join INV_LOCATION_NAME ILN on ILN.DISTRIBUTOR_ID = lmd.distributor_id   \
and lme.position_id = lmp.position_id  \
AND LME."position" =LMP."position"  \
WHERE LMU.USER_ID = ?

getAllUserByDistributorId = select lmu.* from lt_mast_users lmu where 1=1 and lmu.distributor_id = ? order by last_update_date DESC

getDistributorUserByRoleAndId = select lmu.* from lt_mast_users lmu where lmu.distributor_id = ? and lmu.user_type = 'DISTRIBUTOR' 

getPenddingApprovalByDistributorId = select lmu.* from lt_mast_users lmu where lmu.distributor_id = ? and lmu.user_id != ? and lmu.status = 'PENDING_APPROVAL'

getLtMastUsersByMobileNumber = SELECT um.* FROM LT_MAST_USERS um WHERE um.MOBILE_NUMBER = ? 

getSiebelUsersByMobileNumber = SELECT * FROM siebel.S_CONTACT sc WHERE REPLACE(SC.CELL_PH_NUM,'+91','') = ?

getEmployeeByCode = SELECT lme.* FROM lt_mast_employees_v lme WHERE upper(lme.employee_code) = ? 

saveFireBaseToken = UPDATE LT_MAST_LOGINS SET TOKEN_ID = ? WHERE LOGIN_ID = (SELECT LOGIN_ID FROM \
(SELECT LOGIN_ID FROM LT_MAST_LOGINS WHERE USER_ID = ? ORDER BY LOGIN_ID DESC) WHERE ROWNUM <= 1)

getLoginDetailsByUserId = SELECT LOGIN_ID, OTP, STATUS, USER_ID, TOKEN_ID \
FROM LT_MAST_LOGINS WHERE USER_ID = ? ORDER BY LOGIN_ID DESC

getLtMastUsersById = SELECT lmu.* \
FROM LT_MAST_USERS lmu \
WHERE lmu.USER_ID = ?

getUserByName = select um.USER_ID,um.USER_NAME,um.MOBILE_NUMBER,um.STATUS,um.EMAIL \
from LT_MAST_USERS um where UPPER(um.USER_NAME) LIKE ?

getCustomerByName = getCustomerByName = select um.USER_ID,um.USER_NAME,um.MOBILE_NUMBER,um.STATUS,um.EMAIL \
from LT_MAST_USERS um where UPPER(um.USER_NAME) LIKE ?

#  flat_no,area doesnt exits so cant run this query but changes done 
##Comment by sweety this will work if we will remove non exists fields
getLtMastUsersDataTable = select  b.* \
FROM (SELECT A.* FROM( SELECT UM.USER_ID,UM.USER_NAME,UM.USER_TYPE,UM.MOBILE_NUMBER,UM.FLAT_NO,UM.ADDRESS,UM.AREA ,UM.STATUS \
FROM LT_MAST_USERS UM WHERE COALESCE(UPPER(UM.USER_NAME || UM.USER_TYPE || UM.MOBILE_NUMBER || UM.AREA || UM.FLAT_NO || UM.ADDRESS),'xxx') \
LIKE  COALESCE(?,COALESCE(UPPER(UM.USER_NAME || UM.USER_TYPE || UM.MOBILE_NUMBER || UM.AREA || UM.FLAT_NO || UM.ADDRESS),'xxx')) \
order by CASE WHEN 1 = ? then upper(um.USER_NAME) END asc  )a  ) b  where rownum <=?

#flat no not exists,changes done
getLtMastUsersCount = select COUNT(um.USER_ID) \
FROM LT_MAST_USERS UM \
WHERE  COALESCE(UPPER(UM.USER_NAME || UM.USER_TYPE || UM.MOBILE_NUMBER || UM.AREA || UM.FLAT_NO || UM.ADDRESS),'xxx') \
LIKE  COALESCE(NULL,COALESCE(UPPER(UM.USER_NAME || UM.USER_TYPE || UM.MOBILE_NUMBER || UM.AREA || UM.FLAT_NO || UM.ADDRESS),'xxx'))

#lt_supplier_cities doesnt exists
getAllUserBySupplierCount = select lmu.user_id,lmu.USER_NAME ,lmu.area,lsc.city \
from  lt_mast_users lmu  left join lt_supplier_cities lsc on lmu.city_id = lsc.city_id \
WHERE  LMU.SUPPLIER_ID = ?  AND LMU.STATUS = 'ACTIVE' \
AND COALESCE(UPPER(LMU.USER_NAME || LMU.AREA || LSC.CITY || LMU.FLAT_NO || LMU.ADDRESS),'xxx') \
LIKE  COALESCE(?,COALESCE(UPPER(LMU.USER_NAME || LMU.AREA || LSC.CITY || LMU.FLAT_NO || LMU.ADDRESS),'xxx')) \
GROUP BY LMU.USER_ID,LMU.USER_NAME,LMU.AREA,LSC.CITY

#lt_supplier_cities doesnt exists
getAllUserBySupplierDataTable = SELECT  B.*  FROM \
(SELECT a.* from ( select lmu.user_id,lmu.USER_NAME ,(lmu.flat_no,||' '||,lmu.address)as address ,lmu.area,lsc.city, \
(select count(subs_id) as subs_count from lt_customer_subs where user_id = lmu.user_id and status IN ('PENDING' , 'ACTIVE')) \
from  lt_mast_users lmu  left join lt_supplier_cities lsc on lmu.city_id = lsc.city_id  \
WHERE  LMU.SUPPLIER_ID = ?  AND LMU.STATUS = 'ACTIVE' \
AND COALESCE(UPPER(LMU.USER_NAME || LMU.AREA || LSC.CITY || LMU.FLAT_NO || LMU.ADDRESS),'xxx') \
like  COALESCE(?,COALESCE(upper(lmu.USER_NAME || lmu.AREA || lsc.city || lmu.flat_no || lmu.address),'xxx')) \
GROUP BY LMU.USER_ID,LMU.USER_NAME,LMU.AREA,LSC.CITY \
ORDER BY LMU.USER_NAME )A  ) B  where rownum<=?; 

getLtMastUsersByType = SELECT UM.USER_ID,UM.FLAT_NO,UM.USER_NAME,UM.ADDRESS,UM.AREA,UM.STATUS, \
(um.FLAT_NO || ', ' || um.ADDRESS || ', ' || um.AREA ) as CUSTOMER_ADDRESS \
FROM LT_MAST_USERS um \
WHERE UPPER(UM.USER_TYPE) = ? AND UPPER(UM.STATUS) = 'ACTIVE' \
ORDER BY um.USER_NAME ASC

getAllInactiveUsers = select * from lt_mast_users lmu where UPPER(lmu.status) = 'INACTIVE'

#### Used Query ########################################################################
getUserTypeAndDisId = select lmu.user_type, lmu.distributor_id from lt_mast_users lmu where lmu.user_id = ?

getPromotionData = select a.* from( \
select * from lt_promotion \
where 1=1 \
AND UPPER(STATUS) = 'ACTIVE' \
and org_id = ? \
and (end_date > sysdate \
or upper(all_time_show_flag)  = 'YES' ) \
ORDER BY PROMOTION_ID DESC \
) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

##WHERE ROWNUM BETWEEN ? AND ?

#This getPromotionData query is jugad from me & magare
#getPromotionData = select a.* from( \
#select * from lt_promotion \
#where 1=1 \
#AND UPPER(STATUS) = 'ACTIVE' \
#AND ORG_ID = ? \
#AND (TO_DATE(SUBSTR(END_DATE_1,1,9),'DD-MM-YY') > TO_DATE(SYSDATE,'DD-MM-YY') \
#or upper(all_time_show_flag)  = 'YES')  \
#ORDER BY PROMOTION_ID DESC \
#) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY



getPromotionDataForAdmin = select a.* from( \
select * from lt_promotion \
WHERE 1=1 \
and org_id = ? \
ORDER BY PROMOTION_ID DESC \
) A OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE ROWNUM BETWEEN ? AND ?
	
##### Outlet 

verifyOutletUser = SELECT mo.outlet_code,mo.outlet_name,mo.outlet_id,mo.org_id,mo.distributor_id,mo.distributor_id,mo.positions_id, \
md.distributor_name,md.distributor_code,md.distributor_crm_code,mo.status ,md.status as distributorStatus ,mp."position" \
FROM \
lt_mast_outlets_v mo \
LEFT JOIN lt_mast_distributors_v md ON mo.distributor_id = md.distributor_id \
left JOIN lt_mast_positions_v mp on mo.positions_id = mp.position_id \
WHERE 1=1 \
and upper(mo.status) = 'ACTIVE' \
and mo.outlet_code = ? \
AND MD.DISTRIBUTOR_CRM_CODE = ?

#need to remove lmo.landmark,lmo.outlet_gstn, lmo.outlet_pan, lmo.licence_no to run
 
#getOutlet =	SELECT A.* FROM(SELECT  \       18-Mar-2024 vaibhav & shubham query optimize
#lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, lmo.proprietor_name,  (lmo.address_1||' '||lmo.address_2 ) as outletAddress ,  \
#lmo.address_2 as address2 , lmo.address_3 as address3, lmo.address_4 as address4, lmo.landmark, lmo.country, lmo.state, lmo.city, lmo.pin_code, lmo.region,  \
#lmo.area, lmo.territory, lmo.outlet_gstn, lmo.phone, lmo.email, lmo.primary_mobile as primaryMobile, lmo.beat_name,  \
#lmo.status, lmo.start_date, lmo.end_date, lmo.created_by, lmo.price_list, lmo.positions_id, lmo.org_id,lmo.LAST_UPDATE_DATE,lmo.ADDRESS_1 as address1,lmp."position" ,lmo.OUTLET_CHANNEL  \
#from lt_mast_outlets_v lmo,lt_mast_employees_v lme, lt_mast_positions_v lmp  \
#where 1 = 1  \
#AND COALESCE(UPPER(LMO.STATUS),'xx') = COALESCE ( ? ,COALESCE(UPPER(LMO.STATUS),'xx'))  \
#and lme."position" = lmp."position" \
#AND LMO.POSITIONS_ID = LMP.POSITION_ID  \
#AND COALESCE(LMO.DISTRIBUTOR_ID,'xx') =  COALESCE( ? ,COALESCE(LMO.DISTRIBUTOR_ID,'xx')) \
#AND COALESCE(LME.EMPLOYEE_ID,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))  \
#AND LMO.ORG_ID = ? \
#AND COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx')  \
#LIKE  COALESCE( ? ,COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx'))  \
#) A  \
#ORDER BY a.LAST_UPDATE_DATE desc \
#OFFSET ? ROWS  \
#FETCH NEXT ? ROWS ONLY

#comment on 08-may-24 by me & shubham for result change
#getOutlet = SELECT A.* FROM(SELECT  \
#lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, lmo.proprietor_name,  (lmo.address_1||' '||lmo.address_2 ) as outletAddress ,  \
#lmo.address_2 as address2 , lmo.address_3 as address3, lmo.address_4 as address4, lmo.landmark, lmo.country, lmo.state, lmo.city, lmo.pin_code, lmo.region,  \
#LMO.AREA, LMO.TERRITORY, LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, LMO.PRIMARY_MOBILE AS PRIMARYMOBILE, LMO.BEAT_NAME,  \
#LMO.STATUS, LMO.START_DATE, LMO.END_DATE, LMO.CREATED_BY, LMO.PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE,LMO.ADDRESS_1 AS ADDRESS1,LMP.name as "position" ,LMO.OUTLET_CHANNEL  \
#from lt_mast_outlets_v lmo,lt_mast_employees_v lme, siebel.s_postn lmp  \
#WHERE 1 = 1  \
#AND LME."position" = lmp.name \
#AND LME.DISTRIBUTOR_ID = LMO.DISTRIBUTOR_ID \
#AND LMP.row_id = LMO.POSITIONS_ID   \
#AND UPPER(LMO.STATUS) = ?  \
#AND LMO.DISTRIBUTOR_ID =  ? \
#AND LMO.ORG_ID = ? \
#AND COALESCE(LME.EMPLOYEE_ID,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx'))  \
#AND COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx')  \
#LIKE  COALESCE( ? ,COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx'))  \
#) A  \
#ORDER BY A.LAST_UPDATE_DATE DESC \
#OFFSET ? ROWS  \
#FETCH NEXT ? ROWS ONLY

#comment on 24-May-2024 bcz newly created outlet is not display in query result
#getOutlet = SELECT A.* FROM(SELECT  \
#lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, NVL(LMO.PROPRIETOR_NAME,LMOS.PROPRIETOR_NAME) AS proprietor_name,  (lmo.address_1||' '||lmo.address_2 ) as outletAddress ,\
#LMO.ADDRESS_2 AS ADDRESS2 , LMO.ADDRESS_3 AS ADDRESS3, LMO.ADDRESS_4 AS ADDRESS4, LMO.LANDMARK, LMO.COUNTRY, LMO.STATE, LMO.CITY, LMO.PIN_CODE, LMO.REGION,  \
#LMO.AREA, LMO.TERRITORY, LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, NVL(LMO.PRIMARY_MOBILE, LMOS.PRIMARY_MOBILE) AS PRIMARYMOBILE, LMO.BEAT_NAME AS BEAT_NAME,  \
#LMO.STATUS, LMO.START_DATE, LMO.END_DATE, LMO.CREATED_BY, LMO.PRICE_LIST AS PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE,LMO.ADDRESS_1 AS ADDRESS1,LMP.NAME AS "position" ,LMO.OUTLET_CHANNEL  \
#FROM LT_MAST_OUTLETS_V LMO,LT_MAST_EMPLOYEES_V LME, SIEBEL.S_POSTN LMP \
#,LT_MAST_OUTLETS_STG LMOS \
#WHERE 1 = 1  \
#AND LME."position" = lmp.name \
#AND LME.DISTRIBUTOR_ID = LMO.DISTRIBUTOR_ID \
#AND LMP.ROW_ID = LMO.POSITIONS_ID   \
#AND LMOS.OUTLET_CODE(+) = LMO.OUTLET_ID \
#AND UPPER(LMO.STATUS) = ?  \
#AND LMO.DISTRIBUTOR_ID =  ? \
#AND LMO.ORG_ID = ? \
#AND COALESCE(LME.EMPLOYEE_ID,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx')) \
#AND COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx') \
#LIKE  COALESCE( ? ,COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx'))  \
#) A  \
#ORDER BY A.LAST_UPDATE_DATE DESC \
#OFFSET ? ROWS  \
#FETCH NEXT ? ROWS ONLY


getOutlet =  SELECT A.* FROM(SELECT \
lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, LMO.PROPRIETOR_NAME AS proprietor_name,  (lmo.address_1||' '||lmo.address_2 ) as outletAddress , \
LMO.ADDRESS_2 AS ADDRESS2 , LMO.ADDRESS_3 AS ADDRESS3, LMO.ADDRESS_4 AS ADDRESS4, LMO.LANDMARK, LMO.COUNTRY, LMO.STATE, LMO.CITY, LMO.PIN_CODE, LMO.REGION,  \
LMO.AREA, nvl(LMO.TERRITORY, lmos.TERRITORY) AS TERRITORY,  LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, nvl(LMO.PRIMARY_MOBILE, lmos.PRIMARY_MOBILE)  AS PRIMARYMOBILE, LMO.BEAT_NAME AS BEAT_NAME,  \
LMO.STATUS, LMO.START_DATE, LMO.END_DATE, LMO.CREATED_BY, LMO.PRICE_LIST AS PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE,LMO.ADDRESS_1 AS ADDRESS1, \
LMP.NAME AS "position" ,LMO.OUTLET_CHANNEL  \
FROM LT_MAST_OUTLETS_V LMO,LT_MAST_EMPLOYEES_V LME, SIEBEL.S_POSTN LMP, LT_MAST_OUTLETS_STG lmos  \
where \
1 = 1  \
AND LME.DISTRIBUTOR_ID(+) = LMO.DISTRIBUTOR_ID \
AND lme.org_id (+) =lmo.ORG_ID \
AND lme.POSITION_ID(+) = lmo.POSITIONS_ID \
AND LMP.ROW_ID = LMO.POSITIONS_ID   \
AND LMOS.OUTLET_CODE(+) = LMO.OUTLET_ID \
AND UPPER(LMO.STATUS) = ? \
AND LMO.DISTRIBUTOR_ID = ? \
AND LMO.ORG_ID = ? \
AND COALESCE(LME.EMPLOYEE_ID,'xx') =  COALESCE( ? ,COALESCE(LME.EMPLOYEE_ID,'xx')) \
AND COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx') \
LIKE  COALESCE( ? ,COALESCE(UPPER(LMO.OUTLET_NAME || LMO.OUTLET_CODE || LMO.ADDRESS_1 || LMO.ADDRESS_2 || LMO.BEAT_NAME),'xx'))  \
) A  \
ORDER BY A.LAST_UPDATE_DATE DESC \
OFFSET ? ROWS  \
FETCH NEXT ? ROWS ONLY


#WHERE ROWNUM BETWEEN ? AND  ?
	   
getMastDataByOutletId = SELECT LMD.DISTRIBUTOR_CODE ,LMD.DISTRIBUTOR_NAME , (LMD.ADDRESS_1||' '||LMD.ADDRESS_2 ) AS DISTRIBUTORADDRESS \
,lmo.outlet_code ,lmo.outlet_id ,lmo.proprietor_name ,lmo.outlet_name , (lmo.address_1 ||' '||lmo.address_2 ) as outletAddress, \
lme.employee_id ,lme.employee_code as empCode,lme.first_name ||' '|| lme.last_name as empName , lmo.PRICE_LIST \
from lt_mast_outlets_v lmo \
left join lt_mast_distributors_v lmd on lmo.distributor_id = lmd.distributor_id \
left join lt_mast_positions_v lmp on lmo.positions_id = lmp.position_id \
LEFT JOIN LT_MAST_EMPLOYEES_v LME ON LME.POSITION_ID = LMP.POSITION_ID \
AND LME."position" = LMP."position" WHERE LMO.OUTLET_ID = ? AND UPPER(LMO.STATUS) = 'ACTIVE'

### Sales Person

verifyEmployeeCOPY = select me.employee_code,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status, \
md.status as distributorStatus, \
mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on me.position_id = mp.position_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and me.employee_code = ? \
AND MD.DISTRIBUTOR_CRM_CODE = ? \
AND ME."position" = ? \
AND UPPER(ME.JOB_TITLE) = 'DISTRIBUTOR SALESMAN'
	
	
verifyEmployee = select me.employee_code,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status, \
md.status as distributorStatus, \
mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id = md.distributor_id \
and me.position_id = mp.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(lmep.status) = 'ACTIVE' \
and me.employee_code = ? \
AND MD.DISTRIBUTOR_CRM_CODE = ? \
and me."position" = ? \
and (upper(me.job_title) = 'DISTRIBUTOR SALESMAN' \
or UPPER(me.job_title) = 'ADS' \
or UPPER(me.job_title) = 'ARS' \
or UPPER(me.job_title) = 'EDS' \
or UPPER(me.job_title) = 'MDS' \
or UPPER(me.job_title) = 'R-DEC' \
OR UPPER(ME.JOB_TITLE) = 'RSU'  \
OR upper(ME.JOB_TITLE) = 'DISTRIBUTOR PROPRIETOR')
	
verifyEmployeeCopyV1 = select me.employee_code,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_emp_position_v mep on me.employee_id = mep.employee_id \
left join lt_mast_positions_v mp on mp.position_id = mep.position_id \
where 1=1 \
and  UPPER(me.status) = 'ACTIVE' \
and me.employee_code = ? \
AND MD.DISTRIBUTOR_CRM_CODE = ? \
and mp."position" = ? \
AND UPPER(MP.POSITION_TYPE) = 'DISTRIBUTOR SALESMAN'
	
verifyEmployeeCopyV2 = select me.employee_code,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on me.position_id = mp.position_id \
where 1=1 \
and  UPPER(me.status) = 'ACTIVE' \
and me.employee_code = ? \
AND MD.DISTRIBUTOR_CRM_CODE = ? \
and mp."position" = ? \
AND UPPER(MP.POSITION_TYPE) = 'DISTRIBUTOR SALESMAN'
	
#comment on 16-May-2024 by shubham for correct result & optimisation	
#getSalesPersonsForDistributorV1 = SELECT A.* FROM( \
#SELECT DISTINCT(LMP.POSITION_ID), LMP.ORG_ID,LMP.DISTRIBUTOR_ID,LMP.POSITION_CODE,LMP.PARENT_POSITION \
#,LMP.POSITION_TYPE,LMP.FIRST_NAME,LMP.LAST_NAME,LMP.JOB_TITLE,LMP.STATUS,LMP."position",ROWNUM RNUM \
#,lme.employee_id  from \
#lt_mast_positions_v lmp, \
#lt_mast_employees_v lme \
#WHERE 1=1 \
#AND LMP."position" = LME."position" \
#AND COALESCE(LMP.DISTRIBUTOR_ID,'xx') =  COALESCE( ? ,COALESCE(LMP.DISTRIBUTOR_ID,'xx')) \
#AND lmp.org_id = ? \
#and  UPPER(lme.status) = 'ACTIVE' \
#and (UPPER(lme.job_title) = 'ARS' or UPPER(lme.job_title) = 'ADS' or UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN' \
#or UPPER(lme.job_title) = 'EDS' or UPPER(lme.job_title) = 'MDS' or UPPER(lme.job_title) = 'R-DEC' \
#OR UPPER(LME.JOB_TITLE) = 'RSU') \
#AND COALESCE(UPPER(LMP.FIRST_NAME || LMP.LAST_NAME || LMP."position" || LME.JOB_TITLE),'xx') LIKE \
#COALESCE( ? ,COALESCE(upper(lmp.first_name || lmp.last_name || lmp."position" || lme.job_title),'xx')) \
#ORDER BY LMP.POSITION_ID DESC \
#) a OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


getSalesPersonsForDistributorV1 = SELECT DISTINCT pos.row_id AS position_id \
     ,     '1' AS ORG_ID \
      ,    org2.row_id AS distributor_id \
      ,    pos.row_id AS position_code \
      ,    pos1.name AS parent_position \
      ,    pos.postn_type_cd AS position_type \
      ,    sc.fst_name AS first_name \
      ,    sc.last_name AS last_name \
      ,    sc.job_title AS job_title \
      ,    SU.STATUS_CD AS STATUS \
      ,    POS.NAME AS "position" \
      ,    su.row_id AS EMPLOYEE_ID \
    FROM siebel.s_bu sbu \
      ,  siebel.s_org_ext org2 \
      ,  siebel.s_org_ext org1 \
      ,  siebel.s_postn pos \
      ,  siebel.s_postn pos1 \
      ,  siebel.s_contact sc \
      ,  SIEBEL.S_PARTY SP \
      ,  siebel.s_user su \
    WHERE org2.row_id = sbu.row_id \
        AND \
            org1.bu_id = sbu.row_id \
        AND \
            org1.pr_postn_id = pos.row_id \
        AND \
            sc.pr_held_postn_id = pos.row_id \
        AND \
            SP.ROW_ID = POS.ROW_ID \
        AND \
            SP.PAR_PARTY_ID = POS1.ROW_ID \
            AND SU.ROW_ID = SC.ROW_ID \
         AND  ORG2.ROW_ID = ? \
         AND UPPER(SU.STATUS_CD) = UPPER('Active') \
and (UPPER(sc.job_title) = 'ARS' or UPPER(sc.job_title) = 'ADS' or UPPER(sc.job_title) = 'DISTRIBUTOR SALESMAN' \
OR UPPER(sc.JOB_TITLE) = 'EDS' OR UPPER(sc.JOB_TITLE) = 'MDS' OR UPPER(sc.JOB_TITLE) = 'R-DEC' \
OR UPPER(sc.JOB_TITLE) = 'RSU') \
AND COALESCE(UPPER(sc.fst_name || sc.last_name || POS.NAME || sc.JOB_TITLE),'xx') LIKE \
COALESCE( ? ,COALESCE(UPPER(SC.FST_NAME || SC.LAST_NAME || POS.NAME || SC.JOB_TITLE),'xx')) \
ORDER BY POS.ROW_ID DESC \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


#where ROWNUM BETWEEN ? AND ?

removePart = and UPPER(lme.job_title) = 'DISTRIBUTOR SALESMAN'


### distributor
verifyDistributorsCOPY = select mo.org_id, mo.distributor_id ,mo.distributor_code, mo.distributor_name, \
mo.distributor_crm_code,me."position" ,mp.first_name ||' '|| mp.last_name as positionName, \
me.position_id ,me.employee_id ,me.employee_code,me.primary_mobile,me.first_name ||' '|| me.last_name as userName, \
me.status as empStatus ,mo.status ,mp.status as positionStatus \
from lt_mast_distributors_v mo \
left join lt_mast_employees_v me on mo.distributor_id=me.distributor_id \
left join lt_mast_positions_v mp on me.position_id = mp.position_id \
where 1=1 \
and upper(mo.status) = 'ACTIVE' \
and mo.distributor_crm_code = ? \
and me."position" = ? \
and me.employee_code = ? \
and upper(me.job_title) != 'DISTRIBUTOR SALESMAN'

	
verifyDistributors = select mo.org_id, mo.distributor_id ,mo.distributor_code, mo.distributor_name, \
mo.distributor_crm_code,me."position" ,mp.first_name ||' '|| mp.last_name as positionName, \
me.position_id ,me.employee_id ,me.employee_code,me.primary_mobile,me.first_name ||' '|| me.last_name as userName, \
me.status as empStatus ,mo.status ,mp.status as positionStatus \
from lt_mast_distributors_v mo, \
lt_mast_employees_v me, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and mo.distributor_id=me.distributor_id \
and me.position_id = mp.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and upper(mo.status) = 'ACTIVE' \
and UPPER(lmep.status) = 'ACTIVE' \
and mo.distributor_crm_code = ? \
and me."position" = ? \
and me.employee_code = ? \
and upper(me.job_title) != 'DISTRIBUTOR SALESMAN'
	
	
verifyDistributorsCopyV1 = select mo.org_id, mo.distributor_id ,mo.distributor_code, mo.distributor_name , \
mo.distributor_crm_code,mp."position" ,mp.first_name ||' '|| mp.last_name as positionName, \
mp.position_id ,me.employee_id ,me.employee_code,me.primary_mobile,me.first_name ||' '|| me.last_name as userName, \
me.status as empStatus ,mo.status ,mp.status as positionStatus \
from lt_mast_distributors_v mo \
inner join lt_mast_employees_v me on mo.distributor_id=me.distributor_id \
left join lt_mast_emp_position_v mep on me.employee_id = mep.employee_id \
left join lt_mast_positions_v mp on mp.position_id = mep.position_id \
where 1=1 \
and upper(mo.status) = 'ACTIVE' \
and mo.distributor_crm_code = ? \
and mp."position" = ? \
and me.employee_code = ? \
and upper(mp.position_type) != 'DISTRIBUTOR SALESMAN'
	 
	
verifyDistributorsCopyV2 =select mo.org_id, mo.distributor_id ,mo.distributor_code, mo.distributor_name, \
mo.distributor_crm_code,mp."position" ,mp.first_name ||' '|| mp.last_name as positionName, \
mp.position_id ,me.employee_id ,me.employee_code,me.primary_mobile,me.first_name ||' '|| me.last_name as userName, \
me.status as empStatus ,mo.status ,mp.status as positionStatus \
from lt_mast_distributors_v mo \
inner join lt_mast_employees_v me on mo.distributor_id=me.distributor_id \
inner join lt_mast_positions_v mp on mp.position_id = me.position_id \
where 1=1 \
and upper(mo.status) = 'ACTIVE' \
and mo.distributor_crm_code = ? \
and mp."position" = ? \
and me.employee_code = ? \
and upper(mp.position_type) != 'DISTRIBUTOR SALESMAN'


### ORG User
verifyOrgUser = select mo.org_id,mo.organisation_code,mo.organisation_name,me.position_id,me."position", \
me.employee_code,me.first_name ||' '|| me.last_name as userName,mo.status ,me.status as employeeStatus \
from lt_mast_organisations mo \
left join lt_mast_employees_v me on mo.org_id=me.org_id \
where 1=1 \
and upper(me.status) ='ACTIVE' \
and me.employee_code = ? \
AND MO.ORGANISATION_CODE = ? 

### Users
getDistributorsByUserId = select lmu from \
lt_mast_users lmu \
where \
upper(lmu.status) = 'ACTIVE' \
and upper(lmu.user_type )= 'DISTRIBUTOR' \
and distributor_id = ( \
select distributor_id from lt_mast_users where user_id = ?  )
	
getAllUploadedFiles = SELECT a.* FROM (select lf.* from lt_fileupload lf where status = 'ACTIVE' )a where rownum BETWEEN ? AND ?

getfileByName = select * from lt_fileupload lf where lf.file_name = ? and lf.status ='ACTIVE'

### Sales Officer
verifySalesOfficerCOPY = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on mp.position_id = me.position_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and me."position" = ? \
and UPPER(me.job_title) = 'SALES OFFICER' 


verifySalesOfficer = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id=md.distributor_id \
and mp.position_id = me.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(lmep.status) = 'ACTIVE' \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and me."position" = ? \
and ( UPPER(me.job_title) = 'SALES OFFICER' \
or UPPER(me.job_title) = 'TGO' \
or UPPER(me.job_title) = 'TERRITORY GROWTH OFFICER' \
or UPPER(me.job_title) = 'TERRITORY GROWTH INCHARGE' \
or UPPER(me.job_title) = 'TGI') 

	
verifySalesOfficerCopyV1 = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_emp_position_v lmep on me.employee_id = lmep.employee_id \
left join lt_mast_positions_v mp on mp.position_id = lmep.position_id \
and me.employee_id = lmep.employee_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and mp."position" = ? \
and UPPER(mp.position_type) = 'SALES OFFICER' \
and me.employee_id = lmep.employee_id \
and mp.position_id = lmep.position_id 

verifySalesOfficerCopyV2 = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on me.position_id = mp.position_id \
left join lt_mast_emp_position_v lmep on mp.position_id = lmep.position_id \
and me.employee_id = lmep.employee_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and mp."position" = ? \
and UPPER(mp.position_type) = 'SALES OFFICER' \
and me.employee_id = lmep.employee_id \
and mp.position_id = lmep.position_id 

	
### AREA HEAD
verifyAreaHeadCOPY = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on mp.position_id = me.position_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and me."position" = ? \
and UPPER(me.job_title) = 'AREA HEAD'
	
		
verifyAreaHead = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id=md.distributor_id \
and mp.position_id = me.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(lmep.status) = 'ACTIVE' \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and me."position" = ? \
and (UPPER(me.job_title) = 'AREA HEAD' \
or UPPER(me.job_title) = 'AREA HEAD VIB' \
or UPPER(me.job_title) = 'AREA GROWTH' \
or UPPER(me.job_title) = 'AREA GROWTH HEAD')
	
	
verifyAreaHeadCopyV1 = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_emp_position_v lmep on me.employee_id = lmep.employee_id \
left join lt_mast_positions_v mp on mp.position_id = lmep.position_id \
and me.employee_id = lmep.employee_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and mp."position" = ? \
and UPPER(mp.position_type) = 'AREA HEAD' \
and me.employee_id = lmep.employee_id \
and mp.position_id = lmep.position_id
	
	
verifyAreaHeadCopyV2 = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,mp."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me \
left join lt_mast_distributors_v md \
on me.distributor_id=md.distributor_id \
left join lt_mast_positions_v mp on me.position_id = mp.position_id \
left join lt_mast_emp_position_v lmep on mp.position_id = lmep.position_id \
and me.employee_id = lmep.employee_id \
where 1=1 \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.primary_mobile = ? \
AND UPPER(ME.EMAIL) = ? \
and mp."position" = ? \
and UPPER(mp.position_type) = 'AREA HEAD' \
and me.employee_id = lmep.employee_id \
AND MP.POSITION_ID = LMEP.POSITION_ID 
	 
	
### ORG User
verifyOrgUserV1.1 = select mo.org_id,mo.organisation_code,mo.organisation_name,me.position_id,me."position", \
me.employee_code,me.first_name ||' '|| me.last_name as userName,mo.status ,me.status as employeeStatus \
from lt_mast_organisations mo \
left join lt_mast_employees_v me on mo.org_id=me.org_id \
left join lt_mast_emp_position_v lmep on me.employee_id = lmep.employee_id \
and lmp.position_id = lmep.position_id \
where 1=1  \
and upper(me.status) ='ACTIVE' \
and me.employee_code = ? \
and mo.organisation_code = ? \
AND ME.EMPLOYEE_ID = LMEP.EMPLOYEE_ID \
and lmp.position_id = lmep .position_id

getUserById = SELECT * FROM LT_MAST_USERS lmu WHERE USER_ID = ?

getAllOutletType = SELECT DISTINCT (upper(OUTLET_TYPE)) AS outlet_type_code, OUTLET_TYPE AS outlet_type_value FROM LT_MAST_OUTLETS_V ORDER BY OUTLET_TYPE  asc

getAllOutletChannel = SELECT DISTINCT (upper(NAME)) AS outlet_channel_code, name AS outlet_channel_value FROM SIEBEL.S_LST_OF_VAL \
WHERE TYPE LIKE '%ACCOUNT_CHANNEL%' \
ORDER by name asc

getOrganisationDetailsById = SELECT * FROM LT_MAST_ORGANISATIONS lmo WHERE ORG_ID = ?

SiebelCreateOutletApi = https://10.245.4.70:9014/siebel/v1.0/service/Siebel Outlet Integration/InsertOrUpdate?matchrequestformat=y

getOutletByOutletCode = SELECT * FROM LT_MAST_OUTLETS_V lmov WHERE OUTLET_CODE = ?

getPriceListAgainstDistributor =SELECT PRICE_LIST_ID,PRICE_LIST_NAME AS price_list  \
FROM XXATFL_DIST_PRI_LST_T \
where DISTRIBUTOR_ID = ?


verifyDistributorsV1 = select distinct mo.org_id, mo.distributor_id ,mo.distributor_code, mo.distributor_name, \
mo.distributor_crm_code,me."position" ,mp.first_name ||' '|| mp.last_name as positionName, \
me.position_id ,me.employee_id ,me.employee_code,me.primary_mobile,me.first_name ||' '|| me.last_name as userName, \
me.status as empStatus ,mo.status ,mp.status as positionStatus \
from lt_mast_distributors_v mo, \
lt_mast_employees_v me, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and mo.distributor_id=me.distributor_id \
and me.position_id = mp.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id  \
and upper(mo.status) = 'ACTIVE'  \
and UPPER(lmep.status) = 'ACTIVE'  \
and mo.DISTRIBUTOR_CRM_CODE = ? \
and mo.DISTRIBUTOR_NAME = ? \
and mo.PROPRIETOR_NAME = ? \
and upper(me.job_title) <> 'DISTRIBUTOR SALESMAN'


verifySalesOfficerV1 = select distinct me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id=md.distributor_id \
and mp.position_id = me.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(lmep.status) = 'ACTIVE' \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.EMPLOYEE_CODE = ?  \
and ( UPPER(me.job_title) = 'SALES OFFICER' \
or UPPER(me.job_title) = 'TGO' \
or UPPER(me.job_title) = 'TERRITORY GROWTH OFFICER' \
or UPPER(me.job_title) = 'TERRITORY GROWTH INCHARGE' \
or UPPER(me.job_title) = 'TGI') 


verifyAreaHeadV1 = select distinct me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id=md.distributor_id \
and mp.position_id = me.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(lmep.status) = 'ACTIVE' \
and UPPER(me.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and me.EMPLOYEE_CODE = ?  \
and (UPPER(me.job_title) = 'AREA HEAD' \
or UPPER(me.job_title) = 'AREA HEAD VIB' \
or UPPER(me.job_title) = 'AREA GROWTH' \
or UPPER(me.job_title) = 'AREA GROWTH HEAD')


verifySystemAdministrator = select me.employee_code,me.email,me.primary_mobile,me.first_name,me.last_name,me.org_id,me.distributor_id,me.position_id, \
md.distributor_code,md.distributor_name,md.distributor_crm_code,me."position",me.status ,md.status as distributorStatus ,mp.status as positionStatus \
from lt_mast_employees_v me, \
lt_mast_distributors_v md, \
lt_mast_positions_v mp, \
lt_mast_emp_position_v lmep \
where 1=1 \
and me.distributor_id=md.distributor_id \
and mp.position_id = me.position_id \
and me.employee_id = lmep.employee_id \
and me.position_id = lmep.position_id \
and UPPER(lmep.status) = 'ACTIVE' \
AND UPPER(ME.STATUS) = 'ACTIVE' \
and UPPER(mp.status) = 'ACTIVE' \
and UPPER(md.status) = 'ACTIVE' \
AND ME.EMPLOYEE_CODE = ? \
and UPPER(me.job_title) = UPPER('Sys Admin') 

getPendingAprrovalOutlet = SELECT a.* FROM (SELECT lmod.* FROM LT_MAST_OUTLETS_stg lmod \
WHERE lmod.STATUS in ('DRAFT', 'PENDING_APPROVAL') \
AND COALESCE (lmod.DISTRIBUTOR_ID,'xx') = COALESCE (?,COALESCE (lmod.DISTRIBUTOR_ID,'xx')) \
AND lmod.ORG_ID = ?  \
AND COALESCE (lmod.PRIMARY_MOBILE,'xx') = COALESCE (?,COALESCE (lmod.PRIMARY_MOBILE,'xx')) \
AND COALESCE (lmod.OUTLET_NAME,'xx') = COALESCE (?,COALESCE (lmod.OUTLET_NAME,'xx')) \
AND COALESCE(UPPER(Lmod.OUTLET_NAME || Lmod.PRIMARY_MOBILE),'xx') LIKE  \
COALESCE( ? ,COALESCE(UPPER(Lmod.OUTLET_NAME || Lmod.PRIMARY_MOBILE),'xx')) )a \
ORDER BY a.LAST_UPDATE_DATE desc  \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE ROWNUM BETWEEN ? AND ?


getOutletToChangeStatus = SELECT lmod.* FROM LT_MAST_OUTLETS_stg lmod \
WHERE lmod.STATUS in ('DRAFT', 'PENDING_APPROVAL') \
AND lmod.DISTRIBUTOR_ID = ?  \
AND lmod.ORG_ID = ?  \
AND lmod.PRIMARY_MOBILE = ? \


getSystemAdministartorDetails= SELECT * FROM LT_MAST_USERS lmu WHERE USER_TYPE = 'SYSTEAMAdMINISTARTOR'  \
AND ORG_ID = ? 

getAllSalesOfficerAgainstDist = SELECT * FROM LT_MAST_USERS lmu  \
WHERE DISTRIBUTOR_ID = ? \
AND USER_TYPE IN ('SALESOFFICER', 'SYSTEMADMINISTRATOR', 'AREAHEAD')  \
AND ORG_ID = ?


#getAllDistributorAgainstAreahead = SELECT  LMDV.*,lth.CREATION_DATE AS templateCreationDate,lth.TEMPLATE_HEADER_ID,uhl.templateProductCount  \
#FROM LT_MAST_USERS lmu \
#,LT_MAST_DISTRIBUTORS_V lmdv \
#,LT_TEMPLATE_HEADERS lth  \
#,LT_TEMPLATE_LINES ltl,  \
#(SELECT  LTI.TEMPLATE_HEADER_ID,count(lti.TEMPLATE_LINE_ID) AS templateProductCount \
 #                                 FROM LT_TEMPLATE_LINES lti \
 #                                 GROUP BY LTI.TEMPLATE_HEADER_ID \
#) UHL \
#WHERE lmu.DISTRIBUTOR_ID = lmdv.distributor_id \
#AND lth.DISTRIBUTOR_ID = lmdv.DISTRIBUTOR_ID(+) \
#AND lth.TEMPLATE_HEADER_ID = ltl.TEMPLATE_HEADER_ID(+)  \
#AND UHL.TEMPLATE_HEADER_ID (+)= lth.TEMPLATE_HEADER_ID \
#AND lmu.USER_TYPE = 'AREAHEAD' \
#AND lmu.user_id = ?

#getAllDistributorAgainstAreahead = SELECT \
#  LMDV.*, \
#	LTH.CREATION_DATE AS template_Creation_Date, \
#	LTH.TEMPLATE_HEADER_ID, \
#	UHL.template_Product_Count \
#FROM \
#	AREA_HEAD_V AHV , \
#	LT_MAST_DISTRIBUTORS_V lmdv , \
#	LT_TEMPLATE_HEADERS lth , \
#	LT_TEMPLATE_LINES ltl, \
#	( \
#	SELECT \ LTI.TEMPLATE_HEADER_ID, \
#		count(lti.TEMPLATE_LINE_ID) AS template_Product_Count \
#	FROM \
#		LT_TEMPLATE_LINES lti \
#	GROUP BY \
#		LTI.TEMPLATE_HEADER_ID ) UHL \
#WHERE \
#	AHV.DISTRIBUTOR_ID = lmdv.distributor_id \
#	AND lth.DISTRIBUTOR_ID(+) = lmdv.DISTRIBUTOR_ID \
#	AND LTH.TEMPLATE_HEADER_ID = LTL.TEMPLATE_HEADER_ID (+) \
#	AND UHL.TEMPLATE_HEADER_ID(+) = LTH.TEMPLATE_HEADER_ID  \
#	AND upper(lmdv.STATUS)  ='ACTIVE' \
#	AND AHV.AREA_HEAD_NAME = ? \
#	ORDER BY LTH.LAST_UPDATED_DATE DESC

	
getBeatDetailsAgainsDistirbutorCodeAndBeatName = SELECT SOE2.INTEGRATION_ID DISTRIBUTOR_NUMBER, SOE2.NAME DISTRIBUTOR_NAME, \
SOE2.ROW_ID DISTRIBUTOR_CODE, SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS \
FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR \
WHERE SOE1.BU_ID = ? \
and   SOE1.RULE_ATTRIB1 = ? \
AND SOE1.BU_ID = SOE2.ROW_ID \
AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
ORDER BY SOE1.RULE_ATTRIB1,SOE1.STORE_SIZE

#getBeatDetailsAgainsDistirbutorCodeAndBeat = SELECT SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
#SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS \
#FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR \
#WHERE SOE1.BU_ID = ? \
#and   SOE1.RULE_ATTRIB1 = ? \
#AND SOE1.BU_ID = SOE2.ROW_ID \
#AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
#ORDER BY SOE1.RULE_ATTRIB1,SOE1.STORE_SIZE

getBeatDetailsAgainsDistirbutorCode = SELECT DISTINCT (SOE1.RULE_ATTRIB1) AS BEAT_NAME  \
FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR  \
WHERE SOE1.BU_ID = ?  \
AND SOE1.BU_ID = SOE2.ROW_ID  \
AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID  \
AND COALESCE(UPPER(SOE1.RULE_ATTRIB1||SOE1.NAME),'xx') \
like  COALESCE( ? ,COALESCE(upper(SOE1.RULE_ATTRIB1||SOE1.NAME),'xx'))  \
AND SOE1.STORE_SIZE IS NOT NULL ORDER BY SOE1.RULE_ATTRIB1  OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

#AND ROWNUM BETWEEN ? AND  ?  \
 


updateBeatSequence = UPDATE SIEBEL.S_ORG_EXT \
SET STORE_SIZE = ? \
WHERE BU_ID = ? \
AND RULE_ATTRIB1 = ? \
AND ROW_ID = ?

getUpdatedBeatSequence = SELECT soe.NAME, soe.STORE_SIZE, \
soe.MASTER_OU_ID, soe.OU_TYPE_CD,soe.BU_ID \
FROM SIEBEL.S_ORG_EXT soe \
WHERE BU_ID = ? \
AND RULE_ATTRIB1 = ? \
AND ROW_ID = ?


#getOutletAgainstBeat = SELECT SOE2.INTEGRATION_ID DISTRIBUTOR_NUMBER, SOE2.NAME DISTRIBUTOR_NAME, \
#SOE2.ROW_ID DISTRIBUTOR_CODE, SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
#SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS \
#FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR \
#WHERE SOE1.BU_ID = ? \
#AND COALESCE(UPPER(SOE1.RULE_ATTRIB1),'xx') LIKE  COALESCE( ? ,COALESCE(UPPER(SOE1.RULE_ATTRIB1),'xx')) \
#AND SOE1.BU_ID = SOE2.ROW_ID \
#AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
#AND SOE1.RULE_ATTRIB1 = ? \
#ORDER BY SOE1.STORE_SIZE  OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

#AND ROWNUM BETWEEN ? AND  ?

 
#getOutletAgainstBeat = SELECT SOE2.INTEGRATION_ID DISTRIBUTOR_NUMBER, SOE2.NAME DISTRIBUTOR_NAME, \  18-March-2024 vaibhav & shubham queryOptimized
#SOE2.ROW_ID DISTRIBUTOR_CODE, SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
#SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS , \
#lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, lmo.proprietor_name,  \
#(lmo.address_1||' '||lmo.address_2 ) as outletAddress , lmo.address_2 as address2 , lmo.address_3 as address3, \
#lmo.address_4 as address4, lmo.landmark, lmo.country, lmo.state, lmo.city, lmo.pin_code, lmo.region,  \
#LMO.AREA, LMO.TERRITORY, LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, LMO.PRIMARY_MOBILE AS PRIMARYMOBILE, LMO.BEAT_NAME,  \
#LMO.STATUS, LMO.START_DATE, LMO.END_DATE, LMO.CREATED_BY, LMO.PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE, \
#LMO.ADDRESS_1 AS ADDRESS1,LMO.OUTLET_CHANNEL,lmp."position"  \
#FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR ,lt_mast_outlets_v lmo,lt_mast_positions_v lmp \
#WHERE SOE1.BU_ID = ? \
#AND COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx') LIKE  COALESCE( ? ,COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx')) \
#AND SOE1.BU_ID = SOE2.ROW_ID \
#AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
#AND SOE1.RULE_ATTRIB1 = ?  \
#AND SOE1.ROW_ID = LMO.OUTLET_ID \
#AND LMO.POSITIONS_ID = LMP.POSITION_ID \
#ORDER BY SOE1.STORE_SIZE  OFFSET ? ROWS FETCH NEXT ? ROWS ONLY	


getOutletAgainstBeat = SELECT SOE2.INTEGRATION_ID DISTRIBUTOR_NUMBER, SOE2.NAME DISTRIBUTOR_NAME, \
SOE2.ROW_ID DISTRIBUTOR_CODE, SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS , \
lmo.outlet_id, lmo.distributor_id, lmo.outlet_code, lmo.outlet_type, lmo.outlet_name, lmo.proprietor_name,  \
(lmo.address_1||' '||lmo.address_2 ) as outletAddress , lmo.address_2 as address2 , lmo.address_3 as address3, \
lmo.address_4 as address4, lmo.landmark, lmo.country, lmo.state, lmo.city, lmo.pin_code, lmo.region,  \
LMO.AREA, LMO.TERRITORY, LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, LMO.PRIMARY_MOBILE AS PRIMARYMOBILE, LMO.BEAT_NAME,  \
LMO.STATUS, LMO.START_DATE, LMO.END_DATE, LMO.CREATED_BY, LMO.PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE, \
LMO.ADDRESS_1 AS ADDRESS1,LMO.OUTLET_CHANNEL,LMP.NAME as "position" \
FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR ,LT_MAST_OUTLETS_V LMO, \
siebel.s_postn lmp \
WHERE SOE1.BU_ID = ? \
AND COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx') \
LIKE  COALESCE( ? ,COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx')) \
AND SOE1.BU_ID = SOE2.ROW_ID \
AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
AND SOE1.RULE_ATTRIB1 = ?  \
AND SOE1.ROW_ID = LMO.OUTLET_ID \
AND LMO.POSITIONS_ID = LMP.row_id \
ORDER BY SOE1.STORE_SIZE  \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


getOutletAgainstBeatFromOutletStgTable = SELECT lmos.DISTRIBUTOR_NAME,lmos.DISTRIBUTOR_ID,lmos.OUTLET_NAME,lmos.OUTLET_CODE, \
lmos.BEAT_ID, lmos.OUTLET_ID AS OUTLET_SEQUENCE, lmos.ADDRESS1 || ADDRESS2 , \
lmos.OUTLET_CODE, lmos.DISTRIBUTOR_ID, lmos.OUTLET_TYPE, lmos.PROPRIETOR_NAME, lmos.ADDRESS2, lmos.ADDRESS_3, \
lmos.ADDRESS_4, lmos.LANDMARK, lmos.COUNTRY, lmos.STATE, lmos.CITY, lmos.PIN_CODE, lmos.REGION, lmos.AREA, lmos.TERRITORY, \
lmos.OUTLET_GSTN, lmos.PHONE,lmos.EMAIL, lmos.PRIMARY_MOBILE, lmos.BEAT_ID, lmos.STATUS, lmos.PRICE_LIST, \
lmos.POSITIONS_ID, lmos.ORG_ID, lmos.LAST_UPDATE_DATE, lmos.CREATED_BY, lmos.OUTLET_CHANNEL, lmos."name_position", \
lmos.START_DATE,lmos.END_DATE \
FROM LT_MAST_OUTLETS_STG lmos, LT_MAST_OUTLETS_V lmov \
WHERE lmos.DISTRIBUTOR_ID = ? \
AND lmov.OUTLET_CODE = lmos.OUTLET_CODE \
AND COALESCE(UPPER(lmos.BEAT_ID || lmos.OUTLET_NAME),'xx') \
LIKE  COALESCE( ? ,COALESCE(UPPER(lmos.BEAT_ID ||lmos.OUTLET_NAME),'xx')) \
AND lmos.BEAT_ID = ? \
ORDER BY OUTLET_SEQUENCE DESC \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY


#comment on 08-may-2024 me & shubham
#getOutletAgainstBeat = SELECT DISTRIBUTOR_NAME,DISTRIBUTOR_ID,OUTLET_NAME,OUTLET_CODE,BEAT_ID,OUTLET_ID,ADDRESS1 || ADDRESS2 , \
#OUTLET_CODE,DISTRIBUTOR_ID,OUTLET_TYPE,PROPRIETOR_NAME,ADDRESS2,ADDRESS_3,ADDRESS_4,LANDMARK, \
#COUNTRY,STATE,CITY,PIN_CODE,REGION,AREA,TERRITORY,OUTLET_GSTN,PHONE,EMAIL,PRIMARY_MOBILE, \
#BEAT_ID ,STATUS,PRICE_LIST,POSITIONS_ID,ORG_ID,LAST_UPDATE_DATE,CREATEDBY, \
#OUTLET_CHANNEL,"name_position",START_DATE,END_DATE \
#FROM LT_MAST_OUTLETS_STG \
#WHERE DISTRIBUTOR_ID = ? \
#AND COALESCE(UPPER(BEAT_ID || OUTLET_NAME),'xx') \
#LIKE  COALESCE( ? ,COALESCE(UPPER(BEAT_ID ||OUTLET_NAME),'xx')) \
#AND BEAT_ID = ? \
#UNION \
#SELECT SOE2.NAME DISTRIBUTOR_NAME, \
#SOE2.ROW_ID DISTRIBUTOR_CODE, SOE1.NAME OUTLET_NAME, SOE1.ROW_ID AS OUTLET_CODE, SOE1.RULE_ATTRIB1 BEAT_NAME, \
#SOE1.STORE_SIZE OUTLET_SEQUENCE, ADDR.ADDR ||','||ADDR.ADDR_LINE_2 AS ADDRESS , \
#lmo.outlet_id, lmo.distributor_id, lmo.outlet_type, lmo.proprietor_name , lmo.address_2 as address2 , lmo.address_3 as address3, \
#lmo.address_4 as address4, lmo.landmark, lmo.country, lmo.state, lmo.city, lmo.pin_code, lmo.region,  \
#LMO.AREA, LMO.TERRITORY, LMO.OUTLET_GSTN, LMO.PHONE, LMO.EMAIL, LMO.PRIMARY_MOBILE AS PRIMARYMOBILE, LMO.BEAT_NAME,  \
#LMO.STATUS, LMO.PRICE_LIST, LMO.POSITIONS_ID, LMO.ORG_ID,LMO.LAST_UPDATE_DATE ,LMO.CREATED_BY \
#,LMO.OUTLET_CHANNEL,LMP.NAME as "name_position",LMO.START_DATE ,LMO.END_DATE \
#FROM SIEBEL.S_ORG_EXT SOE1,SIEBEL.S_ORG_EXT SOE2,SIEBEL.S_ADDR_PER ADDR ,LT_MAST_OUTLETS_V LMO, \
#SIEBEL.S_POSTN LMP \
#WHERE SOE1.BU_ID = ? \
#AND COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx') \
#LIKE  COALESCE( ? ,COALESCE(UPPER(SOE1.RULE_ATTRIB1 || SOE1.NAME),'xx')) \
#AND SOE1.BU_ID = SOE2.ROW_ID \
#AND  SOE1.PR_ADDR_ID = ADDR.ROW_ID \
#AND SOE1.RULE_ATTRIB1 = ?  \
#AND SOE1.ROW_ID = LMO.OUTLET_ID \
#AND LMO.POSITIONS_ID = LMP.ROW_ID \
#ORDER BY OUTLET_ID DESC \
#OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

#AND COALESCE(UPPER(SOE1.RULE_ATTRIB1),'xx') LIKE  COALESCE( ? ,COALESCE(UPPER(SOE1.RULE_ATTRIB1),'xx')) \

getAllNotification = SELECT a.* FROM (SELECT * FROM LT_NOTIFICATION LN \
WHERE 1=1 \
AND COALESCE(Ln.DISTRIBUTOR_ID,'xx') =  COALESCE( ? ,COALESCE(Ln.DISTRIBUTOR_ID,'xx')) \
and ln.user_id = ?  \
AND COALESCE(UPPER(LN.NOTIFICATION_BODY||LN.NOTIFICATION_TITLE),'xx')  \
like  COALESCE( ? ,COALESCE(upper(LN.NOTIFICATION_BODY||LN.NOTIFICATION_TITLE),'xx')) \
ORDER BY LN.SEND_DATE DESC ) a \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#WHERE ROWNUM BETWEEN ? AND ?


getAllDistributorAgainstAreahead = SELECT  DISTINCT(LTH.TEMPLATE_HEADER_ID), \
  LMDV.*,  \
	LTH.CREATION_DATE AS template_Creation_Date,  \
	UHL.template_Product_Count  \
FROM  \
	AREA_HEAD_V AHV ,  \
	LT_MAST_DISTRIBUTORS_V lmdv ,  \
	LT_TEMPLATE_HEADERS lth ,  \
	LT_TEMPLATE_LINES ltl,  \
	(  \
	SELECT  LTI.TEMPLATE_HEADER_ID,  \
		count(lti.TEMPLATE_LINE_ID) AS template_Product_Count  \
	FROM  \
		LT_TEMPLATE_LINES lti  \
	GROUP BY  \
		LTI.TEMPLATE_HEADER_ID ) UHL  \
WHERE  \
	AHV.DISTRIBUTOR_ID = lmdv.distributor_id  \
	AND lth.DISTRIBUTOR_ID(+) = lmdv.DISTRIBUTOR_ID  \
	AND LTH.TEMPLATE_HEADER_ID = LTL.TEMPLATE_HEADER_ID (+)  \
	AND UHL.TEMPLATE_HEADER_ID(+) = LTH.TEMPLATE_HEADER_ID   \
	AND upper(lmdv.STATUS)  ='ACTIVE'  \
	AND AHV.AREA_HEAD_NAME = ?  \
	AND COALESCE(UPPER(LMDV.DISTRIBUTOR_NAME||LMDV.DISTRIBUTOR_CODE),'xx')   \
like  COALESCE( ? ,COALESCE(upper(LMDV.DISTRIBUTOR_NAME||LMDV.DISTRIBUTOR_CODE),'xx'))  \
ORDER BY LTH.CREATION_DATE DESC \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY



offset_value = 10

getoutletByIdAndCode = SELECT * FROM LT_MAST_OUTLETS_STG lmos WHERE OUTLET_CODE = ? AND STATUS = 'APPROVED'

#verifyUserDetailsByMobileNumbervInSiebel = SELECT \   shubham & vaibhva query optimize on 18-march-2024
#    ORG1.ROW_ID AS OUTLET_ID, \
#    (SELECT MAX(ORG1_inner.ROW_ID) \
#    FROM SIEBEL.S_BU SBU_inner, \
#    SIEBEL.S_ORG_EXT ORG2_inner, \
#    SIEBEL.S_ORG_EXT ORG1_inner \
#    , SIEBEL.S_ADDR_PER ADDR_inner, \
#    SIEBEL.S_POSTN POS_inner, \
#    SIEBEL.S_USER SU_inner, \
#    SIEBEL.S_CONTACT SC_inner \
#    WHERE ORG2_inner.ROW_ID = SBU_inner.ROW_ID \
#    AND ORG1_inner.BU_ID = SBU_inner.ROW_ID \
#    AND ORG1_inner.PR_ADDR_ID = ADDR_inner.ROW_ID \
#    AND POS_inner.PR_EMP_ID = SU_inner.ROW_ID \
#    AND ORG1_inner.PR_POSTN_ID = POS_inner.ROW_ID \
#    AND SU_inner.ROW_ID = SC_inner.ROW_ID \
#    AND REPLACE(SC_inner.CELL_PH_NUM,'+91','') = ?) AS RECENT_SEARCH_ID \
#    ,ORG2.ROW_ID AS DISTRIBUTOR_ID, \
#    SU.STATUS_CD AS status, \
#    SU.LOGIN AS EMPLOYEE_CODE, \
#    SC.FST_NAME ||' '|| SC.LAST_NAME AS USER_NAME, \
#    SC.LATITUDE, \
#    SC.LONGITUDE, \
#    POS.POSTN_TYPE_CD AS USER_TYPE, \
#    addr.addr AS ADDRESS, \
#    SC.EMAIL_ADDR AS EMAIL, \
#    SC.HOME_PH_NUM, \
#    REPLACE(SC.CELL_PH_NUM,'+91','') AS MOBILE_NUMBER, \
#    sc.ASST_PH_NUM, \
#    ADDR.ADDR_LINE_2 ||' '|| ADDR.ADDR_LINE_3 ||' '|| ADDR.CITY AS ADDRESS_DETAILS, \
#    POS.ROW_ID AS POSITION_ID, \
#    SU.CREATED AS CREATION_DATE, \
#    SU.CREATED_BY AS CREATED_BY, \
#    SU.LAST_UPD AS LAST_UPDATE_DATE, \
#    SU.LAST_UPD_BY AS LAST_UPDATED_BY, \
#    (SELECT MAX(ORG1_inner.ROW_ID) FROM SIEBEL.S_BU SBU_inner, SIEBEL.S_ORG_EXT ORG2_inner, SIEBEL.S_ORG_EXT ORG1_inner \
#    , SIEBEL.S_ADDR_PER ADDR_inner, SIEBEL.S_POSTN POS_inner, SIEBEL.S_USER SU_inner, SIEBEL.S_CONTACT SC_inner WHERE ORG2_inner.ROW_ID = SBU_inner.ROW_ID AND ORG1_inner.BU_ID = SBU_inner.ROW_ID AND ORG1_inner.PR_ADDR_ID = ADDR_inner.ROW_ID AND POS_inner.PR_EMP_ID = SU_inner.ROW_ID AND ORG1_inner.PR_POSTN_ID = POS_inner.ROW_ID \
#    AND SU_inner.ROW_ID = SC_inner.ROW_ID AND REPLACE (SC_inner.CELL_PH_NUM,'+91','') = ?) AS RECENT_SEARCH_ID \
#FROM \
#    SIEBEL.S_BU SBU, \
#    SIEBEL.S_ORG_EXT ORG2, \
#    SIEBEL.S_ORG_EXT ORG1, \
#    SIEBEL.S_ADDR_PER ADDR, \
#    SIEBEL.S_POSTN POS, \
#    SIEBEL.S_USER SU, \
#    SIEBEL.S_CONTACT SC \
#WHERE \
#    ORG2.ROW_ID = SBU.ROW_ID \
#    AND ORG1.BU_ID = SBU.ROW_ID \
#    AND ORG1.PR_ADDR_ID = ADDR.ROW_ID \
#    AND POS.PR_EMP_ID = SU.ROW_ID \
#    AND ORG1.PR_POSTN_ID = POS.ROW_ID \
#    AND SU.ROW_ID = SC.ROW_ID \
#    AND REPLACE(SC.CELL_PH_NUM,'+91','')= ? \
#ORDER BY ORG1.ROW_ID DESC \
#FETCH FIRST 1 ROW ONLY


verifyUserDetailsByMobileNumbervInSiebel = SELECT * FROM \
(SELECT SOE2.ROW_ID AS OUTLET_ID, \
                SOE2.ROW_ID AS RECENT_SEARCH_ID, \
                SOE.ROW_ID AS DISTRIBUTOR_ID, \
                SOE.NAME AS DISTRIBUTOR_NAME, \
                SU.STATUS_CD AS STATUS, \
                SU.LOGIN AS EMPLOYEE_CODE, \
                SC.FST_NAME ||' '|| SC.LAST_NAME AS USER_NAME, \
                to_char(SC.LATITUDE) AS LATITUDE, \
                to_char(SC.LONGITUDE) AS LONGITUDE, \
                SC.ALIAS_NAME AS USER_TYPE, \
                addr.addr AS ADDRESS, \
                SC.EMAIL_ADDR AS EMAIL, \
                SC.HOME_PH_NUM , \
                REPLACE(SC.CELL_PH_NUM,'+91','') AS MOBILE_NUMBER, \
                SC.ASST_PH_NUM , \
                ADDR.ADDR_LINE_2 ||' '|| ADDR.ADDR_LINE_3 ||' '|| ADDR.CITY AS ADDRESS_DETAILS, \
                sp.ROW_ID AS POSITION_ID,  \
                SOE.NAME AS TERRITORY , \
                SU.CREATED AS CREATION_DATE, \
                -1 AS CREATED_BY, \
                SU.LAST_UPD AS LAST_UPDATE_DATE, \
                -1 AS LAST_UPDATED_BY \
FROM SIEBEL.S_POSTN SP, \
     SIEBEL.S_ORG_EXT SOE, \
     SIEBEL.S_ORG_EXT SOE2, \
     SIEBEL.S_CONTACT SC, \
     SIEBEL.S_USER SU, \
     SIEBEL.S_ADDR_PER ADDR, \
     SIEBEL.S_REGION R \
WHERE sp.bu_id = soe.row_id \
and sc.pr_held_postn_id = sp.row_id \
AND SU.ROW_ID = SC.ROW_ID \
AND SOE.PR_ADDR_ID = ADDR.ROW_ID \
AND SOE2.BU_ID = SOE.ROW_ID \
AND R.ROW_ID = SOE2.REGION_ID \
AND REPLACE(SC.CELL_PH_NUM,'+91','')= ? \
AND UPPER(SU.STATUS_CD) = NVL(UPPER(SU.STATUS_CD), 'ACTIVE')) \
WHERE  ROWNUM = 1
       
#getUserDataByIdForValidation = SELECT * FROM \
#(SELECT  ORG1.ROW_ID AS OUTLET_ID, \
#         ORG1.ROW_ID AS RECENT_SEARCH_ID, \
#                ORG2.ROW_ID AS DISTRIBUTOR_ID, \
#                SU.STATUS_CD AS status, \
#                SU.LOGIN AS EMPLOYEE_CODE, \
#                SC.FST_NAME ||' '|| SC.LAST_NAME AS USER_NAME, \
#                SC.LATITUDE, \
#                SC.LONGITUDE, \
#                sc.alias_name AS USER_TYPE, \
#                addr.addr AS ADDRESS, \
#                SC.EMAIL_ADDR AS EMAIL, \
#                SC.HOME_PH_NUM , \
#                REPLACE(SC.CELL_PH_NUM,'+91','') AS MOBILE_NUMBER, \
#                sc.ASST_PH_NUM , \
#                ADDR.ADDR_LINE_2 ||' '|| ADDR.ADDR_LINE_3 ||' '|| ADDR.CITY AS ADDRESS_DETAILS, \
#                POS.ROW_ID AS POSITION_ID,  \
#                SU.CREATED AS CREATION_DATE, \
#                SU.CREATED_BY AS CREATED_BY, \
#                SU.LAST_UPD AS LAST_UPDATE_DATE, \
#                SU.LAST_UPD_BY AS LAST_UPDATED_BY \
#FROM SIEBEL.S_BU SBU, \
#       SIEBEL.S_ORG_EXT ORG2, \
#       SIEBEL.S_ORG_EXT ORG1, \
#       SIEBEL.S_ADDR_PER ADDR, \
#       SIEBEL.S_POSTN POS, \
#       SIEBEL.S_USER SU, \
#       SIEBEL.S_CONTACT SC \
#WHERE  ORG2.ROW_ID = SBU.ROW_ID \
#       AND ORG1.BU_ID = SBU.ROW_ID \
#       AND ORG1.PR_ADDR_ID = ADDR.ROW_ID \
#       AND POS.PR_EMP_ID = SU.ROW_ID \
#       AND ORG1.PR_POSTN_ID = POS.ROW_ID \
#       AND SU.ROW_ID = SC.ROW_ID \
#       AND REPLACE(SC.CELL_PH_NUM,'+91','')= (SELECT MOBILE_NUMBER FROM LT_MAST_USERS \
#       where user_id = ?) \
#       AND upper(SU.STATUS_CD) = upper('Active')) \
#       WHERE ROWNUM = 1


getUserDataByIdForValidation = SELECT * FROM \
(SELECT SOE2.ROW_ID AS OUTLET_ID, \
                SOE2.ROW_ID AS RECENT_SEARCH_ID, \
                SOE.ROW_ID AS DISTRIBUTOR_ID, \
                SOE.NAME AS DISTRIBUTOR_NAME, \
                SU.STATUS_CD AS STATUS, \
                SU.LOGIN AS EMPLOYEE_CODE, \
                SC.FST_NAME ||' '|| SC.LAST_NAME AS USER_NAME, \
                SC.LATITUDE, \
                SC.LONGITUDE, \
                SC.ALIAS_NAME AS USER_TYPE, \
                addr.addr AS ADDRESS, \
                SC.EMAIL_ADDR AS EMAIL, \
                SC.HOME_PH_NUM , \
                REPLACE(SC.CELL_PH_NUM,'+91','') AS MOBILE_NUMBER, \
                SC.ASST_PH_NUM , \
                ADDR.ADDR_LINE_2 ||' '|| ADDR.ADDR_LINE_3 ||' '|| ADDR.CITY AS ADDRESS_DETAILS, \
                sp.ROW_ID AS POSITION_ID,  \
                SOE.NAME AS TERRITORY, \
                SU.CREATED AS CREATION_DATE, \
                SU.CREATED_BY AS CREATED_BY, \
                SU.LAST_UPD AS LAST_UPDATE_DATE, \
                SU.LAST_UPD_BY AS LAST_UPDATED_BY \
FROM SIEBEL.S_POSTN SP, \
     SIEBEL.S_ORG_EXT SOE, \
     SIEBEL.S_ORG_EXT SOE2, \
     SIEBEL.S_CONTACT SC, \
     SIEBEL.S_USER SU, \
     SIEBEL.S_ADDR_PER ADDR, \
     SIEBEL.S_REGION R \
WHERE sp.bu_id = soe.row_id \
and sc.pr_held_postn_id = sp.row_id \
AND SU.ROW_ID = SC.ROW_ID \
AND SOE.PR_ADDR_ID = ADDR.ROW_ID \
AND SOE2.BU_ID = SOE.ROW_ID \
AND R.ROW_ID = SOE2.REGION_ID \
AND REPLACE(SC.CELL_PH_NUM,'+91','')= (SELECT MOBILE_NUMBER FROM LT_MAST_USERS \
       where user_id = ?) \
AND UPPER(SU.STATUS_CD) = NVL(UPPER(SU.STATUS_CD), 'ACTIVE')) \
WHERE  ROWNUM = 1


getUserTypeByUserId = SELECT lmu.USER_TYPE FROM LT_MAST_USERS lmu WHERE lmu.USER_ID = ?

getAllDistributorAgainstSystemAdmin = SELECT  DISTINCT(LTH.TEMPLATE_HEADER_ID), \
  LMDV.*,  \
	LTH.CREATION_DATE AS template_Creation_Date,  \
	UHL.template_Product_Count  \
FROM  \
	AREA_HEAD_V AHV ,  \
	LT_MAST_USERS lmu, \
	LT_MAST_DISTRIBUTORS_V lmdv ,  \
	LT_TEMPLATE_HEADERS lth ,  \
	LT_TEMPLATE_LINES ltl,  \
	(  \
	SELECT  LTI.TEMPLATE_HEADER_ID,  \
		count(lti.TEMPLATE_LINE_ID) AS template_Product_Count  \
	FROM  \
		LT_TEMPLATE_LINES lti  \
	GROUP BY  \
		LTI.TEMPLATE_HEADER_ID ) UHL  \
WHERE  \
	AHV.DISTRIBUTOR_ID = lmdv.distributor_id  \
	AND lth.DISTRIBUTOR_ID(+) = lmdv.DISTRIBUTOR_ID  \
	AND LTH.TEMPLATE_HEADER_ID = LTL.TEMPLATE_HEADER_ID (+)  \
	AND UHL.TEMPLATE_HEADER_ID(+) = LTH.TEMPLATE_HEADER_ID   \
	AND upper(lmdv.STATUS)  = 'ACTIVE'  \
	AND lmu.EMPLOYEE_CODE = ? \
	AND COALESCE(UPPER(LMDV.DISTRIBUTOR_NAME||LMDV.DISTRIBUTOR_CODE || lmdv.DISTRIBUTOR_CRM_CODE),'xx')   \
like  COALESCE( ? ,COALESCE(upper(LMDV.DISTRIBUTOR_NAME||LMDV.DISTRIBUTOR_CODE || lmdv.DISTRIBUTOR_CRM_CODE),'xx'))  \
ORDER BY LTH.CREATION_DATE DESC  \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
#AND LTH.CREATION_DATE IS NOT null \



deletePromotionDatabyId = DELETE FROM LT_PROMOTION lp WHERE lp.PROMOTION_ID = ?

getPromotionDataById =  select * from LT_PROMOTION lp WHERE lp.PROMOTION_ID = ?

getAllStates = SELECT DESC_TEXT AS state, name AS code FROM siebel.S_LST_OF_VAL \
where type = 'STATE_ABBREV' \
and ACTIVE_FLG = 'Y' \
and WS_SRC_ID = row_id \
and name not in ('AD','APP','UA','UH','UK','CG','BH') \
GROUP BY NAME,DESC_TEXT \
order by 1


getOutletById = SELECT * FROM LT_MAST_OUTLETS_STG lmos WHERE lmos.OUTLET_ID = ?

getStoreIdFromBeat = SELECT max(SOE1.STORE_SIZE) AS OUTLET_SEQUENCE \
FROM SIEBEL.S_ORG_EXT SOE1 \
WHERE SOE1.RULE_ATTRIB1 = ?


getTemplateForAllDistributor = SELECT lth.TEMPLATE_HEADER_ID, lth.DISTRIBUTOR_ID, lth.CREATION_DATE AS TEMPLATE_CREATION_DATE, lth.STATUS, \
lth.PRODUCT_COUNT AS TEMPLATE_PRODUCT_COUNT \
FROM LT_TEMPLATE_HEADERS lth \
WHERE lth.DISTRIBUTOR_ID = ?  \
OFFSET ? ROWS FETCH NEXT ? ROWS ONLY

updatePromotionData = UPDATE LT_PROMOTION \
SET IMAGE_NAME = ?, \
CREATED_BY = ?, \
STATUS = ?, \
PROMOTION_NAME = ?, \
ALL_TIME_SHOW_FLAG = ?, \
ORG_ID = ?, \
START_DATE = TO_DATE(?,'DD-MON-YY'), \
END_DATE = TO_DATE(?,'DD-MON-YY'), \
LAST_UPDATED_BY = ?, \
LAST_UPDATE_LOGIN = ? \
WHERE PROMOTION_ID = ?


getUserNameFromSiebel = SELECT su.LOGIN FROM siebel.S_USER su,SIEBEL.S_CONTACT sc \
WHERE su.PAR_ROW_ID = sc.ROW_ID \
AND su.STATUS_CD ='Active' \
AND REPLACE(SC.CELL_PH_NUM,'+91','')= ?

getImageFileDataById = SELECT lp.IMAGE_TYPE, lp.IMAGE_NAME, lp.IMAGE_DATA  FROM LT_PROMOTION lp \
WHERE lp.PROMOTION_ID = ?

getAllPromotionDataById = SELECT * FROM LT_PROMOTION lp \
WHERE lp.PROMOTION_ID = ?

getUserNameAgainsUserId= SELECT DISTINCT lmu.USER_NAME  \
FROM LT_SO_HEADERS lsh, LT_MAST_USERS lmu \
WHERE lsh.CREATED_BY = lmu.USER_ID \
and lsh.CREATED_BY = ?



